<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工业互联网平台</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.3;
            background: #f3f4f6;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 240px;
            background: #1e293b;
            color: white;
            flex-shrink: 0;
            font-family: "Source Han Sans CN", "思源黑体", "Microsoft YaHei", sans-serif;
        }

        .logo {
            padding: 20px;
            font-size: 18px;
            font-weight: bold;
            font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            color: white;
            text-align: center;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin: 2px 0;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            justify-content: space-between;
            font-family: "Source Han Sans CN", "思源黑体", "Microsoft YaHei", sans-serif;
            font-weight: normal;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.15);
            color: white;
        }

        .nav-link.active {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .nav-submenu {
            display: none;
            list-style: none;
            background: rgba(0,0,0,0.2);
        }

        .nav-submenu.expanded {
            display: block;
        }

        .nav-submenu .nav-link {
            padding-left: 40px;
            color: white;
            font-weight: normal;
            font-size: 14px;
        }

        .nav-submenu .nav-link:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .nav-submenu .nav-link.active {
            background: rgba(255,255,255,0.15);
            color: white;
        }

        .nav-toggle {
            transition: transform 0.3s;
            margin-left: auto;
            color: white !important;
            font-size: 12px;
        }

        .nav-toggle.expanded {
            transform: rotate(90deg);
        }

        /* 菜单项布局优化 */
        .nav-link {
            position: relative;
        }

        .nav-link span:first-child {
            margin-right: 8px;
            color: white !important;
            font-size: 14px;
        }

        .nav-link span:nth-child(2) {
            flex: 1;
            color: white !important;
        }

        .main-content {
            flex: 1;
            padding: 16px;
            overflow-x: hidden;
        }

        .header {
            background: white;
            padding: 12px 20px;
            border-radius: 4px;
            margin-bottom: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .breadcrumb {
            color: #4b5563;
            font-size: 16px;
        }

        .btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #1890FF;
            color: white;
        }

        .btn-primary:hover {
            background: #096dd9;
        }

        .btn-secondary {
            background: white;
            border: 1px solid #d1d5db;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #f9fafb;
        }
        
        /* 售后报告模块样式 */
        .module {
            display: block;
        }
        
        .module.hidden {
            display: none;
        }
        
        .filter-section {
            background: white;
            padding: 16px;
            border-radius: 4px;
            margin-bottom: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .filter-row {
            display: flex;
            gap: 16px;
            align-items: center;
        }
        
        .filter-input {
            padding: 6px 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            width: 200px;
        }
        
        .filter-input:focus {
            border-color: #1890FF;
            outline: none;
        }
        
        .table-section {
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .table-header {
            padding: 12px 16px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .table-title {
            font-size: 16px;
            font-weight: 500;
            color: #111827;
        }
        
        .table-actions {
            display: flex;
            gap: 12px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        /* 审批流程弹窗样式 */
        .approval-flow-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 16px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 2000;
            width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .approval-flow-modal::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: -1;
        }

        .approval-flow-timeline {
            margin: 20px 0;
            padding: 0;
            list-style: none;
            position: relative;
        }

        .approval-flow-timeline::before {
            content: '';
            position: absolute;
            left: 16px;
            top: 0;
            height: 100%;
            width: 2px;
            background: #e8e8e8;
        }

        .approval-flow-item {
            position: relative;
            margin-bottom: 20px;
            padding-left: 45px;
        }

        .approval-flow-item::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 4px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #1890FF;
        }

        .approval-flow-item.pending::before {
            background: #faad14;
        }

        .approval-flow-item.completed::before {
            background: #52c41a;
        }

        .approval-flow-time {
            font-size: 12px;
            color: #999;
        }

        .approval-flow-content {
            margin-top: 4px;
        }

        .approval-flow-user {
            font-weight: bold;
            margin-right: 8px;
        }

        .approval-flow-status {
            color: #1890FF;
        }

        .status-badge.status-pending {
            background-color: #fff7e6;
            color: #faad14;
            border: 1px solid #faad14;
        }

        .status-badge.status-approved {
            background-color: #f6ffed;
            color: #52c41a;
            border: 1px solid #52c41a;
        }

        /* 下拉菜单样式 */
        .dropdown {
            position: relative;
        }

        .dropdown-content {
            position: absolute;
            right: 0;
            background-color: white;
            min-width: 120px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            border-radius: 4px;
            z-index: 1000;
        }

        .dropdown-content a {
            color: #333;
            padding: 8px 16px;
            text-decoration: none;
            display: block;
            font-size: 14px;
        }

        .dropdown-content a:hover {
            background-color: #f5f5f5;
        }

        /* 报告预览样式 */
        .preview-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 500;
            color: #1890FF;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e8e8e8;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .preview-table td {
            padding: 8px 12px;
            line-height: 1.5;
        }

        .preview-table .label {
            width: 100px;
            color: #666;
            font-weight: 500;
        }

        .preview-text {
            padding: 16px;
            background: #fafafa;
            border-radius: 4px;
            line-height: 1.8;
            color: #333;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            #reportPreviewModal, #reportPreviewModal * {
                visibility: visible;
            }
            #reportPreviewModal {
                position: absolute;
                left: 0;
                top: 0;
            }
            .modal-footer {
                display: none;
            }
        }
        
        .data-table th {
            background: #f9fafb;
            padding: 4px 6px;
            text-align: left;
            font-weight: 500;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .data-table td {
            padding: 4px 6px;
            border-bottom: 1px solid #e5e7eb;
            color: #4b5563;
        }
        
        /* 覆盖所有行内padding样式，统一压缩列间距 */
        .data-table th[style*="padding"],
        .data-table td[style*="padding"] {
            padding: 4px 3px !important;
        }
        
        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        .status-active {
            background: #dcfce7;
            color: #15803d;
        }
        
        .status-badge.status-normal {
            background: #10b981;
            color: white;
        }

        .status-badge.status-urgent {
            background: #f59e0b;
            color: white;
        }

        .status-badge.status-special {
            background: #ef4444;
            color: white;
        }
        
        .action-link {
            color: #1890FF;
            text-decoration: none;
            margin-right: 12px;
            font-size: 14px;
        }
        
        .action-link:hover {
            color: #096dd9;
        }
        
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-top: 1px solid #e5e7eb;
        }
        
        .pagination-info {
            color: #6b7280;
            font-size: 14px;
        }
        
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 24px;
        }
        
        .pagination-size-selector {
            color: #6b7280;
            font-size: 14px;
        }
        
        .pagination-size-selector select {
            margin: 0 8px;
            padding: 4px 8px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
        }
        
        .pagination-nav {
            display: flex;
            gap: 8px;
        }
        
        .pagination-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
            color: #374151;
            cursor: pointer;
        }
        
        .pagination-btn:hover:not(.disabled) {
            background: #f9fafb;
        }
        
        .pagination-btn.active {
            background: #1890FF;
            color: white;
            border-color: #1890FF;
        }
        
        .pagination-btn.disabled {
            color: #9ca3af;
            cursor: not-allowed;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: relative;
            background: white;
            margin: 25px auto;
            border-radius: 8px;
            max-height: calc(100vh - 50px);
            min-height: 65vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 12px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 500;
            color: #111827;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .close-btn:hover {
            color: #111827;
        }

        .modal-body {
            padding: 20px;
        }

        .detail-section {
            margin-bottom: 24px;
            padding: 16px;
            background: #f9fafb;
            border-radius: 4px;
        }

        .detail-section:last-child {
            margin-bottom: 0;
        }

        .detail-title {
            font-size: 16px;
            font-weight: 500;
            color: #111827;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e5e7eb;
        }

        .form-grid {
            display: grid;
            gap: 16px;
        }

        .form-field {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-field label {
            font-size: 14px;
            color: #4b5563;
            font-weight: 500;
        }

        .field-value {
            font-size: 14px;
            color: #111827;
            line-height: 1.6;
        }

        .table-scroll-container {
            overflow-x: auto;
            margin: 0 -20px;
            padding: 0 20px;
        }

        textarea.filter-input {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }
        
        .nav-item {
            border-bottom: 1px solid #374151;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            color: #d1d5db;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
            position: relative;
        }
        
        .nav-link:hover {
            background-color: #374151;
            color: white;
        }
        
        .nav-link.active {
            background-color: #1890FF;
            color: white;
        }
        
        .nav-toggle {
            margin-left: auto;
            transition: transform 0.2s ease;
        }
        
        .nav-toggle.expanded {
            transform: rotate(90deg);
        }
        
        .nav-submenu {
            list-style: none;
            background-color: #1f2937 !important;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .nav-submenu.expanded {
            max-height: 300px;
        }
        
        .nav-submenu .nav-link {
            padding-left: 35px;
            font-size: 13px;
            color: #9ca3af;
        }
        
        .nav-submenu .nav-link:hover {
            background-color: #4b5563 !important;
            color: white;
        }
        
        .nav-submenu .nav-link.active {
            background-color: #1890FF !important;
            color: white;
        }
        
        /* 主内容区 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-left: 200px;
            width: calc(100% - 200px);
        }
        
        .header {
            background: white;
            padding: 16px 24px;
            border-bottom: 1px solid #F0F0F0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }
        
        .breadcrumb {
            font-size: 14px;
            color: #8C8C8C;
        }
        
        .breadcrumb > span {
            color: #1890FF;
        }
        
        .user-info {
            font-size: 14px;
            color: #262626;
        }
        
        .content {
            flex: 1;
            padding: 24px;
            background-color: #F5F5F5;
        }
        
        /* 筛选区域 */
        .filter-section {
            background: white;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid #F0F0F0;
        }
        
        .filter-row {
            display: flex;
            gap: 16px;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .filter-input {
            padding: 8px 12px;
            border: 1px solid #D9D9D9;
            border-radius: 6px;
            font-size: 14px;
            height: 32px;
            transition: all 0.2s ease;
        }
        
        .filter-input:focus {
            outline: none;
            border-color: #1890FF;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
            font-weight: 500;
            min-height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary {
            background-color: #1890FF;
            color: white;
            box-shadow: 0 2px 4px rgba(24, 144, 255, 0.2);
        }
        
        .btn-primary:hover {
            background-color: #40A9FF;
            box-shadow: 0 4px 8px rgba(24, 144, 255, 0.3);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: #F5F5F5;
            color: #666666;
            border: 1px solid #D9D9D9;
        }
        
        .btn-secondary:hover {
            background-color: #E6F7FF;
            border-color: #91D5FF;
            color: #1890FF;
        }
        
        .btn-success {
            background-color: #52C41A;
            color: white;
            box-shadow: 0 2px 4px rgba(82, 196, 26, 0.2);
        }
        
        .btn-success:hover {
            background-color: #73D13D;
            box-shadow: 0 4px 8px rgba(82, 196, 26, 0.3);
            transform: translateY(-1px);
        }
        
        .btn-warning {
            background-color: #FA8C16;
            color: white;
            box-shadow: 0 2px 4px rgba(250, 140, 22, 0.2);
        }
        
        .btn-warning:hover {
            background-color: #FFA940;
            box-shadow: 0 4px 8px rgba(250, 140, 22, 0.3);
            transform: translateY(-1px);
        }
        
        .btn-danger {
            background-color: #FF4D4F;
            color: white;
            box-shadow: 0 2px 4px rgba(255, 77, 79, 0.2);
        }
        
        .btn-danger:hover {
            background-color: #FF7875;
            box-shadow: 0 4px 8px rgba(255, 77, 79, 0.3);
            transform: translateY(-1px);
        }
        
        /* 表格区域 */
        .table-section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid #F0F0F0;
            overflow: visible;
        }
        
        .table-section .table-scroll-container {
            margin: 0;
        }
        
        .table-header {
            padding: 20px 24px;
            border-bottom: 1px solid #F0F0F0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #FAFAFA;
        }
        
        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: #262626;
        }
        
        .table-actions {
            display: flex;
            gap: 12px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #F0F0F0;
            border-radius: 8px;
            overflow: visible;
        }
        
        .data-table th,
        .data-table td {
            padding: 4px 6px;
            text-align: left;
            border-bottom: 1px solid #F0F0F0;
            border-right: 1px solid #F0F0F0;
            font-size: 13px;
        }
        
        .data-table th:last-child,
        .data-table td:last-child {
            border-right: none;
        }
        
        .data-table th {
            background-color: #FAFAFA;
            font-weight: 600;
            color: #262626;
            height: 48px;
            white-space: nowrap;
        }
        
        .data-table tbody tr {
            background-color: white;
            position: relative;
        }
        
        .data-table tbody tr:nth-child(even) {
            background-color: #FAFAFA;
        }
        
        .data-table tbody tr:hover {
            background-color: #E6F7FF;
            cursor: pointer;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            text-align: center;
            min-width: 60px;
        }
        
        .status-active {
            background-color: #F6FFED;
            color: #52C41A;
            border: 1px solid #B7EB8F;
        }
        
        .status-pending {
            background-color: #FFF7E6;
            color: #FA8C16;
            border: 1px solid #FFD591;
        }
        
        .status-draft {
            background-color: #FAFAFA;
            color: #8C8C8C;
            border: 1px solid #D9D9D9;
        }
        
        /* 合同状态样式 */
        .contract-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            text-align: center;
            min-width: 90px;
        }
        
        .contract-status.uploaded {
            background-color: #F6FFED;
            color: #52C41A;
            border: 1px solid #B7EB8F;
        }
        
        .contract-status.contact-confirmed {
            background-color: #F6FFED;
            color: #52C41A;
            border: 1px solid #B7EB8F;
        }
        
        

        .contract-status.tech-uploading {
            background-color: #FFF7E6;
            color: #FA8C16;
            border: 1px solid #FFD591;
        }

        .contract-status.order-generated {
            background-color: #F9F0FF;
            color: #722ED1;
            border: 1px solid #D3ADF7;
        }
        
        /* 表单字段样式 */
        .form-field {
            margin-bottom: 20px;
        }
        
        .form-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #374151;
        }
        
        .required {
            color: #ef4444;
        }
        
        .action-link {
            color: #1890FF;
            text-decoration: none;
            margin-right: 12px;
            font-size: 14px;
            white-space: nowrap;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .action-link:hover {
            background-color: #E6F7FF;
            color: #096DD9;
        }
        
        .action-link.danger {
            color: #FF4D4F;
        }
        
        .action-link.danger:hover {
            background-color: #FFF2F0;
            color: #CF1322;
        }
        
        /* 操作列样式优化 - 固定在右侧留出边距 */
        .data-table td:last-child,
        .data-table th:last-child {
            min-width: 200px;
            white-space: nowrap;
            position: sticky;
            right: -20px;
            background: white;
            z-index: 100;
            border-left: 1px solid #F0F0F0;
            box-shadow: -2px 0 8px rgba(0,0,0,0.1);
        }
        
        /* 表头固定样式 */
        .data-table th:last-child {
            background-color: #FAFAFA;
            z-index: 11;
        }
        
        /* 悬停状态保持背景色 */
        .data-table tbody tr:hover td:last-child {
            background-color: #E6F7FF;
        }
        
        .data-table tbody tr:nth-child(even) td:last-child {
            background-color: #FAFAFA;
        }
        
        .data-table tbody tr:nth-child(even):hover td:last-child {
            background-color: #E6F7FF;
        }
        
        /* 确保滚动容器中的操作列也能正常显示下拉菜单 */
        .table-scroll-container .data-table td:last-child,
        .table-scroll-container .data-table th:last-child {
            position: sticky;
            right: -20px;
            background: white;
            z-index: 100;
            border-left: 1px solid #F0F0F0;
            box-shadow: -2px 0 8px rgba(0,0,0,0.1);
        }
        
        .table-scroll-container .data-table th:last-child {
            background-color: #FAFAFA;
            z-index: 11;
        }
        
        /* 滚动容器中悬停状态 */
        .table-scroll-container .data-table tbody tr:hover td:last-child {
            background-color: #E6F7FF;
        }
        
        .table-scroll-container .data-table tbody tr:nth-child(even) td:last-child {
            background-color: #FAFAFA;
        }
        
        .table-scroll-container .data-table tbody tr:nth-child(even):hover td:last-child {
            background-color: #E6F7FF;
        }

        /* 更多操作下拉菜单样式 */
        .action-dropdown {
            position: relative;
            display: inline-block;
        }

        .action-dropdown-btn {
            background: #f5f5f5;
            color: #666;
            border: 1px solid #d9d9d9;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.2s ease;
        }

        .action-dropdown-btn:hover {
            background: #e6f7ff;
            border-color: #91d5ff;
            color: #1890ff;
        }

        .action-dropdown-content {
            display: none;
            position: fixed;
            background: white;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            z-index: 2147483647;
            min-width: 120px;
            margin-top: 2px;
        }

        .action-dropdown-content.show {
            display: block !important;
            z-index: 2147483647 !important;
        }
        
        .body-dropdown-menu {
            position: fixed;
            background: white;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            z-index: 2147483647;
            min-width: 120px;
        }
        
        .body-dropdown-menu a {
            display: block;
            padding: 8px 12px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        .body-dropdown-menu a:hover {
            background-color: #f5f5f5;
        }

        .action-dropdown-content.show {
            display: block;
        }

        .action-dropdown-item {
            display: block;
            color: #333;
            text-decoration: none;
            padding: 8px 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .action-dropdown-item:last-child {
            border-bottom: none;
        }

        .action-dropdown-item:hover {
            background: #f5f5f5;
            color: #1890ff;
        }

        .action-dropdown-item.danger:hover {
            background: #fff2f0;
            color: #cf1322;
        }
        
        /* 文件上传状态样式 */
        .status-pending {
            color: #faad14;
            font-weight: 500;
        }
        
        .status-uploading {
            color: #1890ff;
            font-weight: 500;
        }
        
        .status-success {
            color: #52c41a;
            font-weight: 500;
        }
        
        .status-error {
            color: #ff4d4f;
            font-weight: 500;
        }
        
        /* 详情模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.45);
            z-index: 1010;
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 1920px;
            max-height: 40%;
            overflow-y: auto;
            box-shadow: 0 16px 48px rgba(0,0,0,0.2);
            border: 1px solid #F0F0F0;
        }
        
        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #F0F0F0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #FAFAFA;
            border-radius: 8px 8px 0 0;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #262626;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #8C8C8C;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .close-btn:hover {
            background-color: #F5F5F5;
            color: #262626;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .detail-section {
            margin-bottom: 24px;
        }
        
        .detail-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #1890FF;
            background: white;
            padding: 10px 15px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
        }
        
        .hidden {
            display: none;
        }
        
        /* 表单样式增强 */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }
        
        .form-grid-4 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 20px;
        }
        
        .form-grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-field {
            margin-bottom: 20px;
        }
        
        .form-field label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #262626;
            font-size: 14px;
        }
        
        .form-field input,
        .form-field select,
        .form-field textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #D9D9D9;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
            height: 32px;
        }
        
        .form-field textarea {
            height: auto;
            min-height: 80px;
            resize: vertical;
        }
        
        .form-field input:focus,
        .form-field select:focus,
        .form-field textarea:focus {
            outline: none;
            border-color: #1890FF;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
        }
        
        .required {
            color: #ef4444;
        }
        
        /* 技术联系人表单样式 */
        #tech-contact-modal .form-field {
            margin-bottom: 20px;
        }
        
        #tech-contact-modal .form-field label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #262626;
            font-size: 14px;
        }
        
        #tech-contact-modal .filter-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #D9D9D9;
            border-radius: 6px;
            font-size: 14px;
            background-color: #ffffff;
            height: 32px;
            transition: all 0.2s ease;
        }
        
        #tech-contact-modal .filter-input:focus {
            outline: none;
            border-color: #1890FF;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
        }
        
        #tech-contact-modal .filter-input:invalid {
            border-color: #dc3545;
        }
        
        #tech-contact-modal textarea.filter-input {
            resize: vertical;
            min-height: 60px;
            line-height: 1.5;
        }

        /* 产品类型表格样式 */
        #tech-task-table {
            font-size: 12px;
        }

        #tech-task-table th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
            padding: 8px 4px;
        }

        #tech-task-table td {
            padding: 6px 4px;
            text-align: center;
        }

        #tech-task-table input,
        #tech-task-table select {
            font-size: 12px;
            padding: 4px 6px;
            height: 28px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background: white;
        }

        #tech-task-table input:focus,
        #tech-task-table select:focus {
            border-color: #1890FF;
            box-shadow: 0 0 0 1px rgba(24, 144, 255, 0.2);
        }

        #tech-task-table input[readonly] {
            background-color: #f9fafb;
            color: #6b7280;
        }

        /* 智能匹配提示样式 */
        .tech-match-hint {
            position: absolute;
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 11px;
            color: #096dd9;
            z-index: 1000;
            max-width: 200px;
        }

        /* 产品建议下拉框样式 */
        .product-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 150px;
            overflow-y: auto;
        }

        .product-suggestion-item {
            padding: 6px 10px;
            cursor: pointer;
            font-size: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .product-suggestion-item:hover {
            background-color: #f0f9ff;
        }

        .product-suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-category {
            font-weight: 600;
            color: #1890FF;
        }

        .suggestion-department {
            color: #6b7280;
            font-size: 10px;
        }
        
        .detail-table-container {
            overflow-x: auto;
            max-height: 300px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
        }
        
        .detail-table-container table {
            margin: 0;
        }
        
        .detail-table-container input,
        .detail-table-container select {
            border: none;
            padding: 4px 8px;
            font-size: 12px;
        }
        
        /* 订单跟踪步骤样式 */
        .track-step {
            padding: 8px 16px;
            background: #e5e7eb;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
        }
        
        .track-step.completed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .track-step.current {
            background: #fbbf24;
            color: #92400e;
        }
        
        .track-arrow {
            margin: 0 5px;
            color: #6b7280;
        }
        
        /* 标签页样式 */
        .tab-item:hover {
            background-color: #f9fafb;
        }
        
        .tab-item.active {
            border-bottom: 2px solid #3b82f6 !important;
            color: #3b82f6 !important;
        }
        
        /* 横向滚动表格容器 */
        .table-scroll-container {
            overflow-x: auto;
            overflow-y: visible;
            width: 100%;
            border: 1px solid #F0F0F0;
            border-radius: 8px;
            position: relative;
            z-index: 1;
        }
        
        .table-scroll-container .data-table {
            min-width: max-content;
            border: none;
            border-radius: 0;
        }
        
        .table-scroll-container .data-table th,
        .table-scroll-container .data-table td {
            white-space: nowrap;
            padding: 4px 6px;
            border-right: 1px solid #F0F0F0;
            font-size: 13px;
        }
        
        .table-scroll-container .data-table th:last-child,
        .table-scroll-container .data-table td:last-child {
            border-right: none;
        }
        
        .table-scroll-container .data-table th {
            background-color: #FAFAFA;
            font-weight: 600;
            color: #262626;
            height: 48px;
        }
        
        /* 订单查询模块保持基本样式 */
        #order-module .table-scroll-container {
            overflow-x: auto;
            overflow-y: auto;
        }
        
        /* 订单查询表格单元格样式 */
        #order-module .data-table td {
            padding: 4px 3px !important;
            word-wrap: break-word;
            word-break: break-all;
            white-space: normal;
            vertical-align: top;
            border-right: 1px solid #e5e7eb;
            border-bottom: 1px solid #e5e7eb;
        }
        
        #order-module .data-table th {
            padding: 4px 3px !important;
            word-wrap: break-word;
            white-space: normal;
            vertical-align: top;
            border-right: 1px solid #e5e7eb;
            border-bottom: 1px solid #e5e7eb;
        }
        
        /* 订单查询模块操作列固定样式 */
        #order-module .data-table td:last-child,
        #order-module .data-table th:last-child {
            position: sticky !important;
            right: -20px !important;
            background: white !important;
            z-index: 100 !important;
            border-left: 1px solid #e5e7eb !important;
            box-shadow: -2px 0 8px rgba(0,0,0,0.1) !important;
            white-space: nowrap !important;
            min-width: 200px !important;
        }
        
        #order-module .data-table th:last-child {
            background-color: #FAFAFA !important;
            z-index: 11 !important;
        }
        
        #order-module .data-table tbody tr:hover td:last-child {
            background-color: #E6F7FF !important;
        }
        
        #order-module .data-table tbody tr:nth-child(even) td:last-child {
            background-color: #FAFAFA !important;
        }
        
        #order-module .data-table tbody tr:nth-child(even):hover td:last-child {
            background-color: #E6F7FF !important;
        }
        
        /* 确保订单查询模块不影响整体布局 */
        #order-module {
            position: relative;
            z-index: 1;
        }
        
        /* 模块通用样式 */
        .module {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            margin-bottom: 24px;
        }
        
        .module-title {
            color: #1890FF;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #F0F0F0;
        }
        
        /* 优化页面整体背景 */
        body {
            background-color: #F5F5F5;
        }
        
        #order-module .filter-section {
            position: relative;
            z-index: 2;
        }
        

        
        /* 通用标识样式 */
        .universal-tag {
            background: #fff7e6;
            color: #fa8c16;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* 产品类型操作按钮样式 */
        .tech-task-actions {
            display: flex;
            gap: 4px;
        }

        .tech-task-actions .btn {
            min-width: 24px;
            height: 24px;
            padding: 2px 6px;
            font-size: 12px;
            border-radius: 3px;
        }

        .tech-task-actions .btn:hover {
            opacity: 0.8;
        }

        /* 产品类型表格整体样式优化 */
        #tech-task-table {
            border-collapse: separate;
            border-spacing: 0;
        }

        #tech-task-table th {
            background: white;
            color: #333333;
            font-weight: 600;
            text-align: center;
            padding: 12px 8px;
            border: 1px solid #e9ecef;
        }

        #tech-task-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: middle;
        }

        /* 物资主行样式 */
        .tech-task-main-row {
            background-color: #ffffff;
            border-left: 4px solid #28a745;
        }

        .tech-task-main-row td:first-child {
            font-weight: 600;
            color: #495057;
        }

        .tech-task-main-row td:nth-child(2) {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: #007bff;
        }

        .tech-task-main-row td:nth-child(3) {
            font-weight: 500;
            color: #343a40;
        }

        /* 附加车间行样式 */
        .tech-task-sub-row {
            background-color: #f8f9fa;
            border-left: 4px solid #6c757d;
        }

        .tech-task-sub-row td {
            border-top: 1px dashed #dee2e6;
        }

        /* 同一物资的连接线效果 */
        .tech-task-sub-row td:first-child {
            position: relative;
            color: #6c757d;
            font-style: italic;
        }

        .tech-task-sub-row td:first-child::before {
            content: "├─";
            position: absolute;
            left: 4px;
            color: #6c757d;
            font-size: 14px;
            font-style: normal;
        }

        .tech-task-sub-row:last-of-type td:first-child::before {
            content: "└─";
        }

        /* 车间选择框样式 */
        .tech-task-sub-row td:nth-child(2),
        .tech-task-sub-row td:nth-child(3) {
            color: #adb5bd;
            font-style: italic;
            opacity: 0.7;
        }

        /* 车间和负责人选择框样式优化 */
        #tech-task-table select {
            border: 1px solid #ced4da;
            border-radius: 6px;
            padding: 6px 10px;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        #tech-task-table select:focus {
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
            outline: none;
        }

        .tech-task-main-row select {
            border-color: #28a745;
        }

        .tech-task-sub-row select {
            border-color: #6c757d;
            background-color: #ffffff;
        }

        /* 操作按钮区域样式优化 */
        .tech-task-actions {
            display: flex;
            gap: 6px;
            justify-content: center;
            align-items: center;
        }

        .tech-task-actions .btn {
            min-width: 28px;
            height: 28px;
            padding: 0;
            font-size: 14px;
            font-weight: 600;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tech-task-actions .btn:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .tech-task-actions .btn-primary:hover {
            background: #e9ecef;
            border-color: #adb5bd;
            color: #212529;
        }

        .tech-task-actions .btn-primary {
            background: #f8f9fa;
            color: #333333;
            border: 1px solid #dee2e6;
        }

        .tech-task-actions .btn-danger {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
        }

        /* 表格悬停效果 */
        #tech-task-table tr:hover {
            background-color: #f1f3f4;
            transition: background-color 0.2s ease;
        }

        .tech-task-sub-row:hover {
            background-color: #e9ecef !important;
        }

        /* 车间标签样式 */
        .tech-department-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tech-department-badge.metering {
            background-color: #e3f2fd;
            color: #1565c0;
            border: 1px solid #bbdefb;
        }

        .tech-department-badge.lowvoltage {
            background-color: #f3e5f5;
            color: #7b1fa2;
            border: 1px solid #ce93d8;
        }

        .tech-department-badge.metalwork {
            background-color: #fff3e0;
            color: #ef6c00;
            border: 1px solid #ffcc02;
        }

        /* 产品卡片样式 */
        .material-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .material-card:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .material-card-header {
            background: white;
            color: #333333;
            padding: 16px 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .material-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .material-code {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: 700;
            background: rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .material-name {
            font-size: 15px;
            font-weight: 500;
            opacity: 0.9;
        }

        .material-card-actions {
            display: flex;
            gap: 8px;
        }

        .material-card-actions .btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            background: #f8f9fa;
            color: #333333;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .material-card-actions .btn:hover {
            background: #e9ecef;
            border-color: #adb5bd;
            color: #212529;
            transform: scale(1.05);
        }

        /* 视图切换按钮样式 */
        .view-switch-group {
            display: flex;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            overflow: hidden;
        }

        .view-switch-btn {
            padding: 8px 16px;
            background: white;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
            border-right: 1px solid #d9d9d9;
        }

        .view-switch-btn:last-child {
            border-right: none;
        }

        .view-switch-btn:hover {
            background: #f5f5f5;
            color: #333;
        }

        .view-switch-btn.active {
            background: #1890FF;
            color: white;
        }

        .view-switch-btn.active:hover {
            background: #40a9ff;
        }

        /* 状态徽章补充样式 */
        .status-badge.status-processing {
            background: #e6f7ff;
            color: #1890ff;
            border: 1px solid #91d5ff;
        }

        .status-badge.status-overdue {
            background: #fff1f0;
            color: #ff4d4f;
            border: 1px solid #ffccc7;
        }

        .material-card-body {
            padding: 20px;
        }

        .tech-department-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .tech-department-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.2s ease;
        }

        .tech-department-item:hover {
            background: #e9ecef;
            border-color: #dee2e6;
        }

        .tech-department-item.editing {
            background: #fff3cd;
            border-color: #ffeaa7;
        }

        .tech-department-select {
            flex: 1;
            max-width: 150px;
        }

        .tech-leader-select {
            flex: 1;
            max-width: 200px;
        }

        .tech-department-item select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            transition: all 0.2s ease;
        }

        .tech-department-item select:focus {
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
            outline: none;
        }

        .tech-department-item-actions {
            display: flex;
            gap: 6px;
        }

        .tech-department-item-actions .btn {
            min-width: 48px;
            height: 32px;
            padding: 4px 8px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .tech-department-item-actions .btn:hover {
            transform: scale(1.1);
        }

        .tech-department-item-actions .btn-danger {
            background: #dc3545;
            color: white;
        }

        .tech-department-item-actions .btn-danger:hover {
            background: #c82333;
        }

        .empty-tech-departments {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .empty-tech-departments i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .add-tech-department-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 16px;
        }

        .add-tech-department-btn:hover {
            background: linear-gradient(135deg, #218838, #1e7e34);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .tech-department-badge-display {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: #e3f2fd;
            color: #1565c0;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
            min-width: 120px;
        }

        .tech-leader-display {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: #f3e5f5;
            color: #7b1fa2;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            min-width: 150px;
        }

        /* 固定悬浮操作面板 */
        .floating-action-panel {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 16px;
            z-index: 1000;
            min-width: 200px;
            display: none;
            border: 1px solid #e9ecef;
        }

        .floating-action-panel.show {
            display: block;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%) translateY(-50%);
                opacity: 0;
            }
            to {
                transform: translateX(0) translateY(-50%);
                opacity: 1;
            }
        }

        .floating-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e9ecef;
        }

        .floating-panel-title {
            font-size: 14px;
            font-weight: 600;
            color: #495057;
        }

        .floating-panel-close {
            background: none;
            border: none;
            font-size: 18px;
            color: #6c757d;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .floating-panel-close:hover {
            background: #f8f9fa;
            color: #495057;
        }

        .floating-action-group {
            margin-bottom: 16px;
        }

        .floating-action-group:last-child {
            margin-bottom: 0;
        }

        .floating-action-group-title {
            font-size: 12px;
            font-weight: 600;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .floating-action-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 4px;
            font-size: 13px;
            color: #495057;
            text-decoration: none;
        }

        .floating-action-item:hover {
            background: #f8f9fa;
            color: #007bff;
            text-decoration: none;
        }

        .floating-action-item.danger:hover {
            background: #f8d7da;
            color: #dc3545;
        }

        .floating-action-item i {
            width: 16px;
            text-align: center;
            font-size: 12px;
        }

        .floating-action-item.primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            font-weight: 600;
        }

        .floating-action-item.primary:hover {
            background: linear-gradient(135deg, #0056b3, #004085);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,123,255,0.3);
        }

        .floating-action-item.success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
            font-weight: 600;
        }

        .floating-action-item.success:hover {
            background: linear-gradient(135deg, #1e7e34, #155724);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(40,167,69,0.3);
        }


        
        /* 审核状态样式 */
        .status-approved {
            background: #f6ffed;
            color: #52c41a;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        .status-reviewing {
            background: #fffbe6;
            color: #faad14;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        .status-pending {
            background: #f0f0f0;
            color: #999;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* 强制保护侧边栏样式 */
        body .sidebar {
            width: 200px !important;
            background: #1e293b !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            transform: translateX(0) !important;
            left: 0 !important;
            position: relative !important;
        }

        /* 防止容器样式被覆盖 */
        .container {
            display: flex !important;
        }

        /* 防止主内容区覆盖侧边栏 */
        .main-content {
            margin-left: 0 !important;
            width: 100% !important;
        }

        /* 可点击行样式 */
        .clickable-row {
            transition: background-color 0.2s ease;
            position: relative;
            z-index: 1;
        }

        .clickable-row:hover {
            background-color: #f0f8ff !important;
            z-index: 1;
        }

        /* 子表区域样式 */
        #sub-table-section {
            border-top: 2px solid #1890ff;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
        }

        #sub-table-section .table-header {
            background: white;
            color: #1890ff;
            border: 1px solid #d9d9d9;
        }

        #sub-table-section .table-title {
            color: #1890ff;
            font-weight: bold;
        }

        /* 发货记录模块样式 */
        .delivery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .delivery-schemes {
            display: flex;
            gap: 10px;
        }

        .scheme-btn {
            padding: 8px 16px;
            border: 1px solid #1890FF;
            background-color: white;
            color: #1890FF;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .scheme-btn.active {
            background-color: #1890FF;
            color: white;
        }

        .scheme-btn:hover {
            background-color: #40A9FF;
            border-color: #40A9FF;
            color: white;
        }

        .delivery-search {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .delivery-select {
            padding: 6px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            background-color: white;
            min-width: 120px;
        }

        .btn-settings {
            background-color: #f5f5f5;
            border: 1px solid #d9d9d9;
            color: #666;
        }

        .btn-settings:hover {
            background-color: #e6f7ff;
            border-color: #1890FF;
            color: #1890FF;
        }

        .delivery-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px 0;
        }

        .delivery-settings {
            display: flex;
            gap: 5px;
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            padding: 0;
            border: 1px solid #d9d9d9;
            background-color: white;
            color: #666;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .btn-icon:hover {
            background-color: #f0f8ff;
            border-color: #1890FF;
            color: #1890FF;
        }

        .delivery-detail {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .delivery-detail-header {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #1890FF;
        }

        .delivery-detail-header h3 {
            margin: 0;
            color: #1890FF;
            font-size: 16px;
            font-weight: bold;
            background: white;
            padding: 10px 15px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
        }
        
        /* 订单详情页面中的明细标题 */
        .order-detail-section h4 {
            background: white !important;
            color: #1890FF !important;
            padding: 10px 15px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        /* 分页样式 */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-top: 1px solid #e5e7eb;
            margin-top: 16px;
        }

        .pagination-info {
            font-size: 14px;
            color: #6b7280;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .pagination-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .pagination-size-selector select {
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 14px;
        }

        .pagination-nav {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pagination-btn {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            min-width: 40px;
            text-align: center;
        }

        .pagination-btn:hover:not(.disabled) {
            background: #f3f4f6;
            border-color: #9ca3af;
        }

        .pagination-btn.active {
            background: #1890ff;
            border-color: #1890ff;
            color: white;
        }

        .pagination-btn.disabled {
            background: #f9fafb;
            color: #d1d5db;
            cursor: not-allowed;
        }

        .pagination-jump {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .pagination-jump input {
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 4px 8px;
            width: 60px;
            text-align: center;
            font-size: 14px;
        }

        .pagination-jump button {
            padding: 4px 8px;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .pagination-jump button:hover {
            background: #f3f4f6;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- 左侧导航 -->
        <nav class="sidebar">
            <div class="logo">工业互联网平台</div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" onclick="toggleSubmenu(event)">
                        <span style="color: white;">📋</span><span> 营销管理</span>
                        <span class="nav-toggle expanded" style="color: white;">▶</span>
                    </a>
                    <ul class="nav-submenu expanded">
                        <li><a href="#" class="nav-link active" onclick="return showModule('bid', event)">框架协议管理</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('contract', event)">合同管理</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('unconfirmed-contact', event)">未确认联系人</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('sales', event)">销售订单</a></li>
                        <li style="display: none;"><a href="#" class="nav-link" onclick="return showModule('order', event)">订单查询</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('survey', event)">客户满意度调查</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('delivery', event)">发货记录</a></li>
                    </ul>
                </li>
                <!-- 新增售后协同主菜单及子菜单 -->
                <li class="nav-item" style="display: none;">
                    <a href="#" class="nav-link" onclick="toggleSubmenu(event)">
                        <span style="color: white;">🛠️</span><span> 售后协同</span>
                        <span class="nav-toggle" style="color: white;">▶</span>
                    </a>
                    <ul class="nav-submenu">
                        <li><a href="#" class="nav-link" onclick="return showModule('aftersale-apply', event)">售后申请</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('aftersale-order', event)">售后单管理</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('aftersale-dispatch', event)">售后派工管理</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('aftersale-delivery', event)">售后发货记录</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('receipt-record', event)">收货记录</a></li>
                        <li><a href="#" class="nav-link" onclick="return showModule('aftersale-report', event)">售后报告</a></li>
                    </ul>
                </li>
            </ul>
        </nav>

        <!-- 主内容区 -->
        <main class="main-content">
            <header class="header">
                <div class="breadcrumb">
                    <span id="current-module">框架协议管理</span>
                </div>
            </header>

            <div class="content">
                <!-- 售后报告模块 -->
                <div id="aftersale-report-module" class="module hidden">
                    <!-- 筛选区 -->
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入售后单号">
                            <input type="text" class="filter-input" placeholder="请输入客户名称">
                            <div style="display: inline-block;">
                                <span style="margin-right: 8px;">结案日期：</span>
                                <input type="date" class="filter-input" style="width: 140px;">
                                <span style="margin: 0 8px;">至</span>
                                <input type="date" class="filter-input" style="width: 140px;">
                            </div>
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                    </div>

                    <!-- 表格区域 -->
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">售后报告列表</div>
                            <div class="table-actions">
                                <button class="btn btn-secondary">导出全部</button>
                            </div>
                        </div>
                        <div class="table-scroll-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;">序号</th>
                                        <th style="width: 120px;">售后单号</th>
                                        <th style="width: 180px;">客户名称</th>
                                        <th style="width: 200px;">产品信息</th>
                                        <th style="width: 120px;">结案时间</th>
                                        <th style="width: 100px;">报告状态</th>
                                        <th style="width: 300px;">操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>SH-25070001</td>
                                        <td>江苏食品技术有限公司</td>
                                        <td>WL-25040003/铝合金/3</td>
                                        <td>2025-07-01</td>
                                        <td><span class="status-badge status-approved">已审核</span></td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReportDetail('SH-25070001')">详情</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReport('SH-25070001')">在线预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-SH-25070001')">更多 ▼</a>
                                                <div id="dropdown-SH-25070001" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070001', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070001', 'word')">导出Word</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>SH-25070002</td>
                                        <td>河南科技集团有限公司</td>
                                        <td>WL-25040005/不锈钢/2</td>
                                        <td>2025-07-02</td>
                                        <td><span class="status-badge status-pending">审核中</span></td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReportDetail('SH-25070002')">详情</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReport('SH-25070002')">在线预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-SH-25070002')">更多 ▼</a>
                                                <div id="dropdown-SH-25070002" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070002', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070002', 'word')">导出Word</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>SH-25070003</td>
                                        <td>安徽电力设备有限公司</td>
                                        <td>WL-25040008/铜材/1</td>
                                        <td>2025-07-03</td>
                                        <td><span class="status-badge status-approved">已审核</span></td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReportDetail('SH-25070003')">详情</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReport('SH-25070003')">在线预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-SH-25070003')">更多 ▼</a>
                                                <div id="dropdown-SH-25070003" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070003', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070003', 'word')">导出Word</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>SH-25070004</td>
                                        <td>浙江机械制造股份公司</td>
                                        <td>WL-25040012/钢材/5</td>
                                        <td>2025-07-04</td>
                                        <td><span class="status-badge status-pending">审核中</span></td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReportDetail('SH-25070004')">详情</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReport('SH-25070004')">在线预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-SH-25070004')">更多 ▼</a>
                                                <div id="dropdown-SH-25070004" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070004', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070004', 'word')">导出Word</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>SH-25070005</td>
                                        <td>广东工业设备有限公司</td>
                                        <td>WL-25040015/铝材/4</td>
                                        <td>2025-07-05</td>
                                        <td><span class="status-badge status-approved">已审核</span></td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReportDetail('SH-25070005')">详情</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReport('SH-25070005')">在线预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-SH-25070005')">更多 ▼</a>
                                                <div id="dropdown-SH-25070005" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070005', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReport('SH-25070005', 'word')">导出Word</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!-- 分页器 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span>1</span> 条记录，第 <span>1</span>/<span>1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn disabled">首页</button>
                                    <button class="pagination-btn disabled">上一页</button>
                                    <button class="pagination-btn active">1</button>
                                    <button class="pagination-btn disabled">下一页</button>
                                    <button class="pagination-btn disabled">末页</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 报告预览弹窗 -->
                    <div id="reportPreviewModal" class="modal">
                        <div class="modal-content" style="width: 1440px; padding: 0;">
                            <div class="modal-header" style="padding: 16px 24px; border-bottom: 1px solid #e8e8e8;">
                                <h3 style="margin: 0;">售后报告预览</h3>
                                <button class="close-btn" onclick="closeReportPreview()">×</button>
                            </div>
                            <div class="modal-body" style="padding: 24px;">
                                <div class="preview-header" style="text-align: center; margin-bottom: 30px;">
                                    <h2>售后服务报告</h2>
                                    <div style="color: #666; margin-top: 8px;">报告编号：<span id="preview-report-id"></span></div>
                                </div>
                                <div class="preview-content">
                                    <!-- 基本信息 -->
                                    <div class="preview-section">
                                        <h3 class="section-title">基本信息</h3>
                                        <table class="preview-table">
                                            <tr>
                                                <td class="label">客户名称：</td>
                                                <td id="preview-customer-name"></td>
                                                <td class="label">产品信息：</td>
                                                <td id="preview-product-info"></td>
                                            </tr>
                                            <tr>
                                                <td class="label">报告日期：</td>
                                                <td id="preview-report-date"></td>
                                                <td class="label">处理状态：</td>
                                                <td id="preview-status"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    
                                    <!-- 问题描述 -->
                                    <div class="preview-section">
                                        <h3 class="section-title">问题描述</h3>
                                        <div class="preview-text" id="preview-problem-desc">
                                        </div>
                                    </div>

                                    <!-- 处理过程 -->
                                    <div class="preview-section">
                                        <h3 class="section-title">处理过程</h3>
                                        <div class="preview-text" id="preview-process">
                                        </div>
                                    </div>

                                    <!-- 解决方案 -->
                                    <div class="preview-section">
                                        <h3 class="section-title">解决方案</h3>
                                        <div class="preview-text" id="preview-solution">
                                        </div>
                                    </div>

                                    <!-- 改进建议 -->
                                    <div class="preview-section">
                                        <h3 class="section-title">改进建议</h3>
                                        <div class="preview-text" id="preview-suggestions">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer" style="padding: 16px 24px; border-top: 1px solid #e8e8e8; text-align: right;">
                                <button class="btn btn-primary" onclick="printPreview()">打印预览</button>
                                <button class="btn btn-secondary" onclick="closeReportPreview()" style="margin-left: 8px;">关闭</button>
                            </div>
                        </div>
                    </div>

                    <!-- 审批流程弹窗 -->
                    <div id="approvalFlowModal" class="approval-flow-modal">
                        <h3>审批流程</h3>
                        <div class="modal-content">
                            <ul class="approval-flow-timeline" id="approvalFlowTimeline">
                                <!-- 审批流程内容将通过JavaScript动态添加 -->
                            </ul>
                        </div>
                        <div class="modal-footer">
                            <button onclick="closeApprovalFlow()" class="btn btn-secondary">关闭</button>
                        </div>
                    </div>

                    <!-- 售后报告详情弹窗 -->
                    <div id="report-detail-modal" class="modal">
                        <div class="modal-content" style="width: 1280px;">
                            <div class="modal-header">
                                <span class="modal-title">售后报告详情</span>
                                <button class="close-btn" onclick="closeReportDetail()">×</button>
                            </div>
                            <div class="modal-body">
                                <!-- Part 1: 事件概述 -->
                                <div class="detail-section">
                                    <div class="detail-title">Part 1: 事件概述</div>
                                    <div class="form-grid" style="grid-template-columns: 1fr;">
                                        <div class="form-field">
                                            <label>客户名称</label>
                                            <div class="field-value">江苏食品技术有限公司</div>
                                        </div>
                                        <div class="form-field">
                                            <label>产品信息</label>
                                            <div class="field-value">WL-25040003/铝合金/3</div>
                                        </div>
                                        <div class="form-field">
                                            <label>初始问题描述</label>
                                            <div class="field-value">产品表面有划痕，影响使用效果</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Part 2: 处理过程 -->
                                <div class="detail-section">
                                    <div class="detail-title">Part 2: 处理过程</div>
                                    <div class="form-grid" style="grid-template-columns: 1fr;">
                                        <div class="form-field">
                                            <label>现场服务总结</label>
                                            <div class="field-value">
                                                <ul style="list-style-type: disc; margin-left: 20px;">
                                                    <li>2025-06-28 工程师张三：完成现场检查，确认是生产过程中的划痕</li>
                                                    <li>2025-06-29 更换新部件，并进行安装调试</li>
                                                    <li>2025-06-30 客户确认问题解决，签字确认</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="form-field">
                                            <label>配件发货记录</label>
                                            <div class="field-value">
                                                <ul style="list-style-type: disc; margin-left: 20px;">
                                                    <li>2025-06-28，快递单号SF1234567890，新铝合金部件*1</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Part 3: 内部原因分析与改进 -->
                                <div class="detail-section">
                                    <div class="detail-title">Part 3: 内部原因分析与改进</div>
                                    <div class="form-grid" style="grid-template-columns: 1fr;">
                                        <div class="form-field">
                                            <label>根本原因分析（Check）</label>
                                            <textarea class="filter-input" style="width: 100%; min-height: 80px;">1. 生产工艺流程执行不严格
2. 质检环节未能及时发现问题
3. 包装运输保护不足</textarea>
                                        </div>
                                        <div class="form-field">
                                            <label>纠正与预防措施（Act）</label>
                                            <textarea class="filter-input" style="width: 100%; min-height: 80px;">1. 加强工艺培训，完善质检流程
2. 增加出厂前的表面质量检查环节
3. 改进产品包装方案，增加防护措施</textarea>
                                        </div>
                                    </div>
                                    <div style="text-align: center; margin-top: 20px;">
                                        <button class="btn btn-primary">保存分析结果</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 收货记录模块 -->
                <div id="receipt-record-module" class="module hidden">
                    <!-- 筛选区 -->
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入收货单号">
                            <input type="text" class="filter-input" placeholder="请输入客户名称">
                            <input type="text" class="filter-input" placeholder="请输入订单编号">
                            <div style="display: inline-block;">
                                <span style="margin-right: 8px;">收货日期：</span>
                                <input type="date" class="filter-input" style="width: 140px;">
                                <span style="margin: 0 8px;">至</span>
                                <input type="date" class="filter-input" style="width: 140px;">
                            </div>
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                    </div>

                    <!-- 表格区域 -->
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">收货记录列表</div>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="showReceiptForm()">新增收货记录</button>
                                <button class="btn btn-secondary">导出</button>
                            </div>
                        </div>
                        <div class="table-scroll-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;">序号</th>
                                        <th style="width: 120px;">收货单号</th>
                                        <th style="width: 120px;">订单编号</th>
                                        <th style="width: 180px;">客户名称</th>
                                        <th style="width: 200px;">产品信息</th>
                                        <th style="width: 120px;">收货日期</th>
                                        <th style="width: 100px;">收货状态</th>
                                        <th style="width: 100px;">收货人</th>
                                        <th style="width: 120px;">收货地址</th>
                                        <th style="width: 300px;">操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>RC-25070001</td>
                                        <td>XS-2505010</td>
                                        <td>江苏食品技术有限公司</td>
                                        <td>WL-25040003/铝合金/3</td>
                                        <td>2025-07-01</td>
                                        <td><span class="status-badge status-approved">已收货</span></td>
                                        <td>张经理</td>
                                        <td>江苏省南京市</td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReceiptDetail('RC-25070001')">详情</a>
                                            <a href="#" class="action-link" onclick="editReceipt('RC-25070001')">编辑</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReceipt('RC-25070001')">预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-RC-25070001')">更多 ▼</a>
                                                <div id="dropdown-RC-25070001" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070001', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070001', 'excel')">导出Excel</a>
                                                    <a href="#" onclick="event.preventDefault(); deleteReceipt('RC-25070001')" style="color: #ff4d4f;">删除</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>RC-25070002</td>
                                        <td>XS-2505005</td>
                                        <td>豫北食品有限公司</td>
                                        <td>WL-25040005/不锈钢/2</td>
                                        <td>2025-07-02</td>
                                        <td><span class="status-badge status-pending">待收货</span></td>
                                        <td>李主管</td>
                                        <td>河南省郑州市</td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReceiptDetail('RC-25070002')">详情</a>
                                            <a href="#" class="action-link" onclick="editReceipt('RC-25070002')">编辑</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReceipt('RC-25070002')">预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-RC-25070002')">更多 ▼</a>
                                                <div id="dropdown-RC-25070002" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070002', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070002', 'excel')">导出Excel</a>
                                                    <a href="#" onclick="event.preventDefault(); deleteReceipt('RC-25070002')" style="color: #ff4d4f;">删除</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>RC-25070003</td>
                                        <td>XS-2505003</td>
                                        <td>河南科技集团有限公司</td>
                                        <td>WL-25040008/铜材/1</td>
                                        <td>2025-07-03</td>
                                        <td><span class="status-badge status-approved">已收货</span></td>
                                        <td>王工程师</td>
                                        <td>河南省洛阳市</td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReceiptDetail('RC-25070003')">详情</a>
                                            <a href="#" class="action-link" onclick="editReceipt('RC-25070003')">编辑</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReceipt('RC-25070003')">预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-RC-25070003')">更多 ▼</a>
                                                <div id="dropdown-RC-25070003" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070003', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070003', 'excel')">导出Excel</a>
                                                    <a href="#" onclick="event.preventDefault(); deleteReceipt('RC-25070003')" style="color: #ff4d4f;">删除</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>RC-25070004</td>
                                        <td>XS-2505008</td>
                                        <td>浙江机械制造股份公司</td>
                                        <td>WL-25040012/钢材/5</td>
                                        <td>2025-07-04</td>
                                        <td><span class="status-badge status-pending">待收货</span></td>
                                        <td>赵技术员</td>
                                        <td>浙江省杭州市</td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReceiptDetail('RC-25070004')">详情</a>
                                            <a href="#" class="action-link" onclick="editReceipt('RC-25070004')">编辑</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReceipt('RC-25070004')">预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-RC-25070004')">更多 ▼</a>
                                                <div id="dropdown-RC-25070004" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070004', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070004', 'excel')">导出Excel</a>
                                                    <a href="#" onclick="event.preventDefault(); deleteReceipt('RC-25070004')" style="color: #ff4d4f;">删除</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>RC-25070005</td>
                                        <td>XS-2505012</td>
                                        <td>广东工业设备有限公司</td>
                                        <td>WL-25040015/铝材/4</td>
                                        <td>2025-07-05</td>
                                        <td><span class="status-badge status-approved">已收货</span></td>
                                        <td>陈经理</td>
                                        <td>广东省深圳市</td>
                                        <td>
                                            <a href="#" class="action-link" onclick="showReceiptDetail('RC-25070005')">详情</a>
                                            <a href="#" class="action-link" onclick="editReceipt('RC-25070005')">编辑</a>
                                            <a href="#" class="action-link" onclick="event.preventDefault(); previewReceipt('RC-25070005')">预览</a>
                                            <div class="dropdown" style="display: inline-block;">
                                                <a href="#" class="action-link" onclick="toggleDropdown(event, 'dropdown-RC-25070005')">更多 ▼</a>
                                                <div id="dropdown-RC-25070005" class="dropdown-content" style="display: none;">
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070005', 'pdf')">导出PDF</a>
                                                    <a href="#" onclick="event.preventDefault(); exportReceipt('RC-25070005', 'excel')">导出Excel</a>
                                                    <a href="#" onclick="event.preventDefault(); deleteReceipt('RC-25070005')" style="color: #ff4d4f;">删除</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!-- 分页器 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span>5</span> 条记录，第 <span>1</span>/<span>1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn disabled">首页</button>
                                    <button class="pagination-btn disabled">上一页</button>
                                    <button class="pagination-btn active">1</button>
                                    <button class="pagination-btn disabled">下一页</button>
                                    <button class="pagination-btn disabled">末页</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 框架协议管理模块 -->
                <div id="bid-module" class="module">
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入ECP合同编号">
                            <input type="text" class="filter-input" placeholder="请输入框架协议名称">
                            <input type="text" class="filter-input" placeholder="请输入买方">
                            <input type="text" class="filter-input" placeholder="请输入卖方">
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">框架协议管理列表</div>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="showBidForm()">新增框架协议</button>
                                <button class="btn btn-secondary">导出</button>
                            </div>
                        </div>
                        <div class="table-scroll-container">
                            <table class="data-table" style="min-width: 3200px; width: 100%;">
                            <thead>
                                <tr>
                                        <th style="width: 80px;">序号</th>
                                        <th style="width: 180px;">合同编号（买方）</th>
                                        <th style="width: 180px;">合同编号（卖方）</th>
                                        <th style="width: 200px;">框架协议名称</th>
                                        <th style="width: 200px;">货物名称</th>
                                        <th style="width: 220px;">买方</th>
                                        <th style="width: 180px;">卖方</th>
                                        <th style="width: 120px;">签订日期</th>
                                        <th style="width: 150px;">合同价款(含税)人民币元</th>
                                        <th style="width: 150px;">合同价款(不含税)人民币元</th>
                                        <th style="width: 150px;">签订地点</th>
                                        <th style="width: 120px;">买方联系人</th>
                                        <th style="width: 120px;">买方电话</th>
                                        <th style="width: 120px;">买方传真</th>
                                        <th style="width: 120px;">买方email</th>
                                        <th style="width: 120px;">卖方联系人</th>
                                        <th style="width: 120px;">卖方电话</th>
                                        <th style="width: 120px;">卖方传真</th>
                                        <th style="width: 120px;">卖方email</th>
                                        <th style="width: 200px;">操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr onclick="showBidSubTable('BID-2025001')" style="cursor: pointer;" class="clickable-row">
                                    <td>1</td>
                                    <td>SGAH-BUYER-2025001</td>
                                    <td>HNGS-SELLER-2025001</td>
                                    <td>2025年电力设备采购标包</td>
                                    <td>高压开关柜、配电变压器、电缆</td>
                                    <td>国网安徽省电力有限公司物资分公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td>2025-05-15</td>
                                    <td>¥1,580,000.00</td>
                                    <td>¥1,371,681.42</td>
                                    <td>河南省郑州市金水区</td>
                                    <td>张经理</td>
                                    <td>0551-65432100</td>
                                    <td>0551-65432101</td>
                                    <td>zhang@sgah.com</td>
                                    <td>李总经理</td>
                                    <td>0371-67890123</td>
                                    <td>0371-67890124</td>
                                    <td>li@hngs.com</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showBidDetail('BID-2025001')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editBid('BID-2025001')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadBidFile('BID-2025001')">框架协议文件上传</a>
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteBid('BID-2025001')">删除</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr onclick="showBidSubTable('BID-2025002')" style="cursor: pointer;" class="clickable-row">
                                    <td>2</td>
                                    <td>JSSP-BUYER-2025002</td>
                                    <td>HNGS-SELLER-2025002</td>
                                    <td>变压器采购标包</td>
                                    <td>S11-M配电变压器、油浸式变压器</td>
                                    <td>江苏食品技术有限公司采购部</td>
                                    <td>河南光大实业有限公司</td>
                                    <td>2025-05-18</td>
                                    <td>¥2,354,500.00</td>
                                    <td>¥2,039,823.01</td>
                                    <td>江苏省南京市建邺区</td>
                                    <td>王采购</td>
                                    <td>025-83456789</td>
                                    <td>025-83456790</td>
                                    <td>wang@jssp.com</td>
                                    <td>李总经理</td>
                                    <td>0371-67890123</td>
                                    <td>0371-67890124</td>
                                    <td>li@hngs.com</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showBidDetail('BID-2025002')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editBid('BID-2025002')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadBidFile('BID-2025002')">框架协议文件上传</a>
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteBid('BID-2025002')">删除</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr onclick="showBidSubTable('BID-2025003')" style="cursor: pointer;" class="clickable-row">
                                    <td>3</td>
                                    <td>HNKJ-BUYER-2025003</td>
                                    <td>HNGS-SELLER-2025003</td>
                                    <td>配电设备采购标包</td>
                                    <td>配电控制柜、钣金箱体、计量表箱</td>
                                    <td>河南科技集团有限公司采购中心</td>
                                    <td>河南光大实业有限公司</td>
                                    <td>2025-05-20</td>
                                    <td>¥980,000.00</td>
                                    <td>¥849,557.52</td>
                                    <td>河南省洛阳市涧西区</td>
                                    <td>刘主任</td>
                                    <td>0379-65432100</td>
                                    <td>0379-65432101</td>
                                    <td>liu@hnkj.com</td>
                                    <td>李总经理</td>
                                    <td>0371-67890123</td>
                                    <td>0371-67890124</td>
                                    <td>li@hngs.com</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showBidDetail('BID-2025003')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editBid('BID-2025003')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadBidFile('BID-2025003')">框架协议文件上传</a>
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteBid('BID-2025003')">删除</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        </div>
                        <!-- 标包管理分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="bid-total-count">3</span> 条记录，第 <span id="bid-current-page">1</span>/<span id="bid-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="bid-page-size" onchange="changeBidPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="bid-first-btn" onclick="gotoBidPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="bid-prev-btn" onclick="gotoBidPage(getCurrentBidPage() - 1)" disabled>上一页</button>
                                    <div id="bid-page-numbers"></div>
                                    <button class="pagination-btn" id="bid-next-btn" onclick="gotoBidPage(getCurrentBidPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="bid-last-btn" onclick="gotoBidPage(getTotalBidPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="bid-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToBidPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 合同管理模块 -->
                <div id="contract-module" class="module hidden">
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入合同编号">
                            <input type="text" class="filter-input" placeholder="请输入框架协议名称">
                            <input type="text" class="filter-input" placeholder="请输入买方">
                            <select class="filter-input">
                                <option>请选择订单类型</option>
                                <option>正常</option>
                                <option>紧急</option>
                                <option>特急</option>
                            </select>
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">合同管理列表</div>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="showContractForm()">新增合同</button>
                                <button class="btn btn-secondary">导出</button>
                            </div>
                        </div>
                        <div class="table-scroll-container">
                            <table class="data-table" style="min-width: 2200px; width: 100%;">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;">序号</th>
                                        <th style="width: 70px;">订单类型</th>
                                        <th style="width: 100px;">供货单号</th>
                                        <th style="width: 150px;">合同编号（买方）</th>
                                        <th style="width: 150px;">框架协议名称</th>
                                        <th style="width: 140px;">买方</th>
                                        <th style="width: 120px;">卖方</th>
                                        <th style="width: 120px;">合同状态</th>
                                        <th style="width: 100px;">分项价(不含税)</th>
                                        <th style="width: 100px;">分项价(含税)</th>
                                        <th style="width: 100px;">RE含税单价</th>
                                        <th style="width: 90px;">签订日期</th>
                                        <th style="width: 90px;">创建时间</th>
                                        <th style="width: 180px;">操作</th>
                                    </tr>
                                </thead>
                            <tbody>
                                <tr onclick="showContractSubTable('CON-2025001')" style="cursor: pointer;" class="clickable-row">
                                    <td>1</td>
                                    <td><span class="status-badge status-normal">正常</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025001')" style="font-weight: 600; color: #1890ff;">SGD-2025001001</a></td>
                                    <td>SGAH-AGREEMENTSTOCK-2025001</td>
                                    <td>2025年电力设备采购标包</td>
                                    <td>国网安徽省电力有限公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td><span class="contract-status contact-confirmed">销售确认联系人</span></td>
                                    <td>¥1,371,681.42</td>
                                    <td>¥1,580,000.00</td>
                                    <td>¥65,000.00</td>
                                    <td>2025-05-15</td>
                                    <td>2025-05-23</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025001')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editContract('CON-2025001')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteContract('CON-2025001')">删除</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadContract('CON-2025001')">上传合同</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showTechContact('CON-2025001')">确认技术联系人</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showContractUploadSurvey('CON-2025001')">上传满意度调查表</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                                <tr onclick="showContractSubTable('CON-2025002')" style="cursor: pointer;" class="clickable-row">
                                    <td>2</td>
                                    <td><span class="status-badge status-urgent">紧急</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025002')" style="font-weight: 600; color: #1890ff;">SGD-2025001002</a></td>
                                    <td>JSSP-AGREEMENTSTOCK-2025002</td>
                                    <td>变压器采购标包</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td><span class="contract-status tech-uploading">技术图纸受控上传</span></td>
                                    <td>¥2,039,823.01</td>
                                    <td>¥2,354,500.00</td>
                                    <td>¥28,500.00</td>
                                    <td>2025-05-18</td>
                                    <td>2025-05-25</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025002')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editContract('CON-2025002')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteContract('CON-2025002')">删除</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadContract('CON-2025002')">上传合同</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showTechContact('CON-2025002')">确认技术联系人</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showContractUploadSurvey('CON-2025002')">上传满意度调查表</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                                <tr onclick="showContractSubTable('CON-2025003')" style="cursor: pointer;" class="clickable-row">
                                    <td>3</td>
                                    <td><span class="status-badge status-special">特急</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025003')" style="font-weight: 600; color: #1890ff;">SGD-2025001003</a></td>
                                    <td>HNKJ-AGREEMENTSTOCK-2025003</td>
                                    <td>配电设备采购标包</td>
                                    <td>河南科技集团有限公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td><span class="contract-status order-generated">生成销售订单</span></td>
                                    <td>¥849,557.52</td>
                                    <td>¥980,000.00</td>
                                    <td>¥12,800.00</td>
                                    <td>2025-05-20</td>
                                    <td>2025-05-26</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025003')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editContract('CON-2025003')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteContract('CON-2025003')">删除</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadContract('CON-2025003')">上传合同</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showTechContact('CON-2025003')">确认技术联系人</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showContractUploadSurvey('CON-2025003')">上传满意度调查表</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        </div>
                        <!-- 合同管理分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="contract-total-count">3</span> 条记录，第 <span id="contract-current-page">1</span>/<span id="contract-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="contract-page-size" onchange="changeContractPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="contract-first-btn" onclick="gotoContractPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="contract-prev-btn" onclick="gotoContractPage(getCurrentContractPage() - 1)" disabled>上一页</button>
                                    <div id="contract-page-numbers"></div>
                                    <button class="pagination-btn" id="contract-next-btn" onclick="gotoContractPage(getCurrentContractPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="contract-last-btn" onclick="gotoContractPage(getTotalContractPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="contract-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToContractPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 未确认联系人模块 -->
                <div id="unconfirmed-contact-module" class="module hidden">
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入合同编号">
                            <input type="text" class="filter-input" placeholder="请输入框架协议名称">
                            <input type="text" class="filter-input" placeholder="请输入买方">
                            <select class="filter-input">
                                <option>请选择订单类型</option>
                                <option>正常</option>
                                <option>紧急</option>
                                <option>特急</option>
                            </select>
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">未确认联系人列表</div>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="showTechContactForm()">确认技术联系人</button>
                                <button class="btn btn-secondary">导出</button>
                            </div>
                        </div>
                        <div class="table-scroll-container">
                            <table class="data-table" style="min-width: 2200px; width: 100%;">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;">序号</th>
                                        <th style="width: 70px;">订单类型</th>
                                        <th style="width: 100px;">供货单号</th>
                                        <th style="width: 150px;">合同编号（买方）</th>
                                        <th style="width: 150px;">框架协议名称</th>
                                        <th style="width: 140px;">买方</th>
                                        <th style="width: 120px;">卖方</th>
                                        <th style="width: 120px;">合同状态</th>
                                        <th style="width: 100px;">分项价(不含税)</th>
                                        <th style="width: 100px;">分项价(含税)</th>
                                        <th style="width: 100px;">RE含税单价</th>
                                        <th style="width: 90px;">签订日期</th>
                                        <th style="width: 90px;">创建时间</th>
                                        <th style="width: 180px;">操作</th>
                                    </tr>
                                </thead>
                            <tbody>
                                <tr onclick="showContractSubTable('CON-2025001')" style="cursor: pointer;" class="clickable-row">
                                    <td>1</td>
                                    <td><span class="status-badge status-normal">正常</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025001')" style="font-weight: 600; color: #1890ff;">SGD-2025001001</a></td>
                                    <td>SGAH-AGREEMENTSTOCK-2025001</td>
                                    <td>2025年电力设备采购标包</td>
                                    <td>国网安徽省电力有限公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td><span class="contract-status contact-confirmed">销售确认联系人</span></td>
                                    <td>¥1,371,681.42</td>
                                    <td>¥1,580,000.00</td>
                                    <td>¥65,000.00</td>
                                    <td>2025-05-15</td>
                                    <td>2025-05-23</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025001')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editContract('CON-2025001')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteContract('CON-2025001')">删除</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadContract('CON-2025001')">上传合同</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showTechContact('CON-2025001')">确认技术联系人</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showContractUploadSurvey('CON-2025001')">上传满意度调查表</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                                <tr onclick="showContractSubTable('CON-2025002')" style="cursor: pointer;" class="clickable-row">
                                    <td>2</td>
                                    <td><span class="status-badge status-urgent">紧急</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025002')" style="font-weight: 600; color: #1890ff;">SGD-2025001002</a></td>
                                    <td>JSSP-AGREEMENTSTOCK-2025002</td>
                                    <td>变压器采购标包</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td><span class="contract-status tech-uploading">技术图纸受控上传</span></td>
                                    <td>¥2,039,823.01</td>
                                    <td>¥2,354,500.00</td>
                                    <td>¥28,500.00</td>
                                    <td>2025-05-18</td>
                                    <td>2025-05-25</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025002')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editContract('CON-2025002')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteContract('CON-2025002')">删除</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadContract('CON-2025002')">上传合同</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showTechContact('CON-2025002')">确认技术联系人</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showContractUploadSurvey('CON-2025002')">上传满意度调查表</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                                <tr onclick="showContractSubTable('CON-2025003')" style="cursor: pointer;" class="clickable-row">
                                    <td>3</td>
                                    <td><span class="status-badge status-special">特急</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025003')" style="font-weight: 600; color: #1890ff;">SGD-2025001003</a></td>
                                    <td>HNKJ-AGREEMENTSTOCK-2025003</td>
                                    <td>配电设备采购标包</td>
                                    <td>河南科技集团有限公司</td>
                                    <td>河南光大实业有限公司</td>
                                    <td><span class="contract-status order-generated">生成销售订单</span></td>
                                    <td>¥849,557.52</td>
                                    <td>¥980,000.00</td>
                                    <td>¥12,800.00</td>
                                    <td>2025-05-20</td>
                                    <td>2025-05-26</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showContractDetail('CON-2025003')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); editContract('CON-2025003')">编辑</a>
                                        <div class="action-dropdown">
                                            <button class="action-dropdown-btn" onclick="event.stopPropagation(); toggleActionDropdown(this)">
                                                更多 <span style="color: white;">▼</span>
                                            </button>
                                            <div class="action-dropdown-content">
                                                <a href="#" class="action-dropdown-item danger" onclick="event.stopPropagation(); deleteContract('CON-2025003')">删除</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); uploadContract('CON-2025003')">上传合同</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showTechContact('CON-2025003')">确认技术联系人</a>
                                                <a href="#" class="action-dropdown-item" onclick="event.stopPropagation(); showContractUploadSurvey('CON-2025003')">上传满意度调查表</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        </div>
                        <!-- 未确认联系人分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="unconfirmed-contact-total-count">3</span> 条记录，第 <span id="unconfirmed-contact-current-page">1</span>/<span id="unconfirmed-contact-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="unconfirmed-contact-page-size" onchange="changeUnconfirmedContactPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="unconfirmed-contact-first-btn" onclick="gotoUnconfirmedContactPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="unconfirmed-contact-prev-btn" onclick="gotoUnconfirmedContactPage(getCurrentUnconfirmedContactPage() - 1)" disabled>上一页</button>
                                    <div id="unconfirmed-contact-page-numbers"></div>
                                    <button class="pagination-btn" id="unconfirmed-contact-next-btn" onclick="gotoUnconfirmedContactPage(getCurrentUnconfirmedContactPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="unconfirmed-contact-last-btn" onclick="gotoUnconfirmedContactPage(getTotalUnconfirmedContactPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="unconfirmed-contact-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToUnconfirmedContactPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 销售订单模块 -->
                <div id="sales-module" class="module hidden">
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入订单编号">
                            <input type="text" class="filter-input" placeholder="请输入客户名称">
                            <select class="filter-input">
                                <option>请选择订单类型</option>
                                <option>销售单据</option>
                                <option>生产订单</option>
                            </select>
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                        <div class="filter-row">
                            <button class="btn btn-secondary" onclick="showProductionPlanModal()">生成生产计划</button>
                            <button class="btn btn-secondary">生成发货任务</button>
                            <button class="btn btn-secondary">催货</button>
                            <button class="btn btn-secondary">加急</button>
                            <button class="btn btn-secondary">变更</button>
                            <button class="btn btn-secondary">变更记录</button>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">销售订单列表</div>
                            <div class="table-actions">
                                <div class="view-switch-group">
                                    <button class="view-switch-btn active" onclick="switchSalesView('order')" id="order-view-btn">按单</button>
                                    <button class="view-switch-btn" onclick="switchSalesView('detail')" id="detail-view-btn">按明细</button>
                        </div>
                            </div>
                        </div>
                        <div class="table-scroll-container" id="order-table-container">
                            <table class="data-table" style="min-width: 2400px; width: 100%;">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">序号</th>
                                        <th style="width: 70px;">逾期标识</th>
                                        <th style="width: 70px;">订单类型 <span class="required">*</span></th>
                                        <th style="width: 130px;">销售订单号 <span class="required">*</span></th>
                                        <th style="width: 130px;">供货单号 <span class="required">*</span></th>
                                        <th style="width: 130px;">合同编号（买方） <span class="required">*</span></th>
                                        <th style="width: 100px;">框架合同质保金 <span class="required">*</span></th>
                                        <th style="width: 100px;">质保金收款标志 <span class="required">*</span></th>
                                        <th style="width: 60px;">币别</th>
                                        <th style="width: 60px;">汇率</th>
                                        <th style="width: 80px;">销售方式 <span class="required">*</span></th>
                                        <th style="width: 160px;">买方 <span class="required">*</span></th>
                                        <th style="width: 130px;">交货地点 <span class="required">*</span></th>
                                        <th style="width: 60px;">部门</th>
                                        <th style="width: 60px;">业务员</th>
                                        <th style="width: 80px;">技术图纸</th>
                                        <th style="width: 80px;">收货确认单</th>
                                        <th style="width: 80px;">结算日期 <span class="required">*</span></th>
                                        <th style="width: 80px;">日期 <span class="required">*</span></th>
                                        <th style="width: 160px;">操作</th>
                                    </tr>
                                </thead>
                            <tbody>
                                <tr onclick="showSalesSubTable('RE25000010')" style="cursor: pointer;" class="clickable-row">
                                    <td>1</td>
                                    <td><span class="status-badge status-pending">逾期</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showSalesOrderDetailPage('RE25000010')">RE25000010</a></td>
                                    <td>销售单据</td>
                                    <td>市场部</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>李志明</td>
                                    <td>江苏饮料项目</td>
                                    <td>饮料设备标包C</td>
                                    <td>2025-05-23</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showDrawingPreview('RE25000010')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showReceiptPreview('RE25000010')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesDetail('RE25000010')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">编辑</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">删除</a>
                                    </td>
                                </tr>

                                <tr onclick="showSalesSubTable('RE25000005')" style="cursor: pointer;" class="clickable-row">
                                    <td>2</td>
                                    <td><span class="status-badge status-pending">逾期</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showSalesOrderDetailPage('RE25000005')">RE25000005</a></td>
                                    <td>销售单据</td>
                                    <td>市场部</td>
                                    <td>豫北食品有限公司</td>
                                    <td>李志明</td>
                                    <td>食品项目</td>
                                    <td>食品加工标包D</td>
                                    <td>2025-05-31</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showDrawingPreview('RE25000005')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showReceiptPreview('RE25000005')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesDetail('RE25000005')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">编辑</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">删除</a>
                                    </td>
                                </tr>

                                <tr onclick="showSalesSubTable('RE25000003')" style="cursor: pointer;" class="clickable-row">
                                    <td>3</td>
                                    <td><span class="status-badge status-draft">正常</span></td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showSalesOrderDetailPage('RE25000003')">RE25000003</a></td>
                                    <td>销售单据</td>
                                    <td>市场部</td>
                                    <td>河南科技集团有限公司</td>
                                    <td>张明</td>
                                    <td>科技设备采购项目</td>
                                    <td>科技实验标包E</td>
                                    <td>2025-06-01</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showDrawingPreview('RE25000003')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showReceiptPreview('RE25000003')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesDetail('RE25000003')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesEdit('RE25000003')">编辑</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">删除</a>
                                    </td>
                                </tr>

                                <tr onclick="showSalesSubTable('RE25000002')" style="cursor: pointer;" class="clickable-row">
                                    <td>4</td>
                                    <td><span class="status-badge status-completed">已完成</span></td>
                                    <td>生产订单</td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showSalesOrderDetailPage('RE25000002')">RE25000002</a></td>
                                    <td>SO12400057436</td>
                                    <td>SGAHWZ00HTMM2505176</td>
                                    <td>200000.00</td>
                                    <td>已收款</td>
                                    <td>人民币</td>
                                    <td>1.0000</td>
                                    <td>直销</td>
                                    <td>安徽电力设备有限公司</td>
                                    <td>安徽省合肥市蜀山区</td>
                                    <td>技术部</td>
                                    <td>王强</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showDrawingPreview('RE25000002')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showReceiptPreview('RE25000002')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>2025-11-30</td>
                                    <td>2025-05-15</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesDetail('RE25000002')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesEdit('RE25000002')">编辑</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">删除</a>
                                    </td>
                                </tr>

                                <tr onclick="showSalesSubTable('RE25000001')" style="cursor: pointer;" class="clickable-row">
                                    <td>5</td>
                                    <td><span class="status-badge status-processing">进行中</span></td>
                                    <td>销售单据</td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showSalesOrderDetailPage('RE25000001')">RE25000001</a></td>
                                    <td>SO12400057437</td>
                                    <td>SGAHWZ00HTMM2505177</td>
                                    <td>75000.00</td>
                                    <td>部分收款</td>
                                    <td>人民币</td>
                                    <td>1.0000</td>
                                    <td>代销</td>
                                    <td>江西电力工程有限公司</td>
                                    <td>江西省南昌市东湖区</td>
                                    <td>市场部</td>
                                    <td>陈晓</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showDrawingPreview('RE25000001')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showReceiptPreview('RE25000001')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>2025-10-15</td>
                                    <td>2025-04-28</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesDetail('RE25000001')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesEdit('RE25000001')">编辑</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">删除</a>
                                    </td>
                                </tr>

                                <tr onclick="showSalesSubTable('RE24120015')" style="cursor: pointer;" class="clickable-row">
                                    <td>6</td>
                                    <td><span class="status-badge status-overdue">逾期15天</span></td>
                                    <td>销售单据</td>
                                    <td><a href="#" class="action-link" onclick="event.stopPropagation(); showSalesOrderDetailPage('RE24120015')">RE24120015</a></td>
                                    <td>SO12400057438</td>
                                    <td>SGAHWZ00HTMM2412015</td>
                                    <td>150000.00</td>
                                    <td>未收款</td>
                                    <td>人民币</td>
                                    <td>1.0000</td>
                                    <td>直销</td>
                                    <td>湖北电网建设有限公司</td>
                                    <td>湖北省武汉市江汉区</td>
                                    <td>工程部</td>
                                    <td>刘军</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showDrawingPreview('RE24120015')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-primary" onclick="event.stopPropagation(); showReceiptPreview('RE24120015')" style="padding: 4px 8px; font-size: 12px;">预览</button>
                                    </td>
                                    <td>2025-01-31</td>
                                    <td>2024-12-15</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesDetail('RE24120015')">详情</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation(); showSalesEdit('RE24120015')">编辑</a>
                                        <a href="#" class="action-link" onclick="event.stopPropagation();">删除</a>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        </div>

                        <!-- 按明细查询表格 -->
                        <div class="table-scroll-container" id="detail-table-container" style="display: none; overflow-x: auto;">
                            <table class="data-table" style="min-width: 3200px; width: 100%;">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">
                                            <input type="checkbox" id="select-all-detail" onchange="toggleSelectAllDetail()" style="cursor: pointer;">
                                        </th>
                                        <th style="width: 60px;">序号</th>
                                        <th style="width: 120px;">销售订单号</th>
                                        <th style="width: 100px;">执行状态</th>
                                        <th style="width: 100px;">逾期标识</th>
                                        <th style="width: 120px;">产品代码 <span class="required">*</span></th>
                                        <th style="width: 120px;">条形码 <span class="required">*</span></th>
                                        <th style="width: 150px;">产品名称 <span class="required">*</span></th>
                                        <th style="width: 150px;">规格型号 <span class="required">*</span></th>
                                        <th style="width: 100px;">辅助属性</th>
                                        <th style="width: 80px;">单位 <span class="required">*</span></th>
                                        <th style="width: 80px;">数量 <span class="required">*</span></th>
                                        <th style="width: 80px;">库存数量</th>
                                        <th style="width: 120px;">价格政策名称</th>
                                        <th style="width: 100px;">单价</th>
                                        <th style="width: 100px;">含税单价</th>
                                        <th style="width: 100px;">金额</th>
                                        <th style="width: 80px;">税率</th>
                                        <th style="width: 100px;">单位折扣额</th>
                                        <th style="width: 100px;">折扣额</th>
                                        <th style="width: 100px;">实际含税单价</th>
                                        <th style="width: 100px;">销项税额</th>
                                        <th style="width: 100px;">价税合计</th>
                                        <th style="width: 120px;">交货日期 <span class="required">*</span></th>
                                        <th style="width: 120px;">建议交货日期 <span class="required">*</span></th>
                                        <th style="width: 150px;">备注</th>
                                        <th style="width: 80px; position: sticky; right: 0; background: white; z-index: 10;">操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000010-001" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>1</td>
                                        <td>RE25000010</td>
                                        <td><span class="status-badge status-processing">生产中</span></td>
                                        <td><span class="status-badge status-overdue">逾期8天</span></td>
                                        <td>EMB001234</td>
                                        <td>6901234567890</td>
                                        <td>电能计量箱</td>
                                        <td>单相,1P+N+PE,60A</td>
                                        <td>悬挂式</td>
                                        <td>只</td>
                                        <td>19</td>
                                        <td>50</td>
                                        <td>标准价格政策</td>
                                        <td>84.30</td>
                                        <td>94.80</td>
                                        <td>1601.66</td>
                                        <td>13%</td>
                                        <td>0.00</td>
                                        <td>0.00</td>
                                        <td>94.80</td>
                                        <td>184.51</td>
                                        <td>1801.20</td>
                                        <td>2025-08-18</td>
                                        <td>2025-08-15</td>
                                        <td>标准产品，优先生产</td>
                                        <td style="position: sticky; right: 0; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000010-002" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>2</td>
                                        <td>RE25000010</td>
                                        <td><span class="status-badge status-pending">待生产</span></td>
                                        <td><span class="status-badge status-overdue">逾期8天</span></td>
                                        <td>SWI001235</td>
                                        <td>6901234567891</td>
                                        <td>智能控制开关</td>
                                        <td>双控开关,AC220V,2A</td>
                                        <td>智能型</td>
                                        <td>个</td>
                                        <td>50</td>
                                        <td>100</td>
                                        <td>智能设备政策</td>
                                        <td>125.50</td>
                                        <td>141.82</td>
                                        <td>6275.00</td>
                                        <td>13%</td>
                                        <td>5.00</td>
                                        <td>250.00</td>
                                        <td>136.82</td>
                                        <td>815.73</td>
                                        <td>7090.73</td>
                                        <td>2025-08-20</td>
                                        <td>2025-08-18</td>
                                        <td>智能产品，需要技术确认</td>
                                        <td style="position: sticky; right: 0; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000010" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>3</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期10天</span></td>
                                        <td><a href="#" class="action-link">RE25000010</a></td>
                                        <td>江苏食品技术有限公司</td>
                                        <td>WL-25050003/乳制品/320ml</td>
                                        <td>乳制品设备标包C</td>
                                        <td>5000瓶</td>
                                        <td>2025-06-30</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000009" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>4</td>
                                        <td><span class="status-badge status-pending">待执行</span></td>
                                        <td><span class="status-badge status-overdue">逾期49天</span></td>
                                        <td><a href="#" class="action-link">RE25000009</a></td>
                                        <td>豫北食品有限公司</td>
                                        <td>WL-25050009/白砂糖/袋</td>
                                        <td>白砂糖包装标包D</td>
                                        <td>1袋</td>
                                        <td>2025-05-22</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000008" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>5</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期40天</span></td>
                                        <td><a href="#" class="action-link">RE25000008</a></td>
                                        <td>豫北食品有限公司</td>
                                        <td>WL-25050002/功能饮料/500ml</td>
                                        <td>功能饮料标包E</td>
                                        <td>8888瓶</td>
                                        <td>2025-05-31</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000007" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>6</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期42天</span></td>
                                        <td><a href="#" class="action-link">RE25000007</a></td>
                                        <td>豫北食品有限公司</td>
                                        <td>WL-25050002/功能饮料/500ml</td>
                                        <td>功能饮料加工标包F</td>
                                        <td>999瓶</td>
                                        <td>2025-05-29</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000006" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>7</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期49天</span></td>
                                        <td><a href="#" class="action-link">RE25000006</a></td>
                                        <td>河南科技闸门有限公司</td>
                                        <td>WL-25050009/白砂糖/袋</td>
                                        <td>白砂糖输送标包G</td>
                                        <td>1袋</td>
                                        <td>2025-05-22</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000005" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>8</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期56天</span></td>
                                        <td><a href="#" class="action-link">RE25000005</a></td>
                                        <td>豫北食品有限公司</td>
                                        <td>WL-25050009/白砂糖/袋</td>
                                        <td>白砂糖存储标包H</td>
                                        <td>3袋</td>
                                        <td>2025-05-15</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000004" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>9</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期51天</span></td>
                                        <td><a href="#" class="action-link">RE25000004</a></td>
                                        <td>江苏食品技术有限公司</td>
                                        <td>WL-25050002/功能饮料/500ml</td>
                                        <td>功能饮料包装标包I</td>
                                        <td>1500瓶</td>
                                        <td>2025-05-20</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000003" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>10</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期40天</span></td>
                                        <td><a href="#" class="action-link">RE25000003</a></td>
                                        <td>江苏食品技术有限公司</td>
                                        <td>WL-25050003/乳制品/320ml</td>
                                        <td>乳制品质检标包J</td>
                                        <td>1000瓶</td>
                                        <td>2025-05-31</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td onclick="event.stopPropagation();">
                                            <input type="checkbox" class="detail-row-checkbox" value="RE25000002" onchange="updateDetailSelection()" style="cursor: pointer;">
                                        </td>
                                        <td>11</td>
                                        <td><span class="status-badge status-processing">执行中</span></td>
                                        <td><span class="status-badge status-overdue">逾期56天</span></td>
                                        <td><a href="#" class="action-link">RE25000002</a></td>
                                        <td>江苏食品技术有限公司</td>
                                        <td>WL-25050002/功能饮料/500ml</td>
                                        <td>功能饮料检测标包K</td>
                                        <td>1000瓶</td>
                                        <td>2025-05-15</td>
                                        <td style="position: sticky; right: -20px; background: white; z-index: 10;">
                                            <a href="#" class="action-link">详情</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 销售订单分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="sales-total-count">3</span> 条记录，第 <span id="sales-current-page">1</span>/<span id="sales-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="sales-page-size" onchange="changeSalesPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="sales-first-btn" onclick="gotoSalesPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="sales-prev-btn" onclick="gotoSalesPage(getCurrentSalesPage() - 1)" disabled>上一页</button>
                                    <div id="sales-page-numbers"></div>
                                    <button class="pagination-btn" id="sales-next-btn" onclick="gotoSalesPage(getCurrentSalesPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="sales-last-btn" onclick="gotoSalesPage(getTotalSalesPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="sales-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToSalesPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 子表展示区域 -->
                <div id="sub-table-section" class="module" style="display: none; margin-top: 20px;">
                    <div class="table-section">
                        <div class="table-header">
                            <div id="sub-table-title" class="table-title">明细信息</div>
                            <div class="table-actions">
                                <button class="btn btn-secondary" onclick="hideSubTable()">关闭</button>
                            </div>
                        </div>
                        <div id="sub-table-content">
                            <!-- 子表内容将在这里动态显示 -->
                        </div>
                    </div>
                </div>

                <!-- 订单查询模块 -->
                <div id="order-module" class="module hidden">
                    <!-- 顶部搜索和操作区域 -->
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" style="width: 300px;" placeholder="请输入查询内容进行模糊搜索">
                            <button class="btn btn-primary" style="background: #1890ff; color: white;">🔍 查询</button>
                            <button class="btn" style="background: #1890ff; color: white;">全部数据</button>
                            <button class="btn" style="background: #52c41a; color: white;">📊 导出EXCEL</button>
                        </div>
                        <div class="filter-row">
                            <select class="filter-input" id="province-select" onchange="onProvinceChange()">
                                <option value="">请选择省份</option>
                                <option value="安徽省">安徽省</option>
                                <option value="江苏省">江苏省</option>
                                <option value="浙江省">浙江省</option>
                                <option value="上海市">上海市</option>
                                <option value="河南省">河南省</option>
                                <option value="湖北省">湖北省</option>
                                <option value="湖南省">湖南省</option>
                                <option value="广东省">广东省</option>
                                <option value="广西">广西</option>
                                <option value="海南省">海南省</option>
                                <option value="辽宁省">辽宁省</option>
                                <option value="吉林省">吉林省</option>
                                <option value="黑龙江省">黑龙江省</option>
                                <option value="北京市">北京市</option>
                                <option value="天津市">天津市</option>
                                <option value="河北省">河北省</option>
                                <option value="山西省">山西省</option>
                                <option value="内蒙古">内蒙古</option>
                                <option value="山东省">山东省</option>
                                <option value="福建省">福建省</option>
                                <option value="江西省">江西省</option>
                                <option value="台湾省">台湾省</option>
                                <option value="香港">香港</option>
                            </select>
                            <select class="filter-input" id="city-select" onchange="onCityChange()" disabled>
                                <option value="">请先选择省份</option>
                            </select>
                            <select class="filter-input" id="district-select" onchange="onDistrictChange()" disabled>
                                <option value="">请先选择城市</option>
                            </select>
                        </div>
                    </div>

                    <!-- 主要内容区域 -->
                    <div style="height: 600px;">
                        <!-- 表格区域 -->
                        <div style="flex: 1; overflow: hidden;">
                            <div class="table-scroll-container" style="height: 100%; border: 1px solid #d9d9d9; overflow: auto;">
                                <table class="data-table" style="font-size: 12px; width: 100%; min-width: 2000px; table-layout: fixed;">
                                    <thead>
                                        <tr style="background: #fafafa;">
                                            <th style="width: 50px; text-align: center;">所有 <span style="color: white;">🔽</span></th>
                                            <th style="width: 80px;">订单类型 <span style="color: white;">🔽</span></th>
                                            <th style="width: 130px;">销售单号 <span style="color: white;">🔽</span></th>
                                            <th style="width: 100px;">分配时间 <span style="color: white;">🔽</span></th>
                                            <th style="width: 80px;">省份 <span style="color: white;">🔽</span></th>
                                            <th style="width: 260px;">买方 <span style="color: white;">🔽</span></th>
                                            <th style="width: 100px;">交货时间 <span style="color: white;">🔽</span></th>
                                            <th style="width: 160px;">技术对接人 <span style="color: white;">🔽</span></th>
                                            <th style="width: 130px;">订单编号 <span style="color: white;">🔽</span></th>
                                            <th style="width: 180px;">供货单号 <span style="color: white;">🔽</span></th>
                                            <th style="width: 200px;">协议合同 <span style="color: white;">🔽</span></th>
                                            <th style="width: 130px;">框架协议名称 <span style="color: white;">🔽</span></th>
                                            <th style="width: 260px;">项目单位 <span style="color: white;">🔽</span></th>
                                            <th style="width: 180px;">项目名称 <span style="color: white;">🔽</span></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="background-color: #fff2f0;">
                                            <td style="text-align: center;">1</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #ff4d4f; font-weight: bold; text-decoration: none;" onclick="showOrderDetail('RE25C0010'); return false;">RE25C0010</a></td>
                                            <td>2025/07/01</td>
                                            <td>河南省</td>
                                            <td>国网河南省电力公司物资分公司</td>
                                            <td>25/07/31</td>
                                            <td>中心库物资，按照标准</td>
                                            <td>4004105935</td>
                                            <td>SO174004105935</td>
                                            <td>SGHAWZ00HTMM2411798</td>
                                            <td>河南电力标包F</td>
                                            <td>国网河南省电力公司物资分公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">2</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0574'); return false;">RE25B0574</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/18</td>
                                            <td>刘祥松15720615109</td>
                                            <td>4000574336</td>
                                            <td>SO124000574336</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>安徽电力标包G</td>
                                            <td>国网安徽省电力有限公司繁昌县供电公司</td>
                                            <td>安徽芜湖繁昌县10kV芜山口#360211上上滁线工程</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">3</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0574'); return false;">RE25B0574</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/18</td>
                                            <td>刘祥松15720615109</td>
                                            <td>4000574336</td>
                                            <td>SO124000574336</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>安徽电力标包G</td>
                                            <td>国网安徽省电力有限公司繁昌县供电公司</td>
                                            <td>安徽芜湖繁昌县10kV芜山口#360211上上滁线工程</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">4</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0573'); return false;">RE25B0573</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/18</td>
                                            <td>刘祥松15720615109</td>
                                            <td>4000574338</td>
                                            <td>SO124000574338</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>电压滤波器标包H</td>
                                            <td>国网安徽省电力有限公司繁昌县供电公司</td>
                                            <td>152线平镇花园上变电压滤波器</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">5</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0573'); return false;">RE25B0573</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/18</td>
                                            <td>刘祥松15720615109</td>
                                            <td>4000574338</td>
                                            <td>SO124000574338</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>电压滤波器标包H</td>
                                            <td>国网安徽省电力有限公司繁昌县供电公司</td>
                                            <td>152线平镇花园上变电压滤波器</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">6</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0572'); return false;">RE25B0572</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/25</td>
                                            <td>秦亲13805678382</td>
                                            <td>4800260430</td>
                                            <td>SO124800260430</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包I</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">7</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0571'); return false;">RE25B0571</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/13</td>
                                            <td>朱永飞18855388532</td>
                                            <td>4800260495</td>
                                            <td>SO124800260495</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包J</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">8</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0571'); return false;">RE25B0571</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/13</td>
                                            <td>朱永飞18855388532</td>
                                            <td>4800260495</td>
                                            <td>SO124800260495</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包J</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">9</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0571'); return false;">RE25B0571</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/13</td>
                                            <td>朱永飞18855388532</td>
                                            <td>4800260495</td>
                                            <td>SO124800260495</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包J</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">10</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0571'); return false;">RE25B0571</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/13</td>
                                            <td>朱永飞18855388532</td>
                                            <td>4800260495</td>
                                            <td>SO124800260495</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包J</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">11</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0570'); return false;">RE25B0570</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/13</td>
                                            <td>朱永飞18855388532</td>
                                            <td>4800260496</td>
                                            <td>SO124800260496</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包K</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">12</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0570'); return false;">RE25B0570</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/13</td>
                                            <td>朱永飞18855388532</td>
                                            <td>4800260496</td>
                                            <td>SO124800260496</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>无为电力标包K</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center;">13</td>
                                            <td>正常</td>
                                            <td><a href="#" style="color: #1890ff; text-decoration: none;" onclick="showOrderDetail('RE25B0569'); return false;">RE25B0569</a></td>
                                            <td>2025/06/30</td>
                                            <td>安徽省</td>
                                            <td>国网安徽省电力有限公司物资分公司</td>
                                            <td>25/08/20</td>
                                            <td>16605600875场运</td>
                                            <td>4800260514</td>
                                            <td>SO124800260514</td>
                                            <td>SGHAWZ00HTMM2505173</td>
                                            <td>场运设备标包L</td>
                                            <td>国网安徽省电力有限公司无为县供电公司</td>
                                            <td>0</td>
                                        </tr>
                                        <tr style="background: #fafafa; border-top: 2px solid #d9d9d9;">
                                            <td style="text-align: center; font-weight: bold;">Σ</td>
                                            <td colspan="13"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- 订单查询分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="order-total-count">13</span> 条记录，第 <span id="order-current-page">1</span>/<span id="order-total-pages">2</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="order-page-size" onchange="changeOrderPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="order-first-btn" onclick="gotoOrderPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="order-prev-btn" onclick="gotoOrderPage(getCurrentOrderPage() - 1)" disabled>上一页</button>
                                    <div id="order-page-numbers"></div>
                                    <button class="pagination-btn" id="order-next-btn" onclick="gotoOrderPage(getCurrentOrderPage() + 1)">下一页</button>
                                    <button class="pagination-btn" id="order-last-btn" onclick="gotoOrderPage(getTotalOrderPages())">末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="order-jump-input" min="1" max="2"> 页
                                    <button onclick="jumpToOrderPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- 订单详情页面模块 -->
                <div id="order-detail-module" class="module hidden">
                    <div style="padding: 20px; background: white; min-height: calc(100vh - 120px);">
                        <!-- 顶部标题 -->
                        <div class="module-title">
                            &gt;&gt;销售订单
                        </div>
                        
                        <!-- 主要内容区域 -->
                        <div style="display: flex; gap: 20px;">
                            <!-- 左侧订单信息区域 -->
                            <div style="flex: 1;">
                                <!-- 订单基本信息 -->
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; padding: 15px; border: 1px solid #d9d9d9; background: #fafafa;">
                                    <div>
                                        <label style="font-weight: bold; color: #333;">订单日期：</label>
                                        <span id="order-detail-date">2025-06-30 16:18:09</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">销售单号：</label>
                                        <span id="order-detail-no" style="color: #1890ff;">RE25B0574</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">订单类型：</label>
                                        <span id="order-detail-type">正常</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">项目单位：</label>
                                        <span id="order-detail-unit">国网安徽省电力有限公司繁昌县供电公司</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">协议合同：</label>
                                        <span id="order-detail-contract">SGHAWZ00HTMM2505173</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">生产车间：</label>
                                        <span id="order-detail-workshop">装配</span>
                                    </div>
                                    <div style="grid-column: span 3;">
                                        <label style="font-weight: bold; color: #333;">框架协议名称：</label>
                                        <span id="order-detail-package">2025年5月中标第一次招标PC装置一国网安徽电力2025年第一次物资协议库存</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">买方：</label>
                                        <span id="order-detail-buyer">国网安徽省电力有限公司物资分公司</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">地区：</label>
                                        <span id="order-detail-region">安徽省</span>
                                    </div>
                                    <div>
                                        <label style="font-weight: bold; color: #333;">业务员：</label>
                                        <span id="order-detail-salesman">黄明明</span>
                                    </div>
                                </div>

                                <!-- 工程负责人和品质图纸上传人信息 -->
                                <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                                    <div style="flex: 1; padding: 15px; border: 1px solid #d9d9d9; background: #f9f9f9;">
                                        <div style="font-weight: bold; margin-bottom: 10px;">工程负责人：杨东 ▼</div>
                                        <div style="color: #666;">联系电话：刘泽熠对接13157206515109</div>
                                        <div style="color: #666;">供货编号：SO124000574336</div>
                                        <div style="color: #666;">供货单号：SO124000574336</div>
                                    </div>
                                    <div style="flex: 1; padding: 15px; border: 1px solid #d9d9d9; background: #f9f9f9;">
                                        <div style="font-weight: bold; margin-bottom: 10px;">品质图纸上传人 ▼</div>
                                        <div style="color: #666;">上传</div>
                                    </div>
                                </div>

                                <!-- 文档备注区域 -->
                                <div>
                                    <div style="font-weight: bold; margin-bottom: 15px;">文档备注</div>
                                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                                        <!-- 三个上传区域 -->
                                        <div style="flex: 1; text-align: center;">
                                            <div style="margin-bottom: 10px;">
                                                <button class="btn btn-primary" style="margin: 2px;">上传</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">预览</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">下载</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">删除</button>
                                            </div>
                                            <div style="border: 2px dashed #d9d9d9; height: 120px; display: flex; align-items: center; justify-content: center; background: #f9f9f9;">
                                                <div style="text-align: center;">
                                                    <div style="color: #1890ff; font-size: 24px; margin-bottom: 5px;">🗎</div>
                                                    <div style="font-size: 12px; color: #999;">SO124000574...</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="flex: 1; text-align: center;">
                                            <div style="margin-bottom: 10px;">
                                                <button class="btn btn-primary" style="margin: 2px;">上传</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">预览</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">下载</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">删除</button>
                                            </div>
                                            <div style="border: 2px dashed #d9d9d9; height: 120px; display: flex; align-items: center; justify-content: center; background: #f9f9f9;">
                                                <div style="color: #999; font-size: 14px;">点击上传文档</div>
                                            </div>
                                        </div>
                                        
                                        <div style="flex: 1; text-align: center;">
                                            <div style="margin-bottom: 10px;">
                                                <button class="btn btn-primary" style="margin: 2px;">上传</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">预览</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">下载</button>
                                                <button class="btn btn-secondary" style="margin: 2px;">删除</button>
                                            </div>
                                            <div style="border: 2px dashed #d9d9d9; height: 120px; display: flex; align-items: center; justify-content: center; background: #f9f9f9;">
                                                <div style="color: #999; font-size: 14px;">点击上传文档</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 订单备注 -->
                                <div style="margin-bottom: 20px;">
                                    <div style="font-weight: bold; margin-bottom: 10px;">订单备注</div>
                                    <div style="border: 1px solid #d9d9d9; min-height: 80px; padding: 10px; background: white;">
                                        <!-- 备注内容区域 -->
                                    </div>
                                </div>

                                <!-- 文档备注列表 -->
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div style="font-weight: bold;">文档备注</div>
                                        <button class="btn btn-primary" onclick="showUploadDocumentModal()">📎 上传文档</button>
                                    </div>
                                    <div id="document-list" style="border: 1px solid #d9d9d9; background: white; border-radius: 4px;">
                                        <div style="padding: 12px; border-bottom: 1px solid #e5e7eb; background: #f8f9fa; font-weight: bold; display: flex;">
                                            <div style="flex: 1;">文档名称</div>
                                            <div style="width: 100px;">文件大小</div>
                                            <div style="width: 120px;">上传时间</div>
                                            <div style="width: 150px; text-align: center;">操作</div>
                                        </div>
                                        <div id="document-items">
                                            <!-- 示例文档 -->
                                            <div style="padding: 12px; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center;">
                                                <div style="flex: 1; display: flex; align-items: center;">
                                                    <span style="color: white; margin-right: 8px;">📄</span>
                                                    <span>技术要求说明书.pdf</span>
                                                </div>
                                                <div style="width: 100px; color: #666;">1.2MB</div>
                                                <div style="width: 120px; color: #666;">2025-07-01 14:30</div>
                                                <div style="width: 150px; text-align: center;">
                                                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px;" onclick="previewDocument('技术要求说明书.pdf')">预览</button>
                                                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px;" onclick="downloadDocument('技术要求说明书.pdf')">下载</button>
                                                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px; color: #ff4d4f;" onclick="deleteDocument('技术要求说明书.pdf')">删除</button>
                                                </div>
                                            </div>
                                            <div style="padding: 12px; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center;">
                                                <div style="flex: 1; display: flex; align-items: center;">
                                                    <span style="color: white; margin-right: 8px;">📊</span>
                                                    <span>项目进度报告.xlsx</span>
                                                </div>
                                                <div style="width: 100px; color: #666;">890KB</div>
                                                <div style="width: 120px; color: #666;">2025-07-01 16:15</div>
                                                <div style="width: 150px; text-align: center;">
                                                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px;" onclick="previewDocument('项目进度报告.xlsx')">预览</button>
                                                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px;" onclick="downloadDocument('项目进度报告.xlsx')">下载</button>
                                                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px; color: #ff4d4f;" onclick="deleteDocument('项目进度报告.xlsx')">删除</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="no-documents" style="padding: 20px; text-align: center; color: #999; display: none;">
                                            暂无文档
                                        </div>
                                    </div>
                                </div>

                                <!-- 产品明细表格 -->
                                <div style="border: 1px solid #d9d9d9; overflow-x: auto;">
                                    <table style="width: 100%; border-collapse: collapse; font-size: 12px; background: white;">
                                        <thead>
                                            <tr style="background: #40a9ff; color: white;">
                                                <th style="padding: 8px; border: 1px solid #fff; text-align: center; width: 30px;">选择名称</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 120px;">规格</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 60px;">单位</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 60px;">数量</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 200px;">项目名称</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 100px;">含税单价</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 100px;">含税金额</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 100px;">交货时间</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 120px;">客户变更文档</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 120px;">为满足要求文档</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 80px;">技术MD</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 120px;">技术对接计划</th>
                                                <th style="padding: 8px; border: 1px solid #fff; width: 100px;">技术文档</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">
                                                    <input type="checkbox" checked>
                                                </td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;">电能计量装置,单相,1P C+ABS,60A,触点式</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">只</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">19</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;">安徽芜湖繁昌县10kV芜山口#360211主变电站工程</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: right;">84.2979</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: right;">¥1,601.66</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">25/08/18</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">84.2979</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">
                                                    <input type="checkbox">
                                                </td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;">电能计量装置,单相,2P C+ABS,60A,触点式</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">只</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">27</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;">安徽芜湖繁昌县10kV芜山口#360211主变电站工程</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: right;">343.0907</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: right;">¥9,263.45</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">25/08/18</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9; text-align: center;">343.0907</td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                                <td style="padding: 8px; border: 1px solid #d9d9d9;"></td>
                                            </tr>
                                            <tr style="background: #40a9ff; color: white;">
                                                <td style="padding: 8px; border: 1px solid #fff; text-align: center;" colspan="3">合计</td>
                                                <td style="padding: 8px; border: 1px solid #fff; text-align: center;">46</td>
                                                <td style="padding: 8px; border: 1px solid #fff;" colspan="2"></td>
                                                <td style="padding: 8px; border: 1px solid #fff; text-align: right;">...0,865.11</td>
                                                <td style="padding: 8px; border: 1px solid #fff;" colspan="6"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- 右侧流程状态区域 -->
                            <div style="width: 300px; border-left: 2px solid #e5e7eb; padding-left: 20px;">
                                <div style="font-weight: bold; margin-bottom: 15px; color: #333;">流程记录</div>
                                
                                <!-- 流程状态列表 -->
                                <div style="space-y: 10px;">
                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; margin-bottom: 10px;">
                                        <div style="background: #40a9ff; color: white; padding: 8px; font-weight: bold; border-radius: 4px 4px 0 0;">销售备注录入人</div>
                                        <div style="padding: 10px; background: white; border-radius: 0 0 4px 4px;">
                                            <div style="font-size: 12px; color: #666;">录备注录入人提交时间 2025/06/30 17:19:00</div>
                                            <div style="color: #52c41a; font-weight: bold;">杨东 &nbsp;&nbsp;&nbsp; 完成</div>
                                        </div>
                                    </div>

                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; margin-bottom: 10px;">
                                        <div style="background: #40a9ff; color: white; padding: 8px; font-weight: bold; border-radius: 4px 4px 0 0;">销售备注联系人</div>
                                        <div style="padding: 10px; background: white; border-radius: 0 0 4px 4px;">
                                            <div style="font-size: 12px; color: #666;">2025/06/30 17:19:00</div>
                                            <div style="color: #52c41a; font-weight: bold;">黄明 &nbsp;&nbsp;&nbsp; 完成</div>
                                        </div>
                                    </div>

                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; margin-bottom: 10px;">
                                        <div style="background: #40a9ff; color: white; padding: 8px; font-weight: bold; border-radius: 4px 4px 0 0;">计划录入订单</div>
                                        <div style="padding: 10px; background: white; border-radius: 0 0 4px 4px;">
                                            <div style="font-size: 12px; color: #666;">2025/06/30 16:19:58</div>
                                            <div style="color: #52c41a; font-weight: bold;">贺磊 &nbsp;&nbsp;&nbsp; 完成</div>
                                        </div>
                                    </div>

                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; margin-bottom: 10px;">
                                        <div style="background: #40a9ff; color: white; padding: 8px; font-weight: bold; border-radius: 4px 4px 0 0;">商务部上传合同</div>
                                        <div style="padding: 10px; background: white; border-radius: 0 0 4px 4px;">
                                            <div style="font-size: 12px; color: #666;">2025/06/30 16:02:29</div>
                                            <div style="color: #52c41a; font-weight: bold;">邵丹 &nbsp;&nbsp;&nbsp; 完成</div>
                                        </div>
                                    </div>

                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; margin-bottom: 10px;">
                                        <div style="background: #f0f0f0; color: #666; padding: 8px; font-weight: bold; border-radius: 4px 4px 0 0;">部门</div>
                                        <div style="padding: 10px; background: white; border-radius: 0 0 4px 4px;">
                                            <div style="font-size: 12px; color: #666;">2025/06/30 16:02:17</div>
                                            <div style="color: #999;">部门 &nbsp;&nbsp;&nbsp; 自动流转</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 客户满意度调查模块 -->
                <div id="survey-module" class="module hidden">
                    <div class="filter-section">
                        <div class="filter-row">
                            <input type="text" class="filter-input" placeholder="请输入客户名称">
                            <input type="text" class="filter-input" placeholder="请输入调查编号">
                            <button class="btn btn-primary">查询</button>
                            <button class="btn btn-secondary">重置</button>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header">
                            <div class="table-title">客户满意度调查列表</div>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="showSurveyForm()">新增调查</button>
                                <button class="btn btn-secondary" onclick="downloadSurveyTemplate()" style="margin-left: 10px; background-color: #52C41A; border-color: #52C41A; color: white;">下载模板</button>
                            </div>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>调查表编号</th>
                                    <th>关联合同编号</th>
                                    <th>订单编号</th>
                                    <th>客户名称</th>
                                    <th>框架协议名称</th>
                                    <th>存放位置</th>
                                    <th>创建时间</th>
                                    <th>附件</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>SURVEY-2025001</td>
                                    <td>CON-2025001</td>
                                    <td>XS-2505010</td>
                                    <td>国网安徽省电力有限公司</td>
                                    <td>2025年电力设备采购标包</td>
                                    <td>档案室A区-03层-电力设备专柜</td>
                                    <td>2025-06-15</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="previewAttachment('SURVEY-2025001')">预览附件</a>
                                    </td>
                                    <td>
                                        <a href="#" class="action-link" onclick="editSurvey('SURVEY-2025001')">修改</a>
                                        <a href="#" class="action-link" onclick="deleteSurvey('SURVEY-2025001')">删除</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SURVEY-2025002</td>
                                    <td>CON-2025002</td>
                                    <td>XS-2505005</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>变压器采购标包</td>
                                    <td>档案室B区-02层-变压器设备专区</td>
                                    <td>2025-06-20</td>
                                    <td>
                                        <a href="#" class="action-link" onclick="previewAttachment('SURVEY-2025002')">预览附件</a>
                                    </td>
                                    <td>
                                        <a href="#" class="action-link" onclick="editSurvey('SURVEY-2025002')">修改</a>
                                        <a href="#" class="action-link" onclick="deleteSurvey('SURVEY-2025002')">删除</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SURVEY-2025003</td>
                                    <td>CON-2025001</td>
                                    <td>RE25C0010</td>
                                    <td>国网河南省电力公司物资分公司</td>
                                    <td>配电设备采购标包</td>
                                    <td>档案室C区-01层-配电专用库房</td>
                                    <td>2025-06-25</td>
                                    <td>
                                        <span style="color: #999;">暂无附件</span>
                                    </td>
                                    <td>
                                        <a href="#" class="action-link" onclick="editSurvey('SURVEY-2025003')">修改</a>
                                        <a href="#" class="action-link" onclick="deleteSurvey('SURVEY-2025003')">删除</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- 客户满意度调查分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="survey-total-count">3</span> 条记录，第 <span id="survey-current-page">1</span>/<span id="survey-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="survey-page-size" onchange="changeSurveyPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="survey-first-btn" onclick="gotoSurveyPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="survey-prev-btn" onclick="gotoSurveyPage(getCurrentSurveyPage() - 1)" disabled>上一页</button>
                                    <div id="survey-page-numbers"></div>
                                    <button class="pagination-btn" id="survey-next-btn" onclick="gotoSurveyPage(getCurrentSurveyPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="survey-last-btn" onclick="gotoSurveyPage(getTotalSurveyPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="survey-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToSurveyPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 发货记录模块 -->
                <div id="delivery-module" class="module hidden">
                    <div class="delivery-header">
                        <div class="delivery-schemes">
                            <button class="scheme-btn active">默认方案</button>
                            <button class="scheme-btn" style="color: white;">➕ 新增方案</button>
                        </div>
                        <div class="delivery-search">
                            <select class="delivery-select">
                                <option>请选择</option>
                                <option>发货单编号</option>
                                <option>发货类别</option>
                                <option>发货部门</option>
                            </select>
                            <input type="text" class="filter-input" placeholder="请输入">
                            <button class="btn btn-primary" style="color: white;">🔍 查询</button>
                            <button class="btn btn-secondary" style="color: white;">📋 重置</button>
                            <button class="btn btn-settings" style="color: white;">⚙️</button>
                        </div>
                    </div>
                    <div class="delivery-controls">
                        <button class="btn btn-primary">按单</button>
                        <button class="btn btn-secondary">按明细</button>
                        <div class="delivery-settings">
                            <button class="btn btn-icon" style="color: white;">📊</button>
                            <button class="btn btn-icon" style="color: white;">📋</button>
                            <button class="btn btn-icon" style="color: white;">⚙️</button>
                        </div>
                    </div>
                    <div class="table-section">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>发货单编号</th>
                                    <th>发货类别</th>
                                    <th>发货部门</th>
                                    <th>单据类型</th>
                                    <th>订单编号</th>
                                    <th>物流单号</th>
                                    <th>物流名称</th>
                                    <th>承运人</th>
                                    <th>客户名称</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>FH-2505003</td>
                                    <td>普通发货</td>
                                    <td>市场一部</td>
                                    <td>客户订单</td>
                                    <td style="color: #007bff;">SFSY20250515</td>
                                    <td>宇鑫物流</td>
                                    <td>李志明</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>
                                        <a href="#" class="action-link">详情</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>FH-2505004</td>
                                    <td>普通发货</td>
                                    <td>生产部</td>
                                    <td>发货任务</td>
                                    <td style="color: #007bff;">SFSY202505</td>
                                    <td>顺丰物流</td>
                                    <td>赵华</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>
                                        <a href="#" class="action-link">详情</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>FH-2505002</td>
                                    <td>普通发货</td>
                                    <td>生产部</td>
                                    <td>发货任务</td>
                                    <td style="color: #007bff;">SFWL20250514</td>
                                    <td>顺丰物流</td>
                                    <td>王开川</td>
                                    <td>江苏食品技术有限公司</td>
                                    <td>
                                        <a href="#" class="action-link">详情</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- 发货记录分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="delivery-total-count">3</span> 条记录，第 <span id="delivery-current-page">1</span>/<span id="delivery-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="delivery-page-size" onchange="changeDeliveryPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="delivery-first-btn" onclick="gotoDeliveryPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="delivery-prev-btn" onclick="gotoDeliveryPage(getCurrentDeliveryPage() - 1)" disabled>上一页</button>
                                    <div id="delivery-page-numbers"></div>
                                    <button class="pagination-btn" id="delivery-next-btn" onclick="gotoDeliveryPage(getCurrentDeliveryPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="delivery-last-btn" onclick="gotoDeliveryPage(getTotalDeliveryPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="delivery-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToDeliveryPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="delivery-detail">
                        <div class="delivery-detail-header">
                            <h3>发货明细</h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>产品编码</th>
                                    <th>产品名称</th>
                                    <th>规格型号</th>
                                    <th>计量单位</th>
                                    <th>发货数量</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>WL-25050002</td>
                                    <td>高压开关柜</td>
                                    <td>12kV环网柜</td>
                                    <td>台</td>
                                    <td>5</td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- 发货明细分页 -->
                        <div class="pagination-container">
                            <div class="pagination-info">
                                共 <span id="delivery-detail-total-count">1</span> 条记录，第 <span id="delivery-detail-current-page">1</span>/<span id="delivery-detail-total-pages">1</span> 页
                            </div>
                            <div class="pagination-controls">
                                <div class="pagination-size-selector">
                                    每页显示：
                                    <select id="delivery-detail-page-size" onchange="changeDeliveryDetailPageSize()">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    条
                                </div>
                                <div class="pagination-nav">
                                    <button class="pagination-btn" id="delivery-detail-first-btn" onclick="gotoDeliveryDetailPage(1)" disabled>首页</button>
                                    <button class="pagination-btn" id="delivery-detail-prev-btn" onclick="gotoDeliveryDetailPage(getCurrentDeliveryDetailPage() - 1)" disabled>上一页</button>
                                    <div id="delivery-detail-page-numbers"></div>
                                    <button class="pagination-btn" id="delivery-detail-next-btn" onclick="gotoDeliveryDetailPage(getCurrentDeliveryDetailPage() + 1)" disabled>下一页</button>
                                    <button class="pagination-btn" id="delivery-detail-last-btn" onclick="gotoDeliveryDetailPage(getTotalDeliveryDetailPages())" disabled>末页</button>
                                </div>
                                <div class="pagination-jump">
                                    跳转到第 <input type="number" id="delivery-detail-jump-input" min="1" max="1"> 页
                                    <button onclick="jumpToDeliveryDetailPage()">跳转</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 合同详情模态框 -->
    <div id="contract-detail-modal" class="modal">
        <div class="modal-content" style="max-width: 98%; max-height: 64%; overflow-y: auto;">
            <div class="modal-header">
                <div class="modal-title">合同详情 - CON-2025001</div>
                <button class="close-btn" onclick="closeModal('contract-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <!-- 基本信息（精简） -->
                <div class="detail-section">
                    <div class="detail-title">基本信息</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; font-size: 14px; margin-bottom: 20px;">
                        <div>
                            <div style="color: #6c757d; margin-bottom: 5px;">合同编号：</div>
                            <div style="font-weight: 600;">SGAH-AGREEMENTSTOCK-2025001</div>
                        </div>
                        <div>
                            <div style="color: #6c757d; margin-bottom: 5px;">供货单号：</div>
                            <div style="font-weight: 600;">SGD-2025001001</div>
                        </div>
                        <div>
                            <div style="color: #6c757d; margin-bottom: 5px;">框架协议名称：</div>
                            <div style="font-weight: 600;">2025年电力设备采购标包</div>
                        </div>
                        <div>
                            <div style="color: #6c757d; margin-bottom: 5px;">买方：</div>
                            <div style="font-weight: 600;">国网安徽省电力有限公司</div>
                        </div>
                        <div>
                            <div style="color: #6c757d; margin-bottom: 5px;">卖方：</div>
                            <div style="font-weight: 600;">河南光大实业有限公司</div>
                        </div>
                        <div>
                            <div style="color: #6c757d; margin-bottom: 5px;">创建日期：</div>
                            <div style="font-weight: 600;">2025-05-23</div>
                        </div>
                </div>
                
                    <!-- 技术联系人信息 -->
                    <div style="margin-top: 25px; margin-bottom: 25px;">
                        <div style="font-weight: 600; margin-bottom: 15px; font-size: 15px; color: #333;">技术联系人信息</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; font-size: 14px;">
                            <div>
                                <div style="color: #6c757d; margin-bottom: 5px;">技术联系人：</div>
                                <div style="font-weight: 600;">郭洋克</div>
                            </div>
                            <div>
                                <div style="color: #6c757d; margin-bottom: 5px;">联系电话：</div>
                                <div style="font-weight: 600;">138-0371-5678</div>
                            </div>
                            <div>
                                <div style="color: #6c757d; margin-bottom: 5px;">邮箱：</div>
                                <div style="font-weight: 600;">guoyangke@company.com</div>
                            </div>
                            <div>
                                <div style="color: #6c757d; margin-bottom: 5px;">部门：</div>
                                <div style="font-weight: 600;">技术部</div>
                            </div>
                            <div>
                                <div style="color: #6c757d; margin-bottom: 5px;">职位：</div>
                                <div style="font-weight: 600;">技术经理</div>
                            </div>
                            <div>
                                <div style="color: #6c757d; margin-bottom: 5px;">确认状态：</div>
                                <div style="font-weight: 600; color: #1890ff;">进行中</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 文档管理模块 -->
                    <div style="margin-top: 25px;">
                        <div style="font-weight: 600; margin-bottom: 15px; font-size: 15px; color: #333;">文档管理</div>
                        <div style="display: flex; gap: 20px;">
                            <!-- 上传合同模块 -->
                            <div style="flex: 1; border: 1px solid #e8e8e8; border-radius: 8px; padding: 20px; background: #f9f9f9;">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                    <div style="font-weight: 600; font-size: 14px; color: #333;">合同文件</div>
                                    <button class="btn btn-primary" onclick="uploadContractFile()" style="padding: 6px 12px; font-size: 12px;">
                                        <i class="fas fa-upload"></i> 上传合同
                                    </button>
                                </div>
                                <div id="contract-files-list" style="min-height: 100px;">
                                    <!-- 已上传的合同文件 -->
                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; padding: 10px; margin-bottom: 8px; background: white; display: flex; align-items: center; justify-content: space-between;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-file-pdf" style="color: #ff4d4f; font-size: 16px;"></i>
                                            <div>
                                                <div style="font-weight: 600; font-size: 13px;">电力设备采购合同.pdf</div>
                                                <div style="font-size: 11px; color: #999;">上传时间：2025-05-23 10:15:29</div>
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-secondary" onclick="previewContractFile('电力设备采购合同.pdf')" style="padding: 4px 8px; font-size: 11px;">预览</button>
                                            <button class="btn btn-secondary" onclick="downloadContractFile('电力设备采购合同.pdf')" style="padding: 4px 8px; font-size: 11px;">下载</button>
                                        </div>
                                    </div>
                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; padding: 10px; background: white; display: flex; align-items: center; justify-content: space-between;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-file-word" style="color: #1890ff; font-size: 16px;"></i>
                                            <div>
                                                <div style="font-weight: 600; font-size: 13px;">合同补充协议.docx</div>
                                                <div style="font-size: 11px; color: #999;">上传时间：2025-05-24 14:20:15</div>
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-secondary" onclick="previewContractFile('合同补充协议.docx')" style="padding: 4px 8px; font-size: 11px;">预览</button>
                                            <button class="btn btn-secondary" onclick="downloadContractFile('合同补充协议.docx')" style="padding: 4px 8px; font-size: 11px;">下载</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 上传满意度调查表模块 -->
                            <div style="flex: 1; border: 1px solid #e8e8e8; border-radius: 8px; padding: 20px; background: #f9f9f9;">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                    <div style="font-weight: 600; font-size: 14px; color: #333;">满意度调查表</div>
                                    <button class="btn btn-primary" onclick="uploadSurveyFile()" style="padding: 6px 12px; font-size: 12px;">
                                        <i class="fas fa-upload"></i> 上传调查表
                                    </button>
                                </div>
                                <div id="survey-files-list" style="min-height: 100px;">
                                    <!-- 已上传的调查表文件 -->
                                    <div style="border: 1px solid #d9d9d9; border-radius: 4px; padding: 10px; margin-bottom: 8px; background: white; display: flex; align-items: center; justify-content: space-between;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <i class="fas fa-file-excel" style="color: #52c41a; font-size: 16px;"></i>
                                            <div>
                                                <div style="font-weight: 600; font-size: 13px;">客户满意度调查表_2025Q2.xlsx</div>
                                                <div style="font-size: 11px; color: #999;">上传时间：2025-06-30 16:30:00</div>
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-secondary" onclick="previewSurveyFile('客户满意度调查表_2025Q2.xlsx')" style="padding: 4px 8px; font-size: 11px;">预览</button>
                                            <button class="btn btn-secondary" onclick="downloadSurveyFile('客户满意度调查表_2025Q2.xlsx')" style="padding: 4px 8px; font-size: 11px;">下载</button>
                                        </div>
                                    </div>
                                    <div style="text-align: center; color: #999; font-size: 12px; padding: 20px;">
                                        暂无其他调查表文件
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 审批记录 -->
                <div style="margin-top: 30px;">
                    <div style="font-weight: 600; margin-bottom: 15px; font-size: 16px;">审批记录</div>
                    <div style="display: flex; gap: 15px; align-items: center; overflow-x: auto; padding: 10px 0;">
                        <!-- 商务部上传合同 -->
                        <div style="min-width: 180px; background: white; border: 1px solid #e8e8e8; border-radius: 8px; overflow: hidden; position: relative;">
                            <div style="background: #52c41a; color: white; text-align: center; padding: 10px; font-weight: 600; font-size: 13px;">
                                商务部上传合同
                            </div>
                            <div style="padding: 12px;">
                                <div style="color: #6c757d; margin-bottom: 6px; font-size: 12px;">
                                    审批时间: 2025/05/23 10:15:29
                                </div>
                                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 6px;">
                                    <span style="color: #52c41a; font-weight: 600; font-size: 13px;">邹丹</span>
                                    <span style="background: #f6ffed; color: #52c41a; padding: 2px 6px; border-radius: 10px; font-size: 10px;">已完成</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 箭头 -->
                        <div style="color: #52c41a; font-size: 20px; font-weight: bold;">→</div>
                        
                        <!-- 销售确认联系人 -->
                        <div style="min-width: 180px; background: white; border: 1px solid #e8e8e8; border-radius: 8px; overflow: hidden;">
                            <div style="background: #52c41a; color: white; text-align: center; padding: 10px; font-weight: 600; font-size: 13px;">
                                销售确认联系人
                            </div>
                            <div style="padding: 12px;">
                                <div style="color: #6c757d; margin-bottom: 6px; font-size: 12px;">
                                    审批时间: 2025/05/24 14:30:15
                                </div>
                                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 6px;">
                                    <span style="color: #52c41a; font-weight: 600; font-size: 13px;">黄明</span>
                                    <span style="background: #f6ffed; color: #52c41a; padding: 2px 6px; border-radius: 10px; font-size: 10px;">已完成</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 箭头 -->
                        <div style="color: #1890ff; font-size: 20px; font-weight: bold;">→</div>
                        
                        <!-- 技术沟通确认技术方案 -->
                        <div style="min-width: 180px; background: white; border: 1px solid #1890ff; border-radius: 8px; overflow: hidden;">
                            <div style="background: #1890ff; color: white; text-align: center; padding: 10px; font-weight: 600; font-size: 13px;">
                                技术沟通确认技术方案
                            </div>
                            <div style="padding: 12px;">
                                <div style="color: #6c757d; margin-bottom: 6px; font-size: 12px;">
                                    审批时间: 待处理
                                </div>
                                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 6px;">
                                    <span style="color: #1890ff; font-weight: 600; font-size: 13px;">郭洋克</span>
                                    <span style="background: #e6f7ff; color: #1890ff; padding: 2px 6px; border-radius: 10px; font-size: 10px;">进行中</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 箭头 -->
                        <div style="color: #d9d9d9; font-size: 20px; font-weight: bold;">→</div>
                        
                        <!-- 技术图纸受控上传 -->
                        <div style="min-width: 180px; background: white; border: 1px solid #d9d9d9; border-radius: 8px; overflow: hidden;">
                            <div style="background: #d9d9d9; color: #666; text-align: center; padding: 10px; font-weight: 600; font-size: 13px;">
                                技术图纸受控上传
                            </div>
                            <div style="padding: 12px;">
                                <div style="color: #999; margin-bottom: 6px; font-size: 12px;">
                                    审批时间: 待审批
                                </div>
                                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 6px;">
                                    <span style="color: #999; font-weight: 600; font-size: 13px;">-</span>
                                    <span style="background: #f0f0f0; color: #999; padding: 2px 6px; border-radius: 10px; font-size: 10px;">待处理</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 箭头 -->
                        <div style="color: #d9d9d9; font-size: 20px; font-weight: bold;">→</div>
                        
                        <!-- 生成销售订单 -->
                        <div style="min-width: 180px; background: white; border: 1px solid #d9d9d9; border-radius: 8px; overflow: hidden;">
                            <div style="background: #d9d9d9; color: #666; text-align: center; padding: 10px; font-weight: 600; font-size: 13px;">
                                生成销售订单
                            </div>
                            <div style="padding: 12px;">
                                <div style="color: #999; margin-bottom: 6px; font-size: 12px;">
                                    审批时间: 待审批
                                </div>
                                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 6px;">
                                    <span style="color: #999; font-weight: 600; font-size: 13px;">-</span>
                                    <span style="background: #f0f0f0; color: #999; padding: 2px 6px; border-radius: 10px; font-size: 10px;">待处理</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 业务流程进展 -->

                
                <div class="detail-section" style="margin-top: 30px;">
                    <div class="detail-title">合同明细</div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th>项目单位/收货方</th>
                                <th>项目名称</th>
                                <th>货物名称</th>
                                <th>规格型号</th>
                                <th>数量</th>
                                <th>单位</th>
                                <th>不含税单价</th>
                                <th>税率</th>
                                <th>分项价(不含税)</th>
                                <th>分项价(含税)</th>
                                <th>交货时间</th>
                                <th>交货地点及交货方式</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>国网安徽省电力有限公司</td>
                                <td>安徽省电力系统智能化改造项目</td>
                                <td>配电箱</td>
                                <td>配电箱,户外,4回路</td>
                                <td>5</td>
                                <td>个</td>
                                <td>19292.50</td>
                                <td>13%</td>
                                <td>96462.50</td>
                                <td>109026.47</td>
                                <td>2024-06-17~2025-06-16</td>
                                <td>河南省郑州市、洛阳市等，买方指定仓库地面交货</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>国网安徽省电力有限公司</td>
                                <td>安徽省电力系统智能化改造项目</td>
                                <td>配电箱</td>
                                <td>配电箱,户外,12回路</td>
                                <td>1</td>
                                <td>个</td>
                                <td>16812.39</td>
                                <td>13%</td>
                                <td>16812.39</td>
                                <td>18998.00</td>
                                <td>2024-06-17~2025-06-16</td>
                                <td>河南省郑州市、洛阳市等，买方指定仓库地面交货</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>国网安徽省电力有限公司</td>
                                <td>安徽省电力系统智能化改造项目</td>
                                <td>配电箱</td>
                                <td>配电箱,户外,6回路</td>
                                <td>1</td>
                                <td>个</td>
                                <td>6392.14</td>
                                <td>13%</td>
                                <td>6392.14</td>
                                <td>7223.12</td>
                                <td>2024-06-17~2025-06-16</td>
                                <td>河南省郑州市、洛阳市等，买方指定仓库地面交货</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 销售订单详情模态框 -->
    <div id="sales-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">销售订单详情 - RE25000010</div>
                <button class="close-btn" onclick="closeModal('sales-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                    <div class="detail-title">订单基本信息</div>
                    <table class="data-table">
                        <tr><td>订单日期</td><td>2025-06-30 16:19:09</td><td>销售单号</td><td>RE25B0574</td></tr>
                        <tr><td>订单类型</td><td>正常</td><td>订单编号</td><td>4000574336</td></tr>
                        <tr><td>项目单位</td><td>国网安徽省电力有限公司繁昌县供</td><td>供货单号</td><td>SO12400057433</td></tr>
                        <tr><td>协议合同</td><td>SGAHWZ00HTMM2505173</td><td>生产车间</td><td>表箱</td></tr>
                        <tr><td>框架协议名称</td><td>2025年5月中标—安徽PC表箱一国网安徽电力2025年第一次物资协议采购</td><td>买方</td><td>国网安徽省电力有限公司物资分公司</td></tr>
                    </table>
                </div>
                
                <div class="detail-section">
                    <div class="detail-title">订单明细</div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>货物名称</th>
                                <th>规格</th>
                                <th>单位</th>
                                <th>数量</th>
                                <th>项目名称</th>
                                <th>含税单价</th>
                                <th>含税总额</th>
                                <th>交货时间</th>
                                <th>技术ID</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>电能计量箱,单相,1P+N+PE</td>
                                <td>电能计量箱,单相,1.PC+A-C+ABS,60A,悬挂式</td>
                                <td>只</td>
                                <td>19</td>
                                <td>安徽芜湖繁昌县10kV芜山口#360211上上滁线工程</td>
                                <td>84.2979</td>
                                <td>¥1,601.66</td>
                                <td>25/08/18</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>电能计量箱,单相,2P+N+PE</td>
                                <td>电能计量箱,单相,2.PC+A-C+ABS,60A,悬挂式</td>
                                <td>只</td>
                                <td>27</td>
                                <td>安徽芜湖繁昌县10kV芜山口#360211上上滁线工程</td>
                                <td>343.0907</td>
                                <td>¥9,263.45</td>
                                <td>25/08/18</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 框架协议详情模态框 -->
    <div id="bid-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">框架协议详情 - ECP-2025001</div>
                <button class="close-btn" onclick="closeModal('bid-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                                            <div class="detail-title">框架协议信息</div>
                    <table class="data-table">
                        <tr><td>框架协议名称</td><td>2025年电力设备采购标包</td><td>序号</td><td>1</td></tr>
                        <tr><td>合同编号（买方）</td><td>CON-BUYER-001</td><td>货物名称</td><td>电力设备</td></tr>
                        <tr><td>买方</td><td>国网安徽省电力有限公司</td><td>卖方</td><td>河南光大实业有限公司</td></tr>
                        <tr><td>签订日期</td><td>2025-05-15</td><td>合同价款(含税)人民币元</td><td>¥1,580,000.00</td></tr>
                        <tr><td>合同价款(不含税)人民币元</td><td>¥1,371,681.42</td><td>签订地点</td><td>河南省郑州市</td></tr>
                        <tr><td>买方联系人</td><td>张经理</td><td>买方电话</td><td>0551-65432100</td></tr>
                        <tr><td>买方传真</td><td>0551-65432101</td><td>买方email</td><td>zhang.manager@sgcc.com.cn</td></tr>
                        <tr><td>卖方联系人</td><td>李总经理</td><td>卖方电话</td><td>0371-67890123</td></tr>
                        <tr><td>卖方传真</td><td>0371-67890124</td><td>卖方email</td><td>li.manager@guangda.com</td></tr>
                    </table>
                </div>
                
                <div class="detail-section">
                    <div class="detail-title">框架协议明细表</div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th>货物名称</th>
                                <th>货物描述</th>
                                <th>单价(含税)人民币元</th>
                                <th>单位</th>
                                <th>数量</th>
                                <th>合同价款(含税)人民币元</th>
                                <th>合同价款(不含税)人民币元</th>
                                <th>税率</th>
                                <th>交货期开始</th>
                                <th>交货期结束</th>
                                <th>交货地点</th>
                                <th>交货方式</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>高压开关柜</td>
                                <td>12kV固体绝缘环网开关设备</td>
                                <td>65,000.00</td>
                                <td>台</td>
                                <td>10</td>
                                <td>650,000.00</td>
                                <td>575,221.24</td>
                                <td>13%</td>
                                <td>2025-07-01</td>
                                <td>2025-07-30</td>
                                <td>安徽省合肥市包河区工业园区</td>
                                <td>工厂交货</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>配电变压器</td>
                                <td>S11-M-630/10配电变压器</td>
                                <td>28,500.00</td>
                                <td>台</td>
                                <td>20</td>
                                <td>570,000.00</td>
                                <td>504,424.78</td>
                                <td>13%</td>
                                <td>2025-07-15</td>
                                <td>2025-08-15</td>
                                <td>安徽省合肥市包河区工业园区</td>
                                <td>送货上门</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>低压配电柜</td>
                                <td>GCS型低压抽出式开关柜</td>
                                <td>12,800.00</td>
                                <td>面</td>
                                <td>35</td>
                                <td>448,000.00</td>
                                <td>396,460.18</td>
                                <td>13%</td>
                                <td>2025-08-01</td>
                                <td>2025-08-30</td>
                                <td>安徽省合肥市包河区工业园区</td>
                                <td>工厂交货</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="detail-section">
                    <div class="detail-title">
                        框架协议附件
                        <button type="button" class="btn btn-primary" style="float: right;" onclick="uploadBidAttachment()">上传附件</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>文件名</th>
                                <th>文件类型</th>
                                <th>文件大小</th>
                                <th>上传时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="bid-attachment-list">
                            <tr>
                                <td>标包技术文档.pdf</td>
                                <td>PDF</td>
                                <td>2.5MB</td>
                                <td>2025-06-15 10:30:00</td>
                                <td>
                                    <a href="#" class="action-link" onclick="downloadBidAttachment('标包技术文档.pdf')">下载</a>
                                    <a href="#" class="action-link" onclick="previewBidAttachment('标包技术文档.pdf')">预览</a>
                                    <a href="#" class="action-link danger" onclick="deleteBidAttachment('标包技术文档.pdf')">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td>电气图纸.dwg</td>
                                <td>CAD</td>
                                <td>5.2MB</td>
                                <td>2025-06-16 14:20:00</td>
                                <td>
                                    <a href="#" class="action-link" onclick="downloadBidAttachment('电气图纸.dwg')">下载</a>
                                    <a href="#" class="action-link" onclick="previewBidAttachment('电气图纸.dwg')">预览</a>
                                    <a href="#" class="action-link danger" onclick="deleteBidAttachment('电气图纸.dwg')">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td>合同扫描件.pdf</td>
                                <td>PDF</td>
                                <td>1.8MB</td>
                                <td>2025-06-17 09:15:00</td>
                                <td>
                                    <a href="#" class="action-link" onclick="downloadBidAttachment('合同扫描件.pdf')">下载</a>
                                    <a href="#" class="action-link" onclick="previewBidAttachment('合同扫描件.pdf')">预览</a>
                                    <a href="#" class="action-link danger" onclick="deleteBidAttachment('合同扫描件.pdf')">删除</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 标包新增/编辑表单模态框 -->
    <div id="bid-form-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="bid-form-title">新增框架协议</div>
                <button class="close-btn" onclick="closeModal('bid-form-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="bid-form">
                    <div class="detail-section">
                        <div class="detail-title">基本信息</div>
                        <div class="form-grid">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">框架协议名称 <span class="required">*</span></label>
                                <input type="text" class="filter-input" style="width: 100%;" name="bidPackageName" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">合同编号（买方） <span class="required">*</span></label>
                                <input type="text" class="filter-input" style="width: 100%;" name="buyerContractNo" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">货物名称 <span class="required">*</span></label>
                                <input type="text" class="filter-input" style="width: 100%;" name="goodsName" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">买方</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="buyer">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">卖方</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="seller">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">签订日期 <span class="required">*</span></label>
                                <input type="date" class="filter-input" style="width: 100%;" name="signDate" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">合同价款(含税)人民币元 <span class="required">*</span></label>
                                <input type="number" class="filter-input" style="width: 100%;" name="contractAmountWithTax" step="0.01" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">合同价款(不含税)人民币元 <span class="required">*</span></label>
                                <input type="number" class="filter-input" style="width: 100%;" name="contractAmountWithoutTax" step="0.01" required>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">签订地点</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="signLocation">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">买方联系人</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="buyerContact">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">买方电话</label>
                                <input type="tel" class="filter-input" style="width: 100%;" name="buyerPhone">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">买方传真</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="buyerFax">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">买方email</label>
                                <input type="email" class="filter-input" style="width: 100%;" name="buyerEmail">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">卖方联系人</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="sellerContact">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">卖方电话</label>
                                <input type="tel" class="filter-input" style="width: 100%;" name="sellerPhone">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">卖方传真</label>
                                <input type="text" class="filter-input" style="width: 100%;" name="sellerFax">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">卖方email</label>
                                <input type="email" class="filter-input" style="width: 100%;" name="sellerEmail">
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <div class="detail-title">
                            框架协议明细
                            <button type="button" class="btn btn-primary" style="float: right;" onclick="addBidDetailRow()">添加明细</button>
                        </div>
                        <div class="detail-table-container">
                            <table class="data-table" id="bid-details-table">
                                <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>货物名称</th>
                                        <th>货物描述</th>
                                        <th>单价(含税)人民币元</th>
                                        <th>单位</th>
                                        <th>数量</th>
                                        <th>合同价款(含税)人民币元</th>
                                        <th>合同价款(不含税)人民币元</th>
                                        <th>税率</th>
                                        <th>交货期开始</th>
                                        <th>交货期结束</th>
                                        <th>交货地点</th>
                                        <th>交货方式</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- 动态添加行 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('bid-form-modal')">取消</button>
                        <button type="submit" class="btn btn-primary" style="margin-left: 10px;">保存</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 合同新增/编辑表单模态框 -->
    <div id="contract-form-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="contract-form-title">新增合同</div>
                <button class="close-btn" onclick="closeModal('contract-form-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="contract-form">
                    <div class="detail-section">
                        <div class="detail-title">基本信息</div>
                        <div class="form-grid">
                            <div class="form-field">
                                <label>框架协议名称 <span class="required">*</span></label>
                                <input type="text" class="filter-input" name="bidPackageName" required>
                            </div>
                            <div class="form-field">
                                <label>买方 <span class="required">*</span></label>
                                <input type="text" class="filter-input" name="buyer" required>
                            </div>
                            <div class="form-field">
                                <label>合同编号 <span class="required">*</span></label>
                                <input type="text" class="filter-input" name="agreementContractNo" required>
                            </div>
                            <div class="form-field">
                                <label>订单类型</label>
                                <select class="filter-input" name="orderType">
                                    <option value="">请选择</option>
                                    <option value="正常">正常</option>
                                    <option value="紧急">紧急</option>
                                    <option value="特急">特急</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label>卖方 <span class="required">*</span></label>
                                <input type="text" class="filter-input" name="seller" required>
                            </div>
                            <div class="form-field">
                                <label>供货单号 <span class="required">*</span></label>
                                <input type="text" class="filter-input" name="supplyOrderNo" required>
                            </div>
                            <div class="form-field">
                                <label>分项价(不含税) <span class="required">*</span></label>
                                <input type="number" class="filter-input" name="priceExcludingTax" step="0.01" required>
                            </div>
                            <div class="form-field">
                                <label>分项价(含税) <span class="required">*</span></label>
                                <input type="number" class="filter-input" name="priceIncludingTax" step="0.01" required>
                            </div>
                            <div class="form-field">
                                <label>RE含税单价 <span class="required">*</span></label>
                                <input type="number" class="filter-input" name="reTaxInclusivePrice" step="0.01" required>
                            </div>
                            <div class="form-field">
                                <label>省份</label>
                                <select class="filter-input" name="province">
                                    <option value="">请选择省份</option>
                                    <option value="安徽省">安徽省</option>
                                    <option value="江苏省">江苏省</option>
                                    <option value="河南省">河南省</option>
                                    <option value="山东省">山东省</option>
                                    <option value="河北省">河北省</option>
                                    <option value="浙江省">浙江省</option>
                                    <option value="上海市">上海市</option>
                                    <option value="北京市">北京市</option>
                                    <option value="广东省">广东省</option>
                                    <option value="湖北省">湖北省</option>
                                    <option value="湖南省">湖南省</option>
                                    <option value="四川省">四川省</option>
                                    <option value="其他">其他</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <div class="detail-title">
                            合同行明细
                            <button type="button" class="btn btn-primary" style="float: right;" onclick="addContractDetailRow()">添加明细</button>
                        </div>
                        <div class="detail-table-container">
                            <table class="data-table" id="contract-details-table">
                                <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>项目单位/收货方 <span class="required">*</span></th>
                                        <th>项目名称 <span class="required">*</span></th>
                                        <th>货物名称 <span class="required">*</span></th>
                                        <th>规格型号 <span class="required">*</span></th>
                                        <th>数量 <span class="required">*</span></th>
                                        <th>单位 <span class="required">*</span></th>
                                        <th>不含税单价 <span class="required">*</span></th>
                                        <th>税率 <span class="required">*</span></th>
                                        <th>分项价(不含税) <span class="required">*</span></th>
                                        <th>分项价(含税) <span class="required">*</span></th>
                                        <th>交货时间 <span class="required">*</span></th>
                                        <th>交货地点及交货方式</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- 动态添加行 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('contract-form-modal')">取消</button>
                        <button type="submit" class="btn btn-primary" style="margin-left: 10px;">保存</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 合同上传模态框 -->
    <div id="contract-upload-modal" class="modal">
                    <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">上传合同文件</div>
                <button class="close-btn" onclick="closeModal('contract-upload-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-field">
                    <label>选择合同文件 <span class="required">*</span></label>
                    <input type="file" class="filter-input" accept=".pdf,.doc,.docx" multiple>
                    <small style="color: #6b7280;">支持PDF、Word文档，可多选</small>
                </div>
                <div class="form-field">
                    <label>文件描述</label>
                    <textarea class="filter-input" rows="3" placeholder="请输入文件描述"></textarea>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('contract-upload-modal')">取消</button>
                    <button type="button" class="btn btn-primary" style="margin-left: 10px;" onclick="uploadContractFile()">上传</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 销售订单详情页面（基于截图重新设计） -->
    <div id="sales-order-detail-modal" class="modal">
        <div class="modal-content" style="max-width: 98%; max-height: 64%; overflow-y: auto;">
            <!-- 顶部导航栏 -->
            <div style="background: #f8f9fa; border-bottom: 1px solid #dee2e6; padding: 15px 20px; display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button onclick="closeModal('sales-order-detail-modal')" style="background: none; border: none; font-size: 18px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                        <span>←</span> 返回
                    </button>
                    
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <span style="background: red; color: white; padding: 4px 12px; border-radius: 4px; font-size: 14px;">逾期</span>
                        <span style="font-size: 24px; font-weight: 600;">RE25000004</span>
                        <div style="width: 60px; height: 60px; background: #000; color: white; display: flex; align-items: center; justify-content: center; font-size: 12px;">二维码</div>
                        <button class="btn btn-secondary" style="background: #e9ecef; color: #6c757d;">未发货</button>
                </div>
            </div>
                

            </div>

            <div style="background: white; padding: 20px;">
                <!-- 基本信息区域 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; font-size: 14px;">
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">订单类型：</div>
                        <div style="font-weight: 600;">销售单据</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">部门：</div>
                        <div style="font-weight: 600;">生产部</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">业务员：</div>
                        <div style="font-weight: 600;">邢四通</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">预测交期：</div>
                        <div style="font-weight: 600; color: #6c757d;">暂无数据</div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; font-size: 14px;">
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">销售合同：</div>
                        <div style="font-weight: 600;">CT-2025-004</div>
                    </div>
                    <div></div>
                    <div></div>
                    <div></div>
                    </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; font-size: 14px;">
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">客户名称：</div>
                        <div style="font-weight: 600;">中汉</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">交货日期：</div>
                        <div style="font-weight: 600;">2025-05-31</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">签订日期：</div>
                        <div style="font-weight: 600;">2025-04-27</div>
                    </div>
                    <div></div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; font-size: 14px;">
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">创建人：</div>
                        <div style="font-weight: 600;">邢四通</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">创建时间：</div>
                        <div style="font-weight: 600;">2025-04-27 17:52:53</div>
                    </div>
                    <div>
                        <div style="color: #6c757d; margin-bottom: 5px;">备注信息：</div>
                        <div style="font-weight: 600;"></div>
                    </div>
                    <div></div>
                </div>

                    <!-- 标签页导航 -->
                <div style="border-bottom: 1px solid #dee2e6; margin-bottom: 20px;">
                        <div style="display: flex; gap: 0;">
                         <button class="order-detail-tab active" onclick="switchOrderDetailTab('all')" style="padding: 12px 24px; border: none; background: none; border-bottom: 2px solid #007bff; color: #007bff; font-weight: 600;">全部</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('detail')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">订单明细</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('package')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">框架协议信息</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('contract')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">合同信息</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('exception')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">异常记录</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('production')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">生产订单</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('work')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">生产工单</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('report')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">报工单</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('purchase')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">采购订单</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('quality')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">质量检验</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('warehouse')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">入库情况</button>
                         <button class="order-detail-tab" onclick="switchOrderDetailTab('delivery')" style="padding: 12px 24px; border: none; background: none; color: #6c757d;">发货明细</button>
                        </div>
                    </div>

                <!-- 订单明细内容区域 -->
                <div id="order-detail-content">
                    <!-- 订单明细表格 -->
                    <div id="detail-tab-content">
                        <div style="background: white;">
                            <div style="font-weight: 600; margin-bottom: 15px; font-size: 16px;">订单明细</div>
                            <table class="data-table" style="font-size: 12px; width: 100%;">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 8px;">序号</th>
                                        <th style="padding: 8px;">执行状态</th>
                                        <th style="padding: 8px;">通期标识</th>
                                        <th style="padding: 8px;">物料信息</th>
                                        <th style="padding: 8px;">订单量/单位</th>
                                        <th style="padding: 8px;">要货日期</th>
                                        <th style="padding: 8px;">完成时间</th>
                                        <th style="padding: 8px;">单价</th>
                                        <th style="padding: 8px;">订单金额</th>
                                        <th style="padding: 8px;">销售内勤</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                         <td style="padding: 8px;">1</td>
                                         <td style="padding: 8px;"><span style="background: #fff7e6; color: #fa8c16; padding: 2px 8px; border-radius: 4px;">进行中</span></td>
                                         <td style="padding: 8px;"><span style="background: #f6ffed; color: #52c41a; padding: 2px 8px; border-radius: 4px;">正常</span></td>
                                         <td style="padding: 8px;">WL-25040004/控制开关/标准型</td>
                                         <td style="padding: 8px;">8套</td>
                                         <td style="padding: 8px;">2025-06-01</td>
                                         <td style="padding: 8px;"></td>
                                         <td style="padding: 8px;">350</td>
                                         <td style="padding: 8px;">2800</td>
                                         <td style="padding: 8px;">邢四通</td>
                                     </tr>
                                     <tr>
                                         <td style="padding: 8px;">2</td>
                                         <td style="padding: 8px;"><span style="background: #fff7e6; color: #fa8c16; padding: 2px 8px; border-radius: 4px;">进行中</span></td>
                                         <td style="padding: 8px;"><span style="background: #fff1f0; color: #ff4d4f; padding: 2px 8px; border-radius: 4px;">逾期3天</span></td>
                                         <td style="padding: 8px;">WL-25040006/电缆连接器/防水型</td>
                                         <td style="padding: 8px;">20套</td>
                                         <td style="padding: 8px;">2025-05-28</td>
                                         <td style="padding: 8px;"></td>
                                         <td style="padding: 8px;">85</td>
                                         <td style="padding: 8px;">1700</td>
                                         <td style="padding: 8px;">邢四通</td>
                                </tr>
                            </tbody>
                        </table>
                            
                                                         <!-- 分页信息 -->
                             <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                                 <div style="font-size: 12px; color: #6c757d;">共 2 条  10条/页</div>
                                 <div style="display: flex; gap: 5px;">
                                     <button style="background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 4px;">1</button>
                                     <span style="margin: 0 10px; font-size: 12px; color: #6c757d;">前往 1 页</span>
                        </div>
                    </div>

                    <!-- 订单跟踪 -->
                             <div style="margin-top: 30px;">
                                 <div style="font-weight: 600; margin-bottom: 15px; font-size: 16px;">订单跟踪</div>
                                 <div style="border: 1px solid #e8e8e8; border-radius: 8px; padding: 30px; background: white;">
                                     <div style="display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto;">
                                         <!-- 生产订单 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 生产订单
                        </div>
                    </div>
                                         
                                         <!-- 连接线 -->
                                         <div style="flex: 1; height: 2px; background: #3b82f6; margin: 0 10px; position: relative;">
                                             <div style="position: absolute; right: -8px; top: -4px; width: 0; height: 0; border-left: 8px solid #3b82f6; border-top: 4px solid transparent; border-bottom: 4px solid transparent;"></div>
                </div>
                                         
                                         <!-- 生产工单 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 生产工单
            </div>
        </div>
                                         
                                         <!-- 连接线 -->
                                         <div style="flex: 1; height: 2px; background: #3b82f6; margin: 0 10px; position: relative;">
                                             <div style="position: absolute; right: -8px; top: -4px; width: 0; height: 0; border-left: 8px solid #3b82f6; border-top: 4px solid transparent; border-bottom: 4px solid transparent;"></div>
    </div>

                                         <!-- 作业任务 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 作业任务
                </div>
                </div>
                                         
                                         <!-- 连接线 -->
                                         <div style="flex: 1; height: 2px; background: #3b82f6; margin: 0 10px; position: relative;">
                                             <div style="position: absolute; right: -8px; top: -4px; width: 0; height: 0; border-left: 8px solid #3b82f6; border-top: 4px solid transparent; border-bottom: 4px solid transparent;"></div>
            </div>
                                         
                                         <!-- 报工 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 报工
                        </div>
                            </div>
                                         
                                         <!-- 连接线 -->
                                         <div style="flex: 1; height: 2px; background: #3b82f6; margin: 0 10px; position: relative;">
                                             <div style="position: absolute; right: -8px; top: -4px; width: 0; height: 0; border-left: 8px solid #3b82f6; border-top: 4px solid transparent; border-bottom: 4px solid transparent;"></div>
                            </div>
                                         
                                         <!-- 检验 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 检验
                        </div>
                    </div>
                    
                                         <!-- 连接线 -->
                                         <div style="flex: 1; height: 2px; background: #3b82f6; margin: 0 10px; position: relative;">
                                             <div style="position: absolute; right: -8px; top: -4px; width: 0; height: 0; border-left: 8px solid #3b82f6; border-top: 4px solid transparent; border-bottom: 4px solid transparent;"></div>
                            </div>
                                         
                                         <!-- 入库 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 入库
                            </div>
                        </div>
                                         
                                         <!-- 连接线 -->
                                         <div style="flex: 1; height: 2px; background: #3b82f6; margin: 0 10px; position: relative;">
                                             <div style="position: absolute; right: -8px; top: -4px; width: 0; height: 0; border-left: 8px solid #3b82f6; border-top: 4px solid transparent; border-bottom: 4px solid transparent;"></div>
                            </div>
                                         
                                         <!-- 发货 -->
                                         <div style="display: flex; flex-direction: column; align-items: center; position: relative;">
                                             <div style="width: 80px; height: 50px; background: #9ca3af; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; border-radius: 4px;">
                                                 发货
                            </div>
                        </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
                
                    <!-- 框架协议信息内容 -->
                    <div id="package-tab-content" style="display: none;">
                        <div style="background: white;">
                            <div style="font-weight: 600; margin-bottom: 15px; font-size: 16px;">框架协议信息</div>
                            <table class="data-table" style="font-size: 12px; width: 100%;">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 8px;">序号</th>
                                        <th style="padding: 8px;">框架协议名称</th>
                                        <th style="padding: 8px;">合同编号（买方）</th>
                                        <th style="padding: 8px;">货物名称</th>
                                        <th style="padding: 8px;">买方</th>
                                        <th style="padding: 8px;">卖方</th>
                                        <th style="padding: 8px;">签订日期</th>
                                        <th style="padding: 8px;">合同价款(含税)人民币元</th>
                                        <th style="padding: 8px;">合同价款(不含税)人民币元</th>
                                        <th style="padding: 8px;">签订地点</th>
                            </tr>
                        </thead>
                        <tbody>
                                    <tr style="border-bottom: 1px solid #e8e8e8;">
                                        <td style="padding: 8px; text-align: center;">1</td>
                                        <td style="padding: 8px;">2025年电力设备采购标包</td>
                                        <td style="padding: 8px;">CON-BUYER-001</td>
                                        <td style="padding: 8px;">电力设备</td>
                                        <td style="padding: 8px;">国网安徽省电力有限公司</td>
                                        <td style="padding: 8px;">河南光大实业有限公司</td>
                                        <td style="padding: 8px;">2025-05-15</td>
                                        <td style="padding: 8px;">￥1,580,000.00</td>
                                        <td style="padding: 8px;">￥1,371,681.42</td>
                                        <td style="padding: 8px;">河南省郑州市</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e8e8e8;">
                                        <td style="padding: 8px; text-align: center;">2</td>
                                        <td style="padding: 8px;">变压器采购标包</td>
                                        <td style="padding: 8px;">CON-BUYER-002</td>
                                        <td style="padding: 8px;">配电变压器</td>
                                        <td style="padding: 8px;">江苏食品技术有限公司</td>
                                        <td style="padding: 8px;">河南光大实业有限公司</td>
                                        <td style="padding: 8px;">2025-04-20</td>
                                        <td style="padding: 8px;">￥2,354,500.00</td>
                                        <td style="padding: 8px;">￥2,039,823.01</td>
                                        <td style="padding: 8px;">江苏省南京市</td>
                            </tr>
                        </tbody>
                    </table>
                        </div>
                    </div>

                    <!-- 合同信息内容 -->
                    <div id="contract-tab-content" style="display: none;">
                        <div style="background: white;">
                            <div style="font-weight: 600; margin-bottom: 15px; font-size: 16px;">合同信息</div>
                            <table class="data-table" style="font-size: 12px; width: 100%;">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 8px;">序号</th>
                                        <th style="padding: 8px;">供货单号</th>
                                        <th style="padding: 8px;">合同编号（买方）</th>
                                        <th style="padding: 8px;">框架协议名称</th>
                                        <th style="padding: 8px;">买方</th>
                                        <th style="padding: 8px;">订单类型</th>
                                        <th style="padding: 8px;">卖方</th>
                                        <th style="padding: 8px;">签订日期</th>
                                        <th style="padding: 8px;">分项价(不含税)</th>
                                        <th style="padding: 8px;">分项价(含税)</th>
                                        <th style="padding: 8px;">交货时间</th>
                                        <th style="padding: 8px;">项目名称</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border-bottom: 1px solid #e8e8e8;">
                                        <td style="padding: 8px; text-align: center;">1</td>
                                        <td style="padding: 8px;">SGD-2025001001</td>
                                        <td style="padding: 8px;">SGAH-AGREEMENTSTOCK-2025001</td>
                                        <td style="padding: 8px;">2025年电力设备采购标包</td>
                                        <td style="padding: 8px;">国网安徽省电力有限公司</td>
                                        <td style="padding: 8px; text-align: center;">
                                            <span style="background: #f6ffed; color: #52c41a; padding: 2px 8px; border-radius: 12px; font-size: 11px;">正常</span>
                                        </td>
                                        <td style="padding: 8px;">河南光大实业有限公司</td>
                                        <td style="padding: 8px;">2025-05-15</td>
                                        <td style="padding: 8px;">￥1,371,681.42</td>
                                        <td style="padding: 8px;">￥1,580,000.00</td>
                                        <td style="padding: 8px;">2025-07-15</td>
                                        <td style="padding: 8px;">安徽省电力系统智能化改造项目</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid #e8e8e8;">
                                        <td style="padding: 8px; text-align: center;">2</td>
                                        <td style="padding: 8px;">JSSP-AGREEMENTSTOCK-2025002</td>
                                        <td style="padding: 8px;">SGD-2025001002</td>
                                        <td style="padding: 8px;">变压器采购标包</td>
                                        <td style="padding: 8px;">江苏食品技术有限公司</td>
                                        <td style="padding: 8px; text-align: center;">
                                            <span style="background: #fff1f0; color: #ff4d4f; padding: 2px 8px; border-radius: 12px; font-size: 11px;">紧急</span>
                                        </td>
                                        <td style="padding: 8px;">河南光大实业有限公司</td>
                                        <td style="padding: 8px;">2025-05-10</td>
                                        <td style="padding: 8px;">￥2,039,823.01</td>
                                        <td style="padding: 8px;">￥2,354,500.00</td>
                                        <td style="padding: 8px;">2025-08-10</td>
                                        <td style="padding: 8px;">江苏食品技术变压器采购项目</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 技术联系人录入模态框 -->
    <div id="tech-contact-modal" class="modal">
        <div class="modal-content" style="max-width: 1280px;">
            <div class="modal-header">
                <div class="modal-title">确认技术联系人</div>
                <button class="close-btn" onclick="closeModal('tech-contact-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <!-- 粘贴识别功能区域 -->
                <div class="paste-recognition-section" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <div style="text-align: center; margin-bottom: 15px;">
                        <span style="font-size: 16px; color: #495057; font-weight: 500;">「粘贴识别」或输入文本，智能拆分姓名、电话和地址</span>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <textarea id="paste-input" class="filter-input" placeholder="请粘贴或输入联系人信息，如：张三 13812345678 技术经理" style="flex: 1; min-height: 80px; resize: vertical; border: 2px dashed #dee2e6; background: white;"></textarea>
                        <button type="button" class="btn btn-primary" onclick="recognizePasteContent()" style="background: #ff4d4f; border-color: #ff4d4f; padding: 12px 24px; border-radius: 20px; font-weight: 600; white-space: nowrap;">粘贴并识别</button>
                    </div>
                    
                    <div style="font-size: 12px; color: #6c757d; text-align: center;">
                        支持多种格式：姓名+电话、姓名+电话+职位、纯文本等，系统将自动识别并填充到下方表单
                    </div>
                </div>
                
                <form id="tech-contact-form">
                    <div class="detail-section">
                        <div class="detail-title">请录入或确认技术联系人信息</div>
                        
                        <div class="form-grid-4">
                        <div class="form-field">
                            <label>联系人名称 <span class="required">*</span></label>
                            <input type="text" class="filter-input" id="tech-contact-name-input" name="contactName" required placeholder="请输入联系人姓名">
                        </div>
                        
                        <div class="form-field">
                            <label>手机号码 <span class="required">*</span></label>
                            <input type="tel" class="filter-input" id="tech-contact-phone-input" name="contactPhone" required placeholder="请输入手机号码" pattern="^1[3-9]\d{9}$">
                        </div>
                        
                        <div class="form-field">
                            <label>职位</label>
                            <input type="text" class="filter-input" id="tech-contact-position-input" name="contactPosition" placeholder="请输入职位，如：高级工程师、技术主管等">
                        </div>
                        
                        <div class="form-field">
                            <label>邮箱</label>
                            <input type="email" class="filter-input" id="tech-contact-email-input" name="contactEmail" placeholder="请输入邮箱地址">
                        </div>
                        </div>
                        
                        <div class="form-field">
                            <label>备注说明</label>
                            <textarea class="filter-input" id="tech-contact-notes-input" name="contactNotes" placeholder="请输入相关备注信息" style="min-height: 60px; resize: vertical;"></textarea>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <div class="detail-title">
                            <i class="fas fa-tasks" style="margin-right: 8px; color: #667eea;"></i>
                            产品类型
                            <span style="font-size: 12px; color: #6c757d; font-weight: normal; margin-left: 12px;">
                                为每个产品匹配对应类型和负责人
                            </span>
                        </div>
                        <div id="tech-task-container" style="max-height: 400px; overflow-y: auto;">
                            <!-- 动态添加产品卡片 -->
                        </div>
                        

                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">确认提交</button>
                        <button type="button" class="btn btn-secondary" style="margin-left: 10px;" onclick="closeModal('tech-contact-modal')">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 客户满意度调查表单模态框 -->
    <div id="survey-form-modal" class="modal">
        <div class="modal-content" style="max-width: 960px;">
            <div class="modal-header">
                <div class="modal-title" id="survey-form-title">新增客户满意度调查</div>
                <button class="close-btn" onclick="closeModal('survey-form-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="survey-form">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>关联合同编号 <span class="required">*</span></label>
                            <select class="filter-input" name="contractNo" required>
                                <option value="">请选择合同编号</option>
                                <option value="CON-2025001">CON-2025001 - 2025年电力设备采购合同</option>
                                <option value="CON-2025002">CON-2025002 - 变压器采购协议</option>
                            </select>
                        </div>
                        

                        
                        <div class="form-field">
                            <label>存放位置 <span class="required">*</span></label>
                            <input type="text" class="filter-input" name="storageLocation" required placeholder="请输入存放位置，如：档案室A区-03层-电力设备专柜">
                        </div>
                    </div>
                    
                    <div class="form-field">
                        <label>上传附件</label>
                        <div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 20px; text-align: center; margin-top: 5px;">
                            <input type="file" id="survey-file" name="attachment" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx" multiple>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('survey-file').click()">选择文件</button>
                            <button type="button" class="btn btn-primary" onclick="downloadSurveyTemplate()" style="margin-left: 10px; background-color: #52C41A; border-color: #52C41A;">下载模板</button>
                            <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">
                                支持PDF、Word、Excel格式，最大20MB
                            </div>
                            <div id="file-list" style="margin-top: 10px; text-align: left;"></div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">保存</button>
                        <button type="button" class="btn btn-secondary" style="margin-left: 10px;" onclick="closeModal('survey-form-modal')">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 附件预览模态框 -->
    <div id="attachment-preview-modal" class="modal">
        <div class="modal-content" style="max-width: 90%; max-height: 59%; width: 1440px; height: 455px;">
            <div class="modal-header">
                <div class="modal-title" id="attachment-preview-title">PDF文件预览</div>
                <button class="close-btn" onclick="closeModal('attachment-preview-modal')">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0; height: calc(100% - 60px);">
                <div id="pdf-preview-container" style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                    <!-- PDF工具栏 -->
                    <div style="padding: 10px; border-bottom: 1px solid #e5e7eb; background: #f9fafb; display: flex; align-items: center; gap: 10px;">
                        <span style="font-weight: 600; color: #374151;" id="current-file-name">客户满意度调查表.pdf</span>
                        <div style="margin-left: auto; display: flex; gap: 10px;">
                            <button class="btn btn-secondary" onclick="downloadCurrentFile()" style="padding: 5px 10px; font-size: 12px;">下载文件</button>
                            <button class="btn btn-secondary" onclick="showAttachmentList()" style="padding: 5px 10px; font-size: 12px;">查看所有附件</button>
                        </div>
                    </div>
                    <!-- PDF预览区域 -->
                    <div style="flex: 1; background: #f3f4f6; display: flex; align-items: center; justify-content: center;">
                        <iframe id="pdf-viewer" style="width: 100%; height: 100%; border: none;" src="data:application/pdf;base64,"></iframe>
                        <!-- PDF预览占位符 -->
                        <div id="pdf-placeholder" style="text-align: center; color: #6b7280;">
                            <div style="font-size: 48px; margin-bottom: 15px; color: white;">📄</div>
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">PDF文件预览</div>
                            <div style="font-size: 14px;">正在加载文件内容...</div>
                            <div style="margin-top: 20px; padding: 20px; background: white; border-radius: 8px; border: 1px solid #e5e7eb; max-width: 400px;">
                                <div style="font-size: 14px; color: #374151; line-height: 1.5;">
                                    <strong>模拟PDF内容预览</strong><br/><br/>
                                    客户满意度调查表<br/>
                                    调查日期：2025-06-15<br/>
                                    客户名称：国网安徽省电力有限公司<br/>
                                    项目名称：电力设备采购项目<br/><br/>
                                    整体满意度：<span style="color: white;">★★★★★</span><br/>
                                    产品质量：<span style="color: white;">★★★★★</span><br/>
                                    服务态度：<span style="color: white;">★★★★★</span><br/>
                                    交付及时性：<span style="color: white;">★★★★☆</span><br/><br/>
                                    客户建议：产品质量优秀，服务专业，建议继续保持...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 附件列表（隐藏状态） -->
                <div id="attachment-list-container" style="display: none; padding: 20px;">
                    <div class="detail-section">
                        <div class="detail-title">所有附件</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>文件名</th>
                                    <th>文件类型</th>
                                    <th>文件大小</th>
                                    <th>上传时间</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="attachment-list">
                                <!-- 动态填充附件信息 -->
                            </tbody>
                        </table>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="btn btn-secondary" onclick="backToPdfPreview()">返回PDF预览</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 框架协议附件上传模态框 -->
    <div id="bid-attachment-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">上传框架协议附件</div>
                <button class="close-btn" onclick="closeModal('bid-attachment-upload-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                    <div class="detail-title">选择文件</div>
                    <div style="border: 2px dashed #d0d7de; border-radius: 6px; padding: 40px 20px; text-align: center; margin-bottom: 20px; background-color: #f6f8fa;">
                        <div style="margin-bottom: 15px;">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="1" style="margin: 0 auto;">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10,9 9,9 8,9"></polyline>
                            </svg>
                        </div>
                        <div style="color: #1f2937; font-size: 16px; margin-bottom: 8px;">拖拽文件到此处或点击选择文件</div>
                        <div style="color: #6b7280; font-size: 14px; margin-bottom: 20px;">支持 PDF、Word、Excel、图片、CAD等格式，单个文件最大50MB</div>
                        <input type="file" id="bid-attachment-file-input" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif,.dwg,.dwf" style="display: none;">
                        <button type="button" class="btn btn-primary" onclick="document.getElementById('bid-attachment-file-input').click()">选择文件</button>
                    </div>
                    
                    <div id="bid-file-list" style="display: none;">
                        <div class="detail-title">待上传文件</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>文件名</th>
                                    <th>文件大小</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="bid-upload-file-list">
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('bid-attachment-upload-modal')">取消</button>
                    <button type="button" class="btn btn-primary" id="bid-upload-btn" onclick="submitBidAttachments()" disabled>开始上传</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 销售订单上传客户满意度调查表模态框 -->
    <div id="sales-upload-survey-modal" class="modal">
        <div class="modal-content" style="max-width: 960px;">
            <div class="modal-header">
                <div class="modal-title" id="sales-upload-survey-title">上传客户满意度调查表</div>
                <button class="close-btn" onclick="closeModal('sales-upload-survey-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="sales-upload-survey-form">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>关联合同编号 <span class="required">*</span></label>
                            <select class="filter-input" name="contractNo" required>
                                <option value="">请选择合同编号</option>
                                <option value="CON-2025001">CON-2025001 - 2025年电力设备采购合同</option>
                                <option value="CON-2025002">CON-2025002 - 变压器采购协议</option>
                            </select>
                        </div>
                        

                        
                        <div class="form-field">
                            <label>存放位置 <span class="required">*</span></label>
                            <input type="text" class="filter-input" name="storageLocation" required placeholder="请输入存放位置，如：档案室A区-03层-电力设备专柜">
                        </div>
                    </div>
                    
                    <div class="form-field">
                        <label>上传附件</label>
                        <div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 20px; text-align: center; margin-top: 5px;">
                            <input type="file" id="sales-survey-file" name="attachment" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx" multiple>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('sales-survey-file').click()">选择文件</button>
                            <button type="button" class="btn btn-primary" onclick="downloadSurveyTemplate()" style="margin-left: 10px; background-color: #52C41A; border-color: #52C41A;">下载模板</button>
                            <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">
                                支持PDF、Word、Excel格式，最大20MB
                            </div>
                            <div id="sales-file-list" style="margin-top: 10px; text-align: left;"></div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">保存</button>
                        <button type="button" class="btn btn-secondary" style="margin-left: 10px;" onclick="closeModal('sales-upload-survey-modal')">取消</button>
                    </div>
                </form>
            </div>
        </div>

    <!-- 合同管理上传客户满意度调查表模态框 -->
    <div id="contract-upload-survey-modal" class="modal">
        <div class="modal-content" style="max-width: 960px;">
            <div class="modal-header">
                <div class="modal-title" id="contract-upload-survey-title">新增客户满意度调查</div>
                <button class="close-btn" onclick="closeModal('contract-upload-survey-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="contract-upload-survey-form">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>关联合同编号 <span class="required">*</span></label>
                            <select class="filter-input" name="contractNo" required>
                                <option value="">请选择合同编号</option>
                                <option value="CON-2025001">CON-2025001 - 2025年电力设备采购合同</option>
                                <option value="CON-2025002">CON-2025002 - 变压器采购协议</option>
                                <option value="CON-2025003">CON-2025003 - 配电设备采购合同</option>
                            </select>
                        </div>
                        

                        
                        <div class="form-field">
                            <label>存放位置 <span class="required">*</span></label>
                            <input type="text" class="filter-input" name="storageLocation" required placeholder="请输入存放位置，如：档案室A区-03层-电力设备专柜">
                        </div>
                    </div>
                    
                    <div class="form-field">
                        <label>上传附件</label>
                        <div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 20px; text-align: center; margin-top: 5px;">
                            <input type="file" id="contract-survey-file" name="attachment" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx" multiple>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('contract-survey-file').click()">选择文件</button>
                            <button type="button" class="btn btn-primary" onclick="downloadSurveyTemplate()" style="margin-left: 10px; background-color: #52C41A; border-color: #52C41A;">下载模板</button>
                            <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">
                                支持PDF、Word、Excel格式，最大20MB
                            </div>
                            <div id="contract-file-list" style="margin-top: 10px; text-align: left;"></div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">保存</button>
                        <button type="button" class="btn btn-secondary" style="margin-left: 10px;" onclick="closeModal('contract-upload-survey-modal')">取消</button>
                    </div>
                </form>
            </div>
            </div>
        </div>

        <!-- 技术图纸模态框 -->
        <div id="drawing-preview-modal" class="modal" style="display: none;">
            <div class="modal-content" style="width: 90%; max-width: 1920px; height: 59vh;">
                <div class="modal-header">
                    <h3 id="drawing-preview-title" class="modal-title">技术图纸</h3>
                    <span class="close" onclick="closeModal('drawing-preview-modal')">&times;</span>
                </div>
                <div class="modal-body" style="height: calc(100% - 120px); display: flex; flex-direction: column;">
                    <!-- PDF工具栏 -->
                    <div style="padding: 10px; background: #f5f5f5; border-bottom: 1px solid #ddd; display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-primary" onclick="downloadDrawing()" style="padding: 6px 12px; font-size: 14px; color: white;">
                            📥 下载图纸
                        </button>
                        <button class="btn btn-secondary" onclick="showAllDrawings()" style="padding: 6px 12px; font-size: 14px;">
                            <span style="color: white;">📂</span> 查看所有图纸
                        </button>
                        <span style="color: #666; margin-left: 20px;" id="drawing-info">图纸名称：技术设计图.pdf</span>
                    </div>
                    
                    <!-- PDF预览区域 -->
                    <div id="pdf-preview-container" style="flex: 1; background: #f9f9f9; display: flex; align-items: center; justify-content: center; border: 1px solid #ddd;">
                        <div style="text-align: center; padding: 40px;">
                            <div style="font-size: 48px; color: white; margin-bottom: 20px;">📄</div>
                            <div style="font-size: 16px; color: #666; margin-bottom: 10px;">PDF文档预览</div>
                            <div style="font-size: 14px; color: #999; line-height: 1.6;">
                                <p><strong>文档名称：</strong>江苏饮料项目技术设计图.pdf</p>
                                <p><strong>文档大小：</strong>2.5 MB</p>
                                <p><strong>创建时间：</strong>2025-05-20 14:30</p>
                                <p><strong>文档状态：</strong>已审核</p>
                            </div>
                            <div style="margin-top: 20px; padding: 20px; background: white; border: 1px dashed #ddd; border-radius: 4px;">
                                <div style="color: #666; font-size: 14px;">
                                    <p><span style="color: white;">📋</span> <strong>图纸内容概要：</strong></p>
                                    <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
                                        <li>设备布局图 (第1-3页)</li>
                                        <li>电气系统图 (第4-6页)</li>
                                        <li>管道流程图 (第7-9页)</li>
                                        <li>安装说明图 (第10-12页)</li>
                                        <li>技术参数表 (第13-15页)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('drawing-preview-modal')">关闭</button>
                </div>
            </div>
        </div>

        <!-- 文档上传模态框 -->
        <div id="upload-document-modal" class="modal">
            <div class="modal-content" style="max-width: 960px;">
                <div class="modal-header">
                    <div class="modal-title">上传文档</div>
                    <button class="close-btn" onclick="closeModal('upload-document-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="upload-document-form">
                        <div class="form-grid-2">
                            <div class="form-field">
                                <label>文档名称 <span class="required">*</span></label>
                                <input type="text" class="filter-input" name="documentName" required placeholder="请输入文档名称">
                            </div>
                            
                            <div class="form-field">
                                <label>文档描述</label>
                                <textarea class="filter-input" name="documentDescription" placeholder="请输入文档描述" style="min-height: 60px; resize: vertical;"></textarea>
                            </div>
                        </div>
                        
                        <div class="form-field">
                            <label>选择文件 <span class="required">*</span></label>
                            <div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 20px; text-align: center; margin-top: 5px;">
                                <input type="file" id="document-file" name="documentFile" style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.png" multiple>
                                <button type="button" class="btn btn-secondary" onclick="document.getElementById('document-file').click()">选择文件</button>
                                <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">
                                    支持PDF、Word、Excel、PPT、图片、文本格式，最大50MB
                                </div>
                                <div id="upload-file-list" style="margin-top: 10px; text-align: left;"></div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button type="submit" class="btn btn-primary">上传</button>
                            <button type="button" class="btn btn-secondary" style="margin-left: 10px;" onclick="closeModal('upload-document-modal')">取消</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- 所有图纸列表模态框 -->
        <div id="all-drawings-modal" class="modal" style="display: none;">
            <div class="modal-content" style="width: 80%; max-width: 1440px;">
                <div class="modal-header">
                    <h3 class="modal-title">所有图纸文件</h3>
                    <span class="close" onclick="closeModal('all-drawings-modal')">&times;</span>
                </div>
                <div class="modal-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>图纸名称</th>
                                <th>文件类型</th>
                                <th>文件大小</th>
                                <th>上传时间</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="drawings-list">
                            <tr>
                                <td>江苏饮料项目技术设计图.pdf</td>
                                <td>PDF</td>
                                <td>2.5 MB</td>
                                <td>2025-05-20 14:30</td>
                                <td><span class="status-badge status-active">已审核</span></td>
                                <td>
                                    <a href="#" class="action-link" onclick="previewSingleDrawing('drawing1.pdf')">预览</a>
                                    <a href="#" class="action-link" onclick="downloadSingleDrawing('drawing1.pdf')">下载</a>
                                </td>
                            </tr>
                            <tr>
                                <td>设备安装示意图.pdf</td>
                                <td>PDF</td>
                                <td>1.8 MB</td>
                                <td>2025-05-21 10:15</td>
                                <td><span class="status-badge status-pending">待审核</span></td>
                                <td>
                                    <a href="#" class="action-link" onclick="previewSingleDrawing('drawing2.pdf')">预览</a>
                                    <a href="#" class="action-link" onclick="downloadSingleDrawing('drawing2.pdf')">下载</a>
                                </td>
                            </tr>
                            <tr>
                                <td>电气连接图.pdf</td>
                                <td>PDF</td>
                                <td>3.2 MB</td>
                                <td>2025-05-22 16:45</td>
                                <td><span class="status-badge status-active">已审核</span></td>
                                <td>
                                    <a href="#" class="action-link" onclick="previewSingleDrawing('drawing3.pdf')">预览</a>
                                    <a href="#" class="action-link" onclick="downloadSingleDrawing('drawing3.pdf')">下载</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('all-drawings-modal')">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 生成生产计划模态框 -->
    <div id="production-plan-modal" class="modal">
        <div class="modal-content" style="width: 95%; max-width: 2240px;">
            <div class="modal-header">
                <div class="modal-title">生成生产计划</div>
                <button class="close-btn" onclick="closeModal('production-plan-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="production-plan-form">
                    <!-- 基本信息区域 -->
                    <div class="detail-section">
                        <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                            <div class="form-field">
                                <label>销售订单编码</label>
                                <input type="text" class="filter-input" value="XS-2507003" readonly style="background-color: #f5f5f5;">
                            </div>
                            <div class="form-field">
                                <label>部门</label>
                                <select class="filter-input">
                                    <option>销售部</option>
                                    <option>生产部</option>
                                    <option>技术部</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label>客户名称</label>
                                <input type="text" class="filter-input" value="科倍恩-xujianTest" readonly style="background-color: #f5f5f5;">
                            </div>
                            <div class="form-field">
                                <label>计划员 <span style="color: red;">*</span></label>
                                <input type="text" class="filter-input" value="李志明/157371112" readonly style="background-color: #f5f5f5;">
                            </div>
                        </div>
                    </div>

                    <!-- 备注信息区域 -->
                    <div class="detail-section">
                        <div class="detail-title">备注信息</div>
                        <div class="form-field">
                            <textarea class="filter-input" placeholder="请输入" style="min-height: 60px; resize: vertical;"></textarea>
                        </div>
                    </div>

                    <!-- 生产计划明细区域 -->
                    <div class="detail-section">
                        <div class="detail-title">生产计划明细</div>
                        <div style="overflow-x: auto;">
                            <table class="data-table" style="min-width: 1200px;">
                                <thead>
                                    <tr>
                                        <th style="width: 60px;">序号</th>
                                        <th style="width: 200px;">产品信息</th>
                                        <th style="width: 120px;">数量/单位</th>
                                        <th style="width: 120px;">销售要货日期</th>
                                        <th style="width: 140px;">计划需求日期 <span style="color: red;">*</span></th>
                                        <th style="width: 200px;">计划起止日期</th>
                                        <th style="width: 100px;">订单附件</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>WL-25030002/窗式机壳/win6KW</td>
                                        <td>10台</td>
                                        <td>2025-07-10</td>
                                        <td>
                                            <input type="date" class="filter-input" style="width: 100%; font-size: 12px;" placeholder="请选择">
                                        </td>
                                        <td>
                                            <div style="display: flex; gap: 5px; align-items: center;">
                                                <input type="date" class="filter-input" style="width: 90px; font-size: 12px;" placeholder="计划开始日期">
                                                <span style="font-size: 12px;">至</span>
                                                <input type="date" class="filter-input" style="width: 90px; font-size: 12px;" placeholder="计划结束日期">
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;">选择文件</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>WL-24010062/电控柜壳体/420*570*360</td>
                                        <td>20台</td>
                                        <td>2025-07-15</td>
                                        <td>
                                            <input type="date" class="filter-input" style="width: 100%; font-size: 12px;" placeholder="请选择">
                                        </td>
                                        <td>
                                            <div style="display: flex; gap: 5px; align-items: center;">
                                                <input type="date" class="filter-input" style="width: 90px; font-size: 12px;" placeholder="计划开始日期">
                                                <span style="font-size: 12px;">至</span>
                                                <input type="date" class="filter-input" style="width: 90px; font-size: 12px;" placeholder="计划结束日期">
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;">选择文件</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>WL-24010061/转换开关/LW5D-16D0414/2</td>
                                        <td>10个</td>
                                        <td>2025-07-16</td>
                                        <td>
                                            <input type="date" class="filter-input" style="width: 100%; font-size: 12px;" placeholder="请选择">
                                        </td>
                                        <td>
                                            <div style="display: flex; gap: 5px; align-items: center;">
                                                <input type="date" class="filter-input" style="width: 90px; font-size: 12px;" placeholder="计划开始日期">
                                                <span style="font-size: 12px;">至</span>
                                                <input type="date" class="filter-input" style="width: 90px; font-size: 12px;" placeholder="计划结束日期">
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;">选择文件</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 底部按钮 -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('production-plan-modal')">取消</button>
                        <button type="button" class="btn btn-primary" style="margin-left: 10px;" onclick="confirmProductionPlan()">确定</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 悬浮操作面板 -->
    <div id="floating-action-panel" class="floating-action-panel">
        <div class="floating-panel-header">
            <div class="floating-panel-title">快速操作</div>
            <button class="floating-panel-close" onclick="hideFloatingPanel()">×</button>
        </div>
        
        <div id="floating-actions-content">
            <!-- 动态内容将在这里显示 -->
        </div>
    </div>



    <script>
        // 业务流程详情显示/隐藏控制
        function toggleProcessDetails(processId) {
            const detailsElement = document.getElementById(processId + '-details');
            if (detailsElement) {
                if (detailsElement.style.display === 'none') {
                    detailsElement.style.display = 'block';
                } else {
                    detailsElement.style.display = 'none';
                }
            }
        }

        // 合同流程详情显示/隐藏控制
        function toggleContractProcessDetails(processId) {
            const detailsElement = document.getElementById('contract-' + processId + '-details');
            if (detailsElement) {
                if (detailsElement.style.display === 'none') {
                    detailsElement.style.display = 'block';
                } else {
                    detailsElement.style.display = 'none';
                }
            }
        }

        // 子菜单展开/收起控制
        function toggleSubmenu(event) {
                event.preventDefault();
            const navLink = event.currentTarget;
            const submenu = navLink.nextElementSibling;
            const toggle = navLink.querySelector('.nav-toggle');
            
            // 切换子菜单的展开状态
            submenu.classList.toggle('expanded');
            
            // 如果子菜单展开，则旋转箭头
            if (submenu.classList.contains('expanded')) {
                toggle.style.transform = 'rotate(90deg)';
            } else {
                toggle.style.transform = 'rotate(0deg)';
            }
            
            return false;
        }

        function showModule(moduleId, event) {
        // 新增：每次切换模块都先隐藏明细面板
        if (typeof hideSubTable === 'function') {
            hideSubTable();
        }
            if (event) {
                event.preventDefault();
                // 移除所有导航链接的active类
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                // 给当前点击的链接添加active类
                event.target.classList.add('active');
            }
            
            // 隐藏所有模块
            document.querySelectorAll('.module').forEach(module => {
                module.classList.add('hidden');
            });
            
            // 显示选中的模块
            const targetModule = document.getElementById(moduleId + '-module');
            if (targetModule) {
                targetModule.classList.remove('hidden');
            }
            
            // 更新面包屑
            const moduleNames = {
                'bid': '框架协议管理',
                'contract': '合同管理', 
                'unconfirmed-contact': '未确认联系人',
                'sales': '销售订单',
                'order': '订单查询',
                'survey': '客户满意度调查',
                'delivery': '发货记录',
                'aftersale-apply': '售后申请',
                'aftersale-order': '售后单管理',
                'aftersale-dispatch': '售后派工管理',
                'aftersale-delivery': '售后发货记录',
                'receipt-record': '收货记录',
                'aftersale-report': '售后报告'
            };
            
            document.getElementById('current-module').textContent = moduleNames[moduleId] || moduleId;
            
            // 更新菜单状态
            document.querySelectorAll('.nav-submenu').forEach(submenu => {
                const link = submenu.querySelector(`[onclick*="${moduleId}"]`);
                if (link) {
                    // 展开包含当前模块的子菜单
                    submenu.classList.add('expanded');
                    const toggle = submenu.previousElementSibling.querySelector('.nav-toggle');
                    if (toggle) {
                        toggle.style.transform = 'rotate(90deg)';
                    }
                }
            });
            
            return false;
        }

        // 强制保护侧边栏函数
        function protectSidebar() {
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                sidebar.style.width = '200px';
                sidebar.style.display = 'block';
                sidebar.style.visibility = 'visible';
                sidebar.style.opacity = '1';
                sidebar.style.transform = 'none';
                sidebar.style.left = '0';
                sidebar.style.position = 'relative';
                sidebar.style.zIndex = '1000';
            }
            
            const container = document.querySelector('.container');
            if (container) {
                container.style.display = 'flex';
            }
            
            const mainContent = document.querySelector('.main-content');
            if (mainContent) {
                mainContent.style.marginLeft = '0';
                mainContent.style.width = 'calc(100% - 200px)';
            }
        }

        // 页面加载完成后保护侧边栏
        document.addEventListener('DOMContentLoaded', function() {
            protectSidebar();
            // 定期检查并保护侧边栏
            setInterval(protectSidebar, 100);
            
                    // 默认显示框架协议管理模块
        showModule('bid');

        // 悬浮操作面板相关函数
        function showFloatingPanel() {
            const panel = document.getElementById('floating-action-panel');
            
            panel.classList.add('show');
            
            // 根据当前模块更新面板内容
            updateFloatingPanelContent();
        }

        function hideFloatingPanel() {
            const panel = document.getElementById('floating-action-panel');
            
            panel.classList.remove('show');
        }

        function updateFloatingPanelContent() {
            const content = document.getElementById('floating-actions-content');
            const currentModule = getCurrentModule();
            
            if (currentModule === 'bid') {
                content.innerHTML = getBidFloatingActions();
            } else if (currentModule === 'contract') {
                content.innerHTML = getContractFloatingActions();
            } else if (currentModule === 'unconfirmed-contact') {
                content.innerHTML = getUnconfirmedContactFloatingActions();
            } else {
                content.innerHTML = getDefaultFloatingActions();
            }
        }

        function getBidFloatingActions() {
            return `
                <div class="floating-action-group">
                    <div class="floating-action-group-title">数据操作</div>
                    <a href="#" class="floating-action-item primary" onclick="showBidForm()">
                        <i class="fas fa-plus"></i>
                        新增框架协议
                    </a>
                    <a href="#" class="floating-action-item" onclick="exportBidData()">
                        <i class="fas fa-download"></i>
                        导出数据
                    </a>
                    <a href="#" class="floating-action-item" onclick="importBidData()">
                        <i class="fas fa-upload"></i>
                        导入数据
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">批量操作</div>
                    <a href="#" class="floating-action-item" onclick="batchEditBid()">
                        <i class="fas fa-edit"></i>
                        批量编辑
                    </a>
                    <a href="#" class="floating-action-item danger" onclick="batchDeleteBid()">
                        <i class="fas fa-trash"></i>
                        批量删除
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">报表分析</div>
                    <a href="#" class="floating-action-item" onclick="showBidReport()">
                        <i class="fas fa-chart-bar"></i>
                        数据报表
                    </a>
                    <a href="#" class="floating-action-item" onclick="showBidStatistics()">
                        <i class="fas fa-chart-pie"></i>
                        统计分析
                    </a>
                </div>
            `;
        }

        function getContractFloatingActions() {
            return `
                <div class="floating-action-group">
                    <div class="floating-action-group-title">合同操作</div>
                    <a href="#" class="floating-action-item primary" onclick="showContractForm()">
                        <i class="fas fa-plus"></i>
                        新增合同
                    </a>
                    <a href="#" class="floating-action-item success" onclick="batchUploadContract()">
                        <i class="fas fa-file-upload"></i>
                        批量上传合同
                    </a>
                    <a href="#" class="floating-action-item" onclick="exportContractData()">
                        <i class="fas fa-download"></i>
                        导出数据
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">技术管理</div>
                    <a href="#" class="floating-action-item" onclick="batchConfirmTechContact()">
                        <i class="fas fa-user-cog"></i>
                        批量确认技术联系人
                    </a>
                    <a href="#" class="floating-action-item" onclick="showTechContactReport()">
                        <i class="fas fa-users"></i>
                        技术联系人报表
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">批量操作</div>
                    <a href="#" class="floating-action-item" onclick="batchEditContract()">
                        <i class="fas fa-edit"></i>
                        批量编辑
                    </a>
                    <a href="#" class="floating-action-item danger" onclick="batchDeleteContract()">
                        <i class="fas fa-trash"></i>
                        批量删除
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">审核流程</div>
                    <a href="#" class="floating-action-item" onclick="showContractAuditFlow()">
                        <i class="fas fa-check-circle"></i>
                        审核流程
                    </a>
                    <a href="#" class="floating-action-item" onclick="showContractStatus()">
                        <i class="fas fa-info-circle"></i>
                        合同状态
                    </a>
                </div>
            `;
        }

        function getUnconfirmedContactFloatingActions() {
            return `
                <div class="floating-action-group">
                    <div class="floating-action-group-title">技术联系人操作</div>
                    <a href="#" class="floating-action-item primary" onclick="showTechContactForm()">
                        <i class="fas fa-user-plus"></i>
                        确认技术联系人
                    </a>
                    <a href="#" class="floating-action-item success" onclick="batchConfirmTechContact()">
                        <i class="fas fa-users-cog"></i>
                        批量确认技术联系人
                    </a>
                    <a href="#" class="floating-action-item" onclick="exportUnconfirmedContactData()">
                        <i class="fas fa-download"></i>
                        导出数据
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">技术管理</div>
                    <a href="#" class="floating-action-item" onclick="showTechContactReport()">
                        <i class="fas fa-users"></i>
                        技术联系人报表
                    </a>
                    <a href="#" class="floating-action-item" onclick="showTechContactStatistics()">
                        <i class="fas fa-chart-pie"></i>
                        技术联系人统计
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">批量操作</div>
                    <a href="#" class="floating-action-item" onclick="batchEditUnconfirmedContact()">
                        <i class="fas fa-edit"></i>
                        批量编辑
                    </a>
                    <a href="#" class="floating-action-item danger" onclick="batchDeleteUnconfirmedContact()">
                        <i class="fas fa-trash"></i>
                        批量删除
                    </a>
                </div>
                
                <div class="floating-action-group">
                    <div class="floating-action-group-title">流程管理</div>
                    <a href="#" class="floating-action-item" onclick="showTechContactProcess()">
                        <i class="fas fa-project-diagram"></i>
                        技术确认流程
                    </a>
                    <a href="#" class="floating-action-item" onclick="showTechContactStatus()">
                        <i class="fas fa-info-circle"></i>
                        确认状态
                    </a>
                </div>
            `;
        }

        function getDefaultFloatingActions() {
            return `
                <div class="floating-action-group">
                    <div class="floating-action-group-title">通用操作</div>
                    <a href="#" class="floating-action-item" onclick="refreshCurrentModule()">
                        <i class="fas fa-sync"></i>
                        刷新数据
                    </a>
                    <a href="#" class="floating-action-item" onclick="showHelp()">
                        <i class="fas fa-question-circle"></i>
                        帮助文档
                    </a>
                </div>
            `;
        }

        function getCurrentModule() {
            const activeLink = document.querySelector('.nav-link.active');
            if (activeLink) {
                const href = activeLink.getAttribute('onclick');
                if (href.includes("'bid'")) return 'bid';
                if (href.includes("'contract'")) return 'contract';
                if (href.includes("'unconfirmed-contact'")) return 'unconfirmed-contact';
                if (href.includes("'sales'")) return 'sales';
                if (href.includes("'order'")) return 'order';
                if (href.includes("'survey'")) return 'survey';
            }
            return 'default';
        }


            
            // 技术联系人表单提交处理
            const techContactForm = document.getElementById('tech-contact-form');
            if (techContactForm) {
                techContactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const formData = new FormData(this);
                    const contactData = {};
                    
                    // 处理基本联系人信息
                    for (let [key, value] of formData.entries()) {
                        if (!key.startsWith('techTasks[')) {
                        contactData[key] = value;
                        }
                    }
                    
                    // 验证手机号格式
                    const phonePattern = /^1[3-9]\d{9}$/;
                    if (!phonePattern.test(contactData.contactPhone)) {
                        alert('请输入正确的手机号码格式！');
                        return;
                    }
                    
                    // 处理产品类型信息
                    contactData.techTasks = [];
                    const taskRows = document.querySelectorAll('#tech-task-table tbody tr');
                    
                    let hasValidTask = false;
                    taskRows.forEach(row => {
                        const inputs = row.querySelectorAll('input, select');
                        const task = {};
                        let isValidTask = true;
                        
                        inputs.forEach(input => {
                            const match = input.name.match(/techTasks\[\d+\]\[(.+)\]/);
                            if (match) {
                                const fieldName = match[1];
                                task[fieldName] = input.value;
                                
                                // 检查必填字段
                                if ((fieldName === 'productCategory' || fieldName === 'techDepartment' || fieldName === 'techLeader') && !input.value.trim()) {
                                    isValidTask = false;
                                }
                            }
                        });
                        
                        if (isValidTask && task.productCategory) {
                            contactData.techTasks.push(task);
                            hasValidTask = true;
                        }
                    });
                    
                    if (!hasValidTask) {
                        alert('请至少添加一个完整的产品类型信息！');
                        return;
                    }
                    
                    console.log('技术联系人信息：', contactData);
                    console.log('关联订单编码：', window.currentOrderCode);
                    
                    // 生成任务分配汇总信息
                    let taskSummary = contactData.techTasks.map((task, index) => 
                        `${index + 1}. ${task.productCategory} → ${task.techDepartment} → ${task.techLeader}`
                    ).join('\n');
                    
                    alert(`技术联系人及任务分配确认成功！\n\n` +
                          `联系人：${contactData.contactName}\n` +
                          `手机号：${contactData.contactPhone}\n` +
                          `职位：${contactData.contactPosition || '未填写'}\n` +
                          `邮箱：${contactData.contactEmail || '未填写'}\n\n` +
                          `产品类型：\n${taskSummary}`);
                    
                    closeModal('tech-contact-modal');
                });
            }
        });

        // 三级联动地区数据
        const regionData = {
            '安徽省': {
                '合肥市': ['包河区', '庐阳区', '蜀山区', '瑶海区', '庐江县', '肥东县', '肥西县'],
                '芜湖市': ['镜湖区', '弋江区', '鸠江区', '三山区', '芜湖县', '繁昌县', '南陵县'],
                '蚌埠市': ['龙子湖区', '蚌山区', '禹会区', '淮上区', '怀远县', '五河县', '固镇县'],
                '淮南市': ['大通区', '田家庵区', '谢家集区', '八公山区', '潘集区', '凤台县', '寿县']
            },
            '江苏省': {
                '南京市': ['玄武区', '秦淮区', '建邺区', '鼓楼区', '浦口区', '栖霞区', '雨花台区'],
                '苏州市': ['虎丘区', '吴中区', '相城区', '姑苏区', '吴江区', '常熟市', '张家港市'],
                '无锡市': ['锡山区', '惠山区', '滨湖区', '梁溪区', '新吴区', '江阴市', '宜兴市'],
                '南通市': ['崇川区', '港闸区', '通州区', '海安市', '如皋市', '启东市', '如东县']
            },
            '河南省': {
                '郑州市': ['中原区', '二七区', '管城区', '金水区', '上街区', '惠济区', '中牟县'],
                '洛阳市': ['西工区', '老城区', '涧西区', '瀍河区', '洛龙区', '吉利区', '偃师市'],
                '开封市': ['龙亭区', '顺河区', '鼓楼区', '禹王台区', '祥符区', '杞县', '通许县'],
                '新乡市': ['红旗区', '卫滨区', '凤泉区', '牧野区', '新乡县', '获嘉县', '原阳县']
            },
            '浙江省': {
                '杭州市': ['上城区', '拱墅区', '西湖区', '滨江区', '萧山区', '余杭区', '临平区'],
                '宁波市': ['海曙区', '江北区', '北仑区', '镇海区', '鄞州区', '奉化区', '余姚市'],
                '温州市': ['鹿城区', '龙湾区', '瓯海区', '洞头区', '永嘉县', '平阳县', '苍南县'],
                '嘉兴市': ['南湖区', '秀洲区', '嘉善县', '海盐县', '海宁市', '平湖市', '桐乡市']
            },
            '上海市': {
                '市辖区': ['黄浦区', '徐汇区', '长宁区', '静安区', '普陀区', '虹口区', '杨浦区', '闵行区', '宝山区', '嘉定区', '浦东新区', '金山区', '松江区', '青浦区', '奉贤区', '崇明区']
            },
            '广东省': {
                '广州市': ['荔湾区', '越秀区', '海珠区', '天河区', '白云区', '黄埔区', '番禺区'],
                '深圳市': ['罗湖区', '福田区', '南山区', '宝安区', '龙岗区', '盐田区', '龙华区'],
                '珠海市': ['香洲区', '斗门区', '金湾区'],
                '佛山市': ['禅城区', '南海区', '顺德区', '三水区', '高明区']
            }
        };

        // 省份选择变化事件
        function onProvinceChange() {
            const provinceSelect = document.getElementById('province-select');
            const citySelect = document.getElementById('city-select');
            const districtSelect = document.getElementById('district-select');
            
            const selectedProvince = provinceSelect.value;
            
            // 清空城市和区县选择器
            citySelect.innerHTML = '<option value="">请选择城市</option>';
            districtSelect.innerHTML = '<option value="">请先选择城市</option>';
            districtSelect.disabled = true;
            
            if (selectedProvince && regionData[selectedProvince]) {
                // 启用城市选择器并填充城市选项
                citySelect.disabled = false;
                
                Object.keys(regionData[selectedProvince]).forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            } else {
                citySelect.disabled = true;
                citySelect.innerHTML = '<option value="">请先选择省份</option>';
            }
            
            // 执行筛选
            filterOrdersByRegion();
        }

        // 城市选择变化事件
        function onCityChange() {
            const provinceSelect = document.getElementById('province-select');
            const citySelect = document.getElementById('city-select');
            const districtSelect = document.getElementById('district-select');
            
            const selectedProvince = provinceSelect.value;
            const selectedCity = citySelect.value;
            
            // 清空区县选择器
            districtSelect.innerHTML = '<option value="">请选择区县</option>';
            
            if (selectedProvince && selectedCity && regionData[selectedProvince][selectedCity]) {
                // 启用区县选择器并填充区县选项
                districtSelect.disabled = false;
                
                regionData[selectedProvince][selectedCity].forEach(district => {
                    const option = document.createElement('option');
                    option.value = district;
                    option.textContent = district;
                    districtSelect.appendChild(option);
                });
            } else {
                districtSelect.disabled = true;
                districtSelect.innerHTML = '<option value="">请先选择城市</option>';
            }
            
            // 执行筛选
            filterOrdersByRegion();
        }

        // 区县选择变化事件
        function onDistrictChange() {
            // 执行筛选
            filterOrdersByRegion();
        }

        // 根据地区筛选订单数据
        function filterOrdersByRegion() {
            const provinceSelect = document.getElementById('province-select');
            const citySelect = document.getElementById('city-select');
            const districtSelect = document.getElementById('district-select');
            
            const selectedProvince = provinceSelect.value;
            const selectedCity = citySelect.value;
            const selectedDistrict = districtSelect.value;
            
            console.log('筛选条件:', {
                province: selectedProvince,
                city: selectedCity,
                district: selectedDistrict
            });
            
            // 这里可以实现实际的表格筛选逻辑
            // 根据选择的省市区筛选订单数据
            const allRows = document.querySelectorAll('#order-module .data-table tbody tr');
            allRows.forEach(row => {
                const regionCell = row.cells[4]; // 地区列
                if (regionCell) {
                    let showRow = true;
                    
                    if (selectedProvince) {
                        // 如果选择了省份，检查该行是否包含该省份
                        showRow = regionCell.textContent.includes(selectedProvince);
                    }
                    
                    // 可以根据需要添加更精确的城市和区县筛选逻辑
                    
                    row.style.display = showRow ? '' : 'none';
                }
            });
        }

        // 显示订单详情页面
        function showOrderDetail(orderNo) {
            // 隐藏所有模块
            const modules = document.querySelectorAll('.module');
            modules.forEach(module => {
                module.classList.add('hidden');
            });

            // 显示订单详情模块
            const orderDetailModule = document.getElementById('order-detail-module');
            orderDetailModule.classList.remove('hidden');

            // 更新页面标题和活动菜单
            document.title = '订单详情 - 营销管理系统';
            
            // 更新菜单活动状态
            const menuItems = document.querySelectorAll('.nav-menu a');
            menuItems.forEach(item => {
                item.classList.remove('active');
            });

            // 根据订单号更新页面信息
            updateOrderDetailInfo(orderNo);
            
            // 更新面包屑
            document.getElementById('current-module').textContent = '订单详情';
        }

        // 更新订单详情信息
        function updateOrderDetailInfo(orderNo) {
            // 模拟订单数据
            const orderData = {
                'RE25C0010': {
                    date: '2025-07-01 09:15:30',
                    no: 'RE25C0010',
                    type: '正常',
                    unit: '河南省豫北电力设备有限公司',
                    contract: 'SGHNBZ00HTMM2505180',
                    workshop: '装配',
                    package: '2025年7月中标第一次招标PC装置一河南豫北电力2025年第一次物资协议库存',
                    buyer: '河南省豫北电力设备有限公司',
                    region: '河南省',
                    salesman: '张伟'
                },
                'RE25B0574': {
                    date: '2025-06-30 16:18:09',
                    no: 'RE25B0574',
                    type: '正常',
                    unit: '国网安徽省电力有限公司繁昌县供电公司',
                    contract: 'SGHAWZ00HTMM2505173',
                    workshop: '装配',
                    package: '2025年5月中标第一次招标PC装置一国网安徽电力2025年第一次物资协议库存',
                    buyer: '国网安徽省电力有限公司物资分公司',
                    region: '安徽省',
                    salesman: '黄明明'
                },
                'RE25B0573': {
                    date: '2025-06-30 15:42:15',
                    no: 'RE25B0573',
                    type: '正常',
                    unit: '国网安徽省电力有限公司繁昌县供电公司',
                    contract: 'SGHAWZ00HTMM2505172',
                    workshop: '装配',
                    package: '2025年5月中标第二次招标PC装置一国网安徽电力2025年第二次物资协议库存',
                    buyer: '国网安徽省电力有限公司物资分公司',
                    region: '安徽省',
                    salesman: '黄明明'
                },
                'RE25B0572': {
                    date: '2025-06-30 14:30:22',
                    no: 'RE25B0572',
                    type: '正常',
                    unit: '国网安徽省电力有限公司繁昌县供电公司',
                    contract: 'SGHAWZ00HTMM2505171',
                    workshop: '装配',
                    package: '2025年5月中标第三次招标PC装置一国网安徽电力2025年第三次物资协议库存',
                    buyer: '国网安徽省电力有限公司物资分公司',
                    region: '安徽省',
                    salesman: '黄明明'
                },
                'RE25B0571': {
                    date: '2025-06-30 13:25:18',
                    no: 'RE25B0571',
                    type: '正常',
                    unit: '国网安徽省电力有限公司繁昌县供电公司',
                    contract: 'SGHAWZ00HTMM2505170',
                    workshop: '装配',
                    package: '2025年5月中标第四次招标PC装置一国网安徽电力2025年第四次物资协议库存',
                    buyer: '国网安徽省电力有限公司物资分公司',
                    region: '安徽省',
                    salesman: '黄明明'
                },
                'RE25B0570': {
                    date: '2025-06-30 12:20:45',
                    no: 'RE25B0570',
                    type: '正常',
                    unit: '国网安徽省电力有限公司繁昌县供电公司',
                    contract: 'SGHAWZ00HTMM2505169',
                    workshop: '装配',
                    package: '2025年5月中标第五次招标PC装置一国网安徽电力2025年第五次物资协议库存',
                    buyer: '国网安徽省电力有限公司物资分公司',
                    region: '安徽省',
                    salesman: '黄明明'
                },
                'RE25B0569': {
                    date: '2025-06-30 11:15:30',
                    no: 'RE25B0569',
                    type: '正常',
                    unit: '国网安徽省电力有限公司繁昌县供电公司',
                    contract: 'SGHAWZ00HTMM2505168',
                    workshop: '装配',
                    package: '2025年5月中标第六次招标PC装置一国网安徽电力2025年第六次物资协议库存',
                    buyer: '国网安徽省电力有限公司物资分公司',
                    region: '安徽省',
                    salesman: '黄明明'
                }
            };

            const order = orderData[orderNo] || orderData['RE25B0574']; // 默认使用RE25B0574数据

            // 更新页面内容
            document.getElementById('order-detail-date').textContent = order.date;
            document.getElementById('order-detail-no').textContent = order.no;
            document.getElementById('order-detail-type').textContent = order.type;
            document.getElementById('order-detail-unit').textContent = order.unit;
            document.getElementById('order-detail-contract').textContent = order.contract;
            document.getElementById('order-detail-workshop').textContent = order.workshop;
            document.getElementById('order-detail-package').textContent = order.package;
            document.getElementById('order-detail-buyer').textContent = order.buyer;
            document.getElementById('order-detail-region').textContent = order.region;
            document.getElementById('order-detail-salesman').textContent = order.salesman;
        }
        
        function showContractDetail(contractId) {
            document.getElementById('contract-detail-modal').style.display = 'block';
        }
        
        function showSalesDetail(salesId) {
            document.getElementById('sales-detail-modal').style.display = 'block';
        }
        
                    // 框架协议管理相关函数
        function showBidDetail(bidId) {
            document.getElementById('bid-detail-modal').style.display = 'block';
        }
        
        function showBidForm(bidId = null) {
            const modal = document.getElementById('bid-form-modal');
            const title = document.getElementById('bid-form-title');
            const form = document.getElementById('bid-form');
            
            if (bidId) {
                title.textContent = '编辑框架协议';
                // 这里可以填充编辑数据
                loadBidData(bidId);
            } else {
                title.textContent = '新增框架协议';
                form.reset();
                // 清空明细表
                const tbody = document.querySelector('#bid-details-table tbody');
                tbody.innerHTML = '';
                // 添加一行空明细
                addBidDetailRow();
            }
            
            modal.style.display = 'block';
        }
        
        function editBid(bidId) {
            showBidForm(bidId);
        }
        
        function deleteBid(bidId) {
            if (confirm('确定要删除这个框架协议吗？')) {
                alert('删除成功！');
                // 这里实际项目中应该调用删除API
            }
        }
        
        function uploadBidFile(bidId) {
            // 存储当前标包ID
            window.currentBidId = bidId;
            // 打开文件上传模态框
            document.getElementById('bid-attachment-upload-modal').style.display = 'block';
        }
        
        // 框架协议附件上传相关函数
        function uploadBidAttachment() {
            document.getElementById('bid-attachment-upload-modal').style.display = 'block';
        }
        
        // 文件选择处理
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('bid-attachment-file-input');
            if (fileInput) {
                fileInput.addEventListener('change', handleBidFileSelect);
            }
        });
        
        function handleBidFileSelect(event) {
            const files = event.target.files;
            if (files.length > 0) {
                displayBidSelectedFiles(files);
            }
        }
        
        function displayBidSelectedFiles(files) {
            const fileList = document.getElementById('bid-file-list');
            const fileTableBody = document.getElementById('bid-upload-file-list');
            const uploadBtn = document.getElementById('bid-upload-btn');
            
            fileList.style.display = 'block';
            fileTableBody.innerHTML = '';
            
            Array.from(files).forEach((file, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${file.name}</td>
                    <td>${formatFileSize(file.size)}</td>
                    <td><span class="status-pending">待上传</span></td>
                    <td><button type="button" class="btn btn-secondary" onclick="removeBidFile(${index})" style="padding: 4px 8px;">移除</button></td>
                `;
                fileTableBody.appendChild(row);
            });
            
            uploadBtn.disabled = false;
            window.bidSelectedFiles = files;
        }
        
        function removeBidFile(index) {
            // 创建新的文件列表，排除指定索引的文件
            const dt = new DataTransfer();
            const files = Array.from(window.bidSelectedFiles);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            // 更新文件输入
            document.getElementById('bid-attachment-file-input').files = dt.files;
            
            // 重新显示文件列表
            if (dt.files.length > 0) {
                displayBidSelectedFiles(dt.files);
            } else {
                document.getElementById('bid-file-list').style.display = 'none';
                document.getElementById('bid-upload-btn').disabled = true;
                window.bidSelectedFiles = null;
            }
        }
        
        function submitBidAttachments() {
            const files = window.bidSelectedFiles;
            if (!files || files.length === 0) {
                alert('请选择要上传的文件');
                return;
            }
            
            // 模拟文件上传过程
            const fileTableBody = document.getElementById('bid-upload-file-list');
            const rows = fileTableBody.querySelectorAll('tr');
            
            rows.forEach((row, index) => {
                const statusCell = row.querySelector('td:nth-child(3)');
                statusCell.innerHTML = '<span class="status-uploading">上传中...</span>';
                
                // 模拟上传延迟
                setTimeout(() => {
                    statusCell.innerHTML = '<span class="status-success">上传成功</span>';
                    
                    // 当所有文件上传完成后
                    if (index === rows.length - 1) {
                        setTimeout(() => {
                            alert('所有文件上传成功！');
                            closeModal('bid-attachment-upload-modal');
                            // 刷新附件列表
                            refreshBidAttachmentList();
                        }, 500);
                    }
                }, (index + 1) * 1000);
            });
        }
        
        function refreshBidAttachmentList() {
            // 在实际项目中，这里会重新加载附件列表
            // 现在只是模拟添加新的附件到列表中
            const attachmentList = document.getElementById('bid-attachment-list');
            if (window.bidSelectedFiles) {
                Array.from(window.bidSelectedFiles).forEach(file => {
                    const row = document.createElement('tr');
                    const now = new Date();
                    const uploadTime = now.getFullYear() + '-' + 
                                     String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                                     String(now.getDate()).padStart(2, '0') + ' ' +
                                     String(now.getHours()).padStart(2, '0') + ':' + 
                                     String(now.getMinutes()).padStart(2, '0') + ':' + 
                                     String(now.getSeconds()).padStart(2, '0');
                    
                    row.innerHTML = `
                        <td>${file.name}</td>
                        <td>${getFileType(file.name)}</td>
                        <td>${formatFileSize(file.size)}</td>
                        <td>${uploadTime}</td>
                        <td>
                            <a href="#" class="action-link" onclick="downloadBidAttachment('${file.name}')">下载</a>
                            <a href="#" class="action-link" onclick="previewBidAttachment('${file.name}')">预览</a>
                            <a href="#" class="action-link danger" onclick="deleteBidAttachment('${file.name}')">删除</a>
                        </td>
                    `;
                    attachmentList.appendChild(row);
                });
            }
            
            // 清理临时数据
            window.bidSelectedFiles = null;
            document.getElementById('bid-attachment-file-input').value = '';
            document.getElementById('bid-file-list').style.display = 'none';
            document.getElementById('bid-upload-btn').disabled = true;
        }
        
        function getFileType(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const typeMap = {
                'pdf': 'PDF',
                'doc': 'Word',
                'docx': 'Word',
                'xls': 'Excel',
                'xlsx': 'Excel',
                'jpg': '图片',
                'jpeg': '图片',
                'png': '图片',
                'gif': '图片',
                'dwg': 'CAD',
                'dwf': 'CAD'
            };
            return typeMap[ext] || '其他';
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // 框架协议附件操作函数
        function downloadBidAttachment(filename) {
            alert(`下载文件：${filename}`);
            // 实际项目中会下载文件
        }
        
        function previewBidAttachment(filename) {
            alert(`预览文件：${filename}`);
            // 实际项目中会打开文件预览
        }
        
        function deleteBidAttachment(filename) {
            if (confirm(`确定要删除文件"${filename}"吗？`)) {
                // 找到并删除表格行
                const attachmentList = document.getElementById('bid-attachment-list');
                const rows = attachmentList.querySelectorAll('tr');
                rows.forEach(row => {
                    const firstCell = row.querySelector('td:first-child');
                    if (firstCell && firstCell.textContent === filename) {
                        row.remove();
                    }
                });
                alert('文件删除成功！');
            }
        }
        
        function loadBidData(bidId) {
            // 模拟加载编辑数据
            const form = document.getElementById('bid-form');
            const mockData = {
                'ECP-2025001': {
                    ecpContractNo: 'ECP-2025001',
                    purchaseOrderNo: 'PO-2025001001',
                    buyerContractNo: 'CON-BUYER-001',
                    sellerContractNo: 'CON-SELLER-001',
                    goodsName: '电力设备',
                    buyer: '国网安徽省电力有限公司',
                    seller: '河南光大实业有限公司',
                    signDate: '2025-05-15',
                    signLocation: '河南省郑州市',
                    bidPackageName: '2025年电力设备采购标包',
                    subBidNo: 'FB-2025001',
                    packageNo: 'BH-001',
                    bidAmount: '1580000.00',
                    purchaser: '张经理',
                    bidDate: '2025-05-15'
                }
            };
            
            const data = mockData[bidId];
            if (data) {
                Object.keys(data).forEach(key => {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input) {
                        input.value = data[key];
                    }
                });
                
                // 加载明细数据
                loadBidDetails();
            }
        }
        
        function loadBidDetails() {
            const tbody = document.querySelector('#bid-details-table tbody');
            tbody.innerHTML = '';
            
            // 模拟明细数据
            const details = [
                {
                    serialNo: '1',
                    goodsName: '高压开关柜',
                    goodsDesc: '12kV固体绝缘环网开关设备',
                    taxPrice: '65000.00',
                    unit: '台',
                    quantity: '10',
                    contractAmountWithTax: '650000.00',
                    contractAmountWithoutTax: '575221.24',
                    taxRate: '13',
                    deliveryStartDate: '2025-07-01',
                    deliveryEndDate: '2025-07-30',
                    deliveryLocation: '安徽省合肥市包河区工业园区',
                    deliveryMethod: '工厂交货'
                }
            ];
            
            details.forEach(detail => {
                addBidDetailRow(detail);
            });
        }
        
        let detailRowIndex = 0;
        
        function addBidDetailRow(data = null) {
            detailRowIndex++;
            const tbody = document.querySelector('#bid-details-table tbody');
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td><input type="text" class="filter-input" style="width: 60px;" name="details[${detailRowIndex}][serialNo]" value="${data ? data.serialNo : detailRowIndex}"></td>
                <td><input type="text" class="filter-input" style="width: 120px;" name="details[${detailRowIndex}][goodsName]" value="${data ? data.goodsName : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 150px;" name="details[${detailRowIndex}][goodsDesc]" value="${data ? data.goodsDesc : ''}" required></td>
                <td><input type="number" class="filter-input" style="width: 100px;" name="details[${detailRowIndex}][taxPrice]" value="${data ? data.taxPrice : ''}" step="0.01"></td>
                <td><input type="text" class="filter-input" style="width: 60px;" name="details[${detailRowIndex}][unit]" value="${data ? data.unit : ''}"></td>
                <td><input type="number" class="filter-input" style="width: 80px;" name="details[${detailRowIndex}][quantity]" value="${data ? data.quantity : ''}" required></td>
                <td><input type="number" class="filter-input" style="width: 120px;" name="details[${detailRowIndex}][contractAmountWithTax]" value="${data ? data.contractAmountWithTax : ''}" step="0.01" required></td>
                <td><input type="number" class="filter-input" style="width: 120px;" name="details[${detailRowIndex}][contractAmountWithoutTax]" value="${data ? data.contractAmountWithoutTax : ''}" step="0.01" required></td>
                <td><input type="number" class="filter-input" style="width: 80px;" name="details[${detailRowIndex}][taxRate]" value="${data ? data.taxRate : '13'}" step="0.01" required></td>
                <td><input type="date" class="filter-input" style="width: 150px;" name="details[${detailRowIndex}][deliveryStartDate]" value="${data ? data.deliveryStartDate : ''}" required></td>
                <td><input type="date" class="filter-input" style="width: 150px;" name="details[${detailRowIndex}][deliveryEndDate]" value="${data ? data.deliveryEndDate : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 150px;" name="details[${detailRowIndex}][deliveryLocation]" value="${data ? data.deliveryLocation : ''}"></td>
                <td>
                    <select class="filter-input" style="width: 100px;" name="details[${detailRowIndex}][deliveryMethod]">
                        <option value="">请选择</option>
                        <option value="工厂交货" ${data && data.deliveryMethod === '工厂交货' ? 'selected' : ''}>工厂交货</option>
                        <option value="送货上门" ${data && data.deliveryMethod === '送货上门' ? 'selected' : ''}>送货上门</option>
                        <option value="客户自提" ${data && data.deliveryMethod === '客户自提' ? 'selected' : ''}>客户自提</option>
                    </select>
                </td>
                <td><button type="button" class="btn btn-secondary" onclick="removeBidDetailRow(this)" style="padding: 4px 8px;">删除</button></td>
            `;
            
            tbody.appendChild(row);
        }
        
        function removeBidDetailRow(button) {
            if (confirm('确定要删除这一行吗？')) {
                button.closest('tr').remove();
            }
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // 表单提交处理
        document.getElementById('bid-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 获取表单数据
            const formData = new FormData(this);
            const data = {};
            
            // 处理基本信息
            for (let [key, value] of formData.entries()) {
                if (!key.startsWith('details[')) {
                    data[key] = value;
                }
            }
            
            // 处理明细信息
            data.details = [];
            const detailRows = document.querySelectorAll('#bid-details-table tbody tr');
            detailRows.forEach(row => {
                const inputs = row.querySelectorAll('input, select');
                const detail = {};
                inputs.forEach(input => {
                    const match = input.name.match(/details\[\d+\]\[(.+)\]/);
                    if (match) {
                        detail[match[1]] = input.value;
                    }
                });
                data.details.push(detail);
            });
            
            console.log('提交的数据：', data);
            alert('保存成功！');
            closeModal('bid-form-modal');
        });
        
        // 合同管理相关函数
        function showContractForm(contractId = null) {
            const modal = document.getElementById('contract-form-modal');
            const title = document.getElementById('contract-form-title');
            const form = document.getElementById('contract-form');
            
            if (contractId) {
                title.textContent = '编辑合同';
                // 这里可以填充编辑数据
                loadContractData(contractId);
            } else {
                title.textContent = '新增合同';
                form.reset();
                // 清空明细表
                const tbody = document.querySelector('#contract-details-table tbody');
                tbody.innerHTML = '';
                // 添加一行空明细
                addContractDetailRow();
            }
            
            modal.style.display = 'block';
        }
        
        function editContract(contractId) {
            showContractForm(contractId);
        }
        
        function uploadContract(contractId) {
            document.getElementById('contract-upload-modal').style.display = 'block';
        }
        
        function deleteContract(contractId) {
            if (confirm('确定要删除这个合同吗？')) {
                alert('删除成功！');
            }
        }
        
        function uploadContractFile() {
            alert('文件上传成功！');
            closeModal('contract-upload-modal');
        }
        
        function showContractUploadSurvey(contractId) {
            console.log('showContractUploadSurvey called with contractId:', contractId);
            
            const modal = document.getElementById('contract-upload-survey-modal');
            if (!modal) {
                console.error('合同上传满意度调查弹窗元素未找到');
                return;
            }
            
            const form = document.getElementById('contract-upload-survey-form');
            if (!form) {
                console.error('合同上传满意度调查表单元素未找到');
                return;
            }
            
            const contractNoSelect = form.querySelector('select[name="contractNo"]');
            
            // 清空表单
            form.reset();
            
            // 设置合同编号的默认选择项为当前合同ID
            if (contractNoSelect) {
                contractNoSelect.value = contractId;
            }
            
            // 清空文件列表
            const fileList = document.getElementById('contract-file-list');
            if (fileList) {
                fileList.innerHTML = '';
            }
            
            // 显示弹窗
            modal.style.display = 'block';
            console.log('弹窗已显示');
        }
        
        // 合同明细行管理
        let contractDetailRowIndex = 0;
        
        function addContractDetailRow(data = null) {
            contractDetailRowIndex++;
            const tbody = document.querySelector('#contract-details-table tbody');
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td><input type="text" class="filter-input" style="width: 60px;" name="contractDetails[${contractDetailRowIndex}][serialNo]" value="${data ? data.serialNo : contractDetailRowIndex}"></td>
                <td><input type="text" class="filter-input" style="width: 150px;" name="contractDetails[${contractDetailRowIndex}][projectUnit]" value="${data ? data.projectUnit : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 150px;" name="contractDetails[${contractDetailRowIndex}][projectName]" value="${data ? data.projectName : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 120px;" name="contractDetails[${contractDetailRowIndex}][goodsName]" value="${data ? data.goodsName : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 150px;" name="contractDetails[${contractDetailRowIndex}][specification]" value="${data ? data.specification : ''}" required></td>
                <td><input type="number" class="filter-input" style="width: 80px;" name="contractDetails[${contractDetailRowIndex}][quantity]" value="${data ? data.quantity : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 60px;" name="contractDetails[${contractDetailRowIndex}][unit]" value="${data ? data.unit : ''}" required></td>
                <td><input type="number" class="filter-input" style="width: 100px;" name="contractDetails[${contractDetailRowIndex}][unitPriceExTax]" value="${data ? data.unitPriceExTax : ''}" step="0.01" required></td>
                <td><input type="number" class="filter-input" style="width: 80px;" name="contractDetails[${contractDetailRowIndex}][taxRate]" value="${data ? data.taxRate : '13'}" step="0.01" required></td>
                <td><input type="number" class="filter-input" style="width: 120px;" name="contractDetails[${contractDetailRowIndex}][itemPriceExTax]" value="${data ? data.itemPriceExTax : ''}" step="0.01" required></td>
                <td><input type="number" class="filter-input" style="width: 120px;" name="contractDetails[${contractDetailRowIndex}][itemPriceIncTax]" value="${data ? data.itemPriceIncTax : ''}" step="0.01" required></td>
                <td><input type="date" class="filter-input" style="width: 120px;" name="contractDetails[${contractDetailRowIndex}][deliveryTime]" value="${data ? data.deliveryTime : ''}" required></td>
                <td><input type="text" class="filter-input" style="width: 200px;" name="contractDetails[${contractDetailRowIndex}][deliveryLocationMethod]" value="${data ? data.deliveryLocationMethod : ''}"></td>
                <td><button type="button" class="btn btn-secondary" onclick="removeContractDetailRow(this)" style="padding: 4px 8px;">删除</button></td>
            `;
            
            tbody.appendChild(row);
        }
        
        function removeContractDetailRow(button) {
            if (confirm('确定要删除这一行吗？')) {
                button.closest('tr').remove();
            }
        }
        
        function loadContractData(contractId) {
            // 模拟加载合同编辑数据
            const form = document.getElementById('contract-form');
            const mockData = {
                'CON-2025001': {
                    bidPackageName: '2025年电力设备采购标包',
                    buyer: '国网安徽省电力有限公司',
                    agreementContractNo: 'SGAH-AGREEMENTSTOCK-2025001',
                    orderType: '正常',
                    seller: '河南光大实业有限公司',
                    supplyOrderNo: 'SGD-2025001001',
                    priceExcludingTax: '1371681.42',
                    priceIncludingTax: '1580000.00',
                    reTaxInclusivePrice: '65000.00'
                },
                'CON-2025002': {
                    bidPackageName: '变压器采购标包',
                    buyer: '江苏食品技术有限公司',
                    agreementContractNo: 'JSSP-AGREEMENTSTOCK-2025002',
                    orderType: '紧急',
                    seller: '河南光大实业有限公司',
                    supplyOrderNo: 'SGD-2025001002',
                    priceExcludingTax: '2039823.01',
                    priceIncludingTax: '2354500.00',
                    reTaxInclusivePrice: '28500.00'
                },
                'CON-2025003': {
                    bidPackageName: '配电设备采购标包',
                    buyer: '河南科技集团有限公司',
                    agreementContractNo: 'HNKJ-AGREEMENTSTOCK-2025003',
                    orderType: '特急',
                    seller: '河南光大实业有限公司',
                    supplyOrderNo: 'SGD-2025001003',
                    priceExcludingTax: '849557.52',
                    priceIncludingTax: '980000.00',
                    reTaxInclusivePrice: '12800.00'
                }
            };
            
            const data = mockData[contractId];
            if (data) {
                Object.keys(data).forEach(key => {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input) {
                        input.value = data[key];
                    }
                });
            }
        }
        
        // 销售订单相关函数
        function showSalesOrderDetail(orderId) {
            document.getElementById('sales-order-detail-modal').style.display = 'block';
        }

        // 销售订单视图切换功能
        function switchSalesView(viewType) {
            const orderTableContainer = document.getElementById('order-table-container');
            const detailTableContainer = document.getElementById('detail-table-container');
            const orderViewBtn = document.getElementById('order-view-btn');
            const detailViewBtn = document.getElementById('detail-view-btn');

            if (viewType === 'order') {
                // 显示按单查询
                orderTableContainer.style.display = 'block';
                detailTableContainer.style.display = 'none';
                orderViewBtn.classList.add('active');
                detailViewBtn.classList.remove('active');
            } else if (viewType === 'detail') {
                // 显示按明细查询
                orderTableContainer.style.display = 'none';
                detailTableContainer.style.display = 'block';
                orderViewBtn.classList.remove('active');
                detailViewBtn.classList.add('active');
            }
        }

        // 全选/取消全选明细列表
        function toggleSelectAllDetail() {
            const selectAllCheckbox = document.getElementById('select-all-detail');
            const rowCheckboxes = document.querySelectorAll('.detail-row-checkbox');
            
            rowCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            
            updateDetailSelection();
        }

        // 更新明细选择状态
        function updateDetailSelection() {
            const selectAllCheckbox = document.getElementById('select-all-detail');
            const rowCheckboxes = document.querySelectorAll('.detail-row-checkbox');
            const checkedBoxes = document.querySelectorAll('.detail-row-checkbox:checked');
            
            // 更新全选框状态
            if (checkedBoxes.length === 0) {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = false;
            } else if (checkedBoxes.length === rowCheckboxes.length) {
                selectAllCheckbox.checked = true;
                selectAllCheckbox.indeterminate = false;
            } else {
                selectAllCheckbox.checked = false;
                selectAllCheckbox.indeterminate = true;
            }
            
            // 可以在这里添加选中项的处理逻辑
            console.log('已选择的订单:', Array.from(checkedBoxes).map(cb => cb.value));
        }

        // 销售订单详情页标签页切换功能
        function switchOrderDetailTab(tabType) {
            // 隐藏所有内容
            const detailContent = document.getElementById('detail-tab-content');
            const packageContent = document.getElementById('package-tab-content');
            const contractContent = document.getElementById('contract-tab-content');
            
            if (detailContent) detailContent.style.display = 'none';
            if (packageContent) packageContent.style.display = 'none';
            if (contractContent) contractContent.style.display = 'none';

            // 移除所有标签页的激活状态
            const tabs = document.querySelectorAll('.order-detail-tab');
            tabs.forEach(tab => {
                tab.style.borderBottom = 'none';
                tab.style.color = '#6c757d';
                tab.style.fontWeight = 'normal';
            });

            // 激活当前标签页
            event.target.style.borderBottom = '2px solid #007bff';
            event.target.style.color = '#007bff';
            event.target.style.fontWeight = '600';

            // 显示对应内容
            switch(tabType) {
                case 'all':
                case 'detail':
                    if (detailContent) detailContent.style.display = 'block';
                    break;
                case 'package':
                    if (packageContent) packageContent.style.display = 'block';
                    break;
                case 'contract':
                    if (contractContent) contractContent.style.display = 'block';
                    break;
                default:
                    // 其他标签页暂时显示订单明细
                    if (detailContent) detailContent.style.display = 'block';
                    break;
            }
        }
        
        function showSalesOrderDetailPage(orderId) {
            // 显示销售订单详情页面（基于截图1复刻）
            document.getElementById('sales-order-detail-modal').style.display = 'block';
        }
        
        function showOrderTab(tabName) {
            // 更新标签页激活状态
            const tabs = document.querySelectorAll('.tab-item');
            tabs.forEach(tab => {
                tab.classList.remove('active');
                tab.style.borderBottom = 'none';
                tab.style.color = '#6b7280';
            });
            
            // 激活当前标签页
            event.target.classList.add('active');
            event.target.style.borderBottom = '2px solid #3b82f6';
            event.target.style.color = '#3b82f6';
            
            // 这里可以添加显示不同标签页内容的逻辑
            console.log('切换到标签页：', tabName);
        }
        
        // 订单查询相关函数
        function showOrderFinalDetail(orderNo) {
            document.getElementById('order-final-detail-modal').style.display = 'block';
        }
        
        function goToSalesOrder(orderNo) {
            // 从订单查询跳转到销售订单模块
            showModule('sales');
            // 可以在这里添加高亮显示特定订单的逻辑
            setTimeout(() => {
                // 查找并高亮显示对应的订单行
                const salesTable = document.querySelector('#sales-module .data-table tbody');
                const rows = salesTable.querySelectorAll('tr');
                rows.forEach(row => {
                    row.style.backgroundColor = '';
                });
                
                // 这里可以根据orderNo查找对应的销售订单并高亮
                alert(`已切换到销售订单模块，查找订单：${orderNo}`);
            }, 100);
        }
        
        // 车间与负责人映射关系
        const techDepartmentMapping = {
            '计量箱': [
                { name: '张明华', phone: '13912345678', position: '计量箱技术主管' },
                { name: '李小峰', phone: '13912345679', position: '计量箱高级工程师' },
                { name: '王志强', phone: '13912345680', position: '计量箱工程师' }
            ],
            '低压柜': [
                { name: '王大伟', phone: '13687899934', position: '低压柜技术主管' },
                { name: '陈光辉', phone: '13687899935', position: '低压柜高级工程师' },
                { name: '马晓东', phone: '13687899936', position: '低压柜工程师' }
            ],
            '钣金': [
                { name: '孙伟杰', phone: '13876543210', position: '钣金技术主管' },
                { name: '刘德华', phone: '13876543211', position: '钣金高级工程师' },
                { name: '周星驰', phone: '13876543212', position: '钣金工程师' }
            ],
            '表箱': [
                { name: '李表箱', phone: '13765432109', position: '表箱技术主管' },
                { name: '张表箱', phone: '13765432110', position: '表箱高级工程师' },
                { name: '王表箱', phone: '13765432111', position: '表箱工程师' }
            ],
            '跃腾': [
                { name: '赵跃腾', phone: '13654321098', position: '跃腾技术主管' },
                { name: '张跃腾', phone: '13654321099', position: '跃腾高级工程师' },
                { name: '刘跃腾', phone: '13654321100', position: '跃腾工程师' }
            ]
        };

        // 产品种类与车间的智能匹配
        const productCategoryMapping = {
            '高压开关柜': '低压柜',
            '配电变压器': '低压柜',
            '电缆': '钣金',
            '计量箱': '计量箱',
            '低压开关柜': '低压柜',
            '电力设备': '低压柜',
            '配电柜': '低压柜',
            '电能计量箱': '计量箱',
            '变压器控制器': '低压柜',
            '配电控制柜': '低压柜',
            '配电变压器': '低压柜',
            '真空断路器': '低压柜',
            '负荷开关': '低压柜',
            '电力电缆': '钣金',
            '控制电缆': '钣金',
            '单相计量箱': '计量箱',
            '三相计量箱': '计量箱',
            '户外计量箱': '计量箱',
            '不锈钢箱体': '钣金',
            '碳钢箱体': '钣金',
            '铝合金箱体': '钣金',
            '表箱': '表箱',
            '电表箱': '表箱',
            '户外表箱': '表箱',
            '跃腾产品': '跃腾',
            '跃腾设备': '跃腾'
        };

        // 车间分配行管理
        let techTaskRowIndex = 0;
        let materialCards = {}; // 存储产品卡片数据

        // 创建产品卡片
        function createMaterialCard(materialCode, categoryName) {
            const container = document.getElementById('tech-task-container');
            
            const cardId = `material-card-${materialCode}`;
            const cardElement = document.createElement('div');
            cardElement.className = 'material-card';
            cardElement.id = cardId;
            
            cardElement.innerHTML = `
                <div class="material-card-header">
                    <div class="material-info">
                        <div class="material-name">${categoryName}</div>
                    </div>
                    <div class="material-card-actions">
                        <button type="button" class="btn" onclick="addTechDepartmentToCard('${materialCode}')">
                            <i class="fas fa-plus"></i> 增加产品类型
                        </button>
                    </div>
                </div>
                <div class="material-card-body">
                    <div class="tech-department-list" id="tech-list-${materialCode}">
                        <!-- 产品类型列表 -->
                    </div>
                </div>
            `;
            
            container.appendChild(cardElement);
            
            // 初始化产品数据
            materialCards[materialCode] = {
                categoryName: categoryName,
                techDepartments: []
            };
            
            // 自动添加一个车间
            addTechDepartmentToCard(materialCode);
            
            return cardElement;
        }

        // 为产品卡片添加车间
        function addTechDepartmentToCard(materialCode) {
            const techList = document.getElementById(`tech-list-${materialCode}`);
            const departmentId = `tech-dept-${materialCode}-${Date.now()}`;
            
            const departmentItem = document.createElement('div');
            departmentItem.className = 'tech-department-item';
            departmentItem.id = departmentId;
            
            departmentItem.innerHTML = `
                <div class="tech-department-select">
                                         <select name="techDepartment" required onchange="updateTechLeaderForCard(this, '${materialCode}', '${departmentId}')"
                             data-material-code="${materialCode}"
                             data-category-name="${materialCards[materialCode].categoryName}">
                         <option value="">请选择产品类型</option>
                         <option value="低压柜">低压柜</option>
                         <option value="计量箱">计量箱</option>
                         <option value="钣金">钣金</option>
                         <option value="表箱">表箱</option>
                         <option value="跃腾">跃腾</option>
                     </select>
                </div>
                <div class="tech-leader-select">
                    <select name="techLeader" required>
                        <option value="">请选择技术负责人</option>
                    </select>
                </div>
                <div class="tech-department-item-actions">
                    <button type="button" class="btn btn-danger" onclick="removeTechDepartmentFromCard('${materialCode}', '${departmentId}')" title="删除此产品类型">
                        删除
                    </button>
                </div>
            `;
            
            techList.appendChild(departmentItem);
            
            // 根据种类名称自动选择车间
            const categoryName = materialCards[materialCode].categoryName;
            const departmentSelect = departmentItem.querySelector('select[name="techDepartment"]');
            const matchedDepartment = getMatchedDepartment(categoryName);
            if (matchedDepartment) {
                departmentSelect.value = matchedDepartment;
                updateTechLeaderForCard(departmentSelect, materialCode, departmentId);
            }
        }

        // 从产品卡片中删除车间
        function removeTechDepartmentFromCard(materialCode, departmentId) {
            const techList = document.getElementById(`tech-list-${materialCode}`);
            const departmentItem = document.getElementById(departmentId);
            
            // 确保至少保留一个车间
            if (techList.children.length <= 1) {
                alert('每个产品至少需要分配一个产品类型');
                return;
            }
            
            if (confirm('确定要删除这个产品类型吗？')) {
                departmentItem.remove();
            }
        }

        // 更新卡片中的技术负责人
        function updateTechLeaderForCard(departmentSelect, materialCode, departmentId) {
            const selectedDepartment = departmentSelect.value;
            const departmentItem = document.getElementById(departmentId);
            const leaderSelect = departmentItem.querySelector('select[name="techLeader"]');
            
            updateTechLeaderOptions(leaderSelect, selectedDepartment);
            
            // 自动选择第一个技术负责人
            if (selectedDepartment && leaderSelect.options.length > 1) {
                leaderSelect.selectedIndex = 1;
            }
        }



        // 根据种类名称匹配车间
        function getMatchedDepartment(categoryName) {
            if (!categoryName) return null;
            
            const categoryLower = categoryName.toLowerCase();
            
            if (categoryLower.includes('计量') && !categoryLower.includes('表箱')) {
                return '计量箱';
            } else if (categoryLower.includes('表箱') || categoryLower.includes('电表箱')) {
                return '表箱';
            } else if (categoryLower.includes('跃腾')) {
                return '跃腾';
            } else if (categoryLower.includes('低压') || categoryLower.includes('配电') || categoryLower.includes('开关')) {
                return '低压柜';
            } else if (categoryLower.includes('钣金') || categoryLower.includes('箱体') || categoryLower.includes('柜体')) {
                return '钣金';
            }
            
            return null;
        }





        // 更新技术负责人选项
        function updateTechLeaderOptions(leaderSelect, department) {
            leaderSelect.innerHTML = '<option value="">请选择负责人</option>';
            
            if (department && techDepartmentMapping[department]) {
                techDepartmentMapping[department].forEach(leader => {
                    const option = document.createElement('option');
                    option.value = `${leader.name} (${leader.phone})`;
                    option.textContent = `${leader.name} (${leader.phone})`;
                    leaderSelect.appendChild(option);
                });
            }
        }


        
        // 粘贴识别功能
        function recognizePasteContent() {
            const pasteInput = document.getElementById('paste-input');
            const content = pasteInput.value.trim();
            
            if (!content) {
                alert('请先输入或粘贴联系人信息');
                return;
            }
            
            // 智能识别联系人信息
            const recognizedData = parseContactInfo(content);
            
            // 填充到表单中
            if (recognizedData.name) {
                document.getElementById('tech-contact-name-input').value = recognizedData.name;
            }
            if (recognizedData.phone) {
                document.getElementById('tech-contact-phone-input').value = recognizedData.phone;
            }
            if (recognizedData.position) {
                document.getElementById('tech-contact-position-input').value = recognizedData.position;
            }
            if (recognizedData.email) {
                document.getElementById('tech-contact-email-input').value = recognizedData.email;
            }
            if (recognizedData.address) {
                // 如果有地址信息，可以放在备注中
                const notesInput = document.getElementById('tech-contact-notes-input');
                const currentNotes = notesInput.value;
                notesInput.value = currentNotes ? currentNotes + '\n地址：' + recognizedData.address : '地址：' + recognizedData.address;
            }
            
            // 清空输入框
            pasteInput.value = '';
            
            // 显示识别结果提示
            showRecognitionResult(recognizedData);
        }
        
        // 解析联系人信息
        function parseContactInfo(content) {
            const result = {
                name: '',
                phone: '',
                position: '',
                email: '',
                address: ''
            };
            
            // 手机号码正则表达式
            const phoneRegex = /1[3-9]\d{9}/g;
            const phones = content.match(phoneRegex);
            if (phones && phones.length > 0) {
                result.phone = phones[0];
            }
            
            // 邮箱正则表达式
            const emailRegex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;
            const emails = content.match(emailRegex);
            if (emails && emails.length > 0) {
                result.email = emails[0];
            }
            
            // 职位关键词
            const positionKeywords = ['工程师', '技术员', '主管', '经理', '总监', '负责人', '专员', '助理', '总经理', '副总', '部长', '科长'];
            for (let keyword of positionKeywords) {
                if (content.includes(keyword)) {
                    // 提取包含职位关键词的词组
                    const positionMatch = content.match(new RegExp(`[\\u4e00-\\u9fa5]*${keyword}[\\u4e00-\\u9fa5]*`));
                    if (positionMatch) {
                        result.position = positionMatch[0];
                        break;
                    }
                }
            }
            
            // 地址关键词（省市区县）
            const addressKeywords = ['省', '市', '区', '县', '街道', '路', '号', '楼', '层', '室'];
            let addressParts = [];
            for (let keyword of addressKeywords) {
                if (content.includes(keyword)) {
                    // 尝试提取地址部分
                    const addressMatch = content.match(new RegExp(`[\\u4e00-\\u9fa5\\d]+${keyword}[\\u4e00-\\u9fa5\\d]*`));
                    if (addressMatch) {
                        addressParts.push(addressMatch[0]);
                    }
                }
            }
            if (addressParts.length > 0) {
                result.address = addressParts.join('');
            }
            
            // 姓名提取（去除手机号、邮箱、职位、地址后的中文字符）
            let nameContent = content;
            if (result.phone) nameContent = nameContent.replace(result.phone, '');
            if (result.email) nameContent = nameContent.replace(result.email, '');
            if (result.position) nameContent = nameContent.replace(result.position, '');
            if (result.address) nameContent = nameContent.replace(result.address, '');
            
            // 提取可能的姓名（2-4个中文字符）
            const nameMatch = nameContent.match(/[\u4e00-\u9fa5]{2,4}/);
            if (nameMatch) {
                result.name = nameMatch[0];
            }
            
            return result;
        }
        
        // 显示识别结果
        function showRecognitionResult(data) {
            const results = [];
            if (data.name) results.push(`姓名：${data.name}`);
            if (data.phone) results.push(`电话：${data.phone}`);
            if (data.position) results.push(`职位：${data.position}`);
            if (data.email) results.push(`邮箱：${data.email}`);
            if (data.address) results.push(`地址：${data.address}`);
            
            if (results.length > 0) {
                alert(`识别成功！\n${results.join('\n')}\n\n信息已自动填充到表单中，请检查并确认。`);
            } else {
                alert('未能识别出联系人信息，请检查输入格式或手动填写。');
            }
        }
        
        // 技术联系人相关函数
        function showTechContact(orderCode) {
            // 模拟根据订单编码/合同编号加载技术联系人信息
            const techContactData = {
                'PO-2025001001': {
                    name: '张工程师',
                    phone: '13800138001',
                    position: '高级工程师',
                    email: 'zhang.engineer@company.com'
                },
                'PO-2025001002': {
                    name: '李技术员',
                    phone: '13900139002',
                    position: '技术员',
                    email: 'li.technician@company.com'
                },
                // 合同管理中的技术联系人
                'CON-2025001': {
                    name: '陈技术总监',
                    phone: '13600136001',
                    position: '技术总监',
                    email: 'chen.director@company.com'
                },
                'CON-2025002': {
                    name: '赵高级工程师',
                    phone: '13500135002',
                    position: '高级工程师',
                    email: 'zhao.engineer@company.com'
                },
                'CON-2025003': {
                    name: '王技术主管',
                    phone: '13700137003',
                    position: '技术主管',
                    email: 'wang.manager@company.com'
                }
            };
            
            const contactInfo = techContactData[orderCode] || {
                name: '',
                phone: '',
                position: '',
                email: ''
            };
            
            // 预填表单数据（如果有的话）
            document.getElementById('tech-contact-name-input').value = contactInfo.name;
            document.getElementById('tech-contact-phone-input').value = contactInfo.phone;
            document.getElementById('tech-contact-position-input').value = contactInfo.position || '';
            document.getElementById('tech-contact-email-input').value = contactInfo.email || '';
            document.getElementById('tech-contact-notes-input').value = '';
            
            // 清空粘贴输入框
            document.getElementById('paste-input').value = '';
            
                            // 清空车间分配容器
            const container = document.getElementById('tech-task-container');
            container.innerHTML = '';
                          materialCards = {}; // 重置产品卡片数据
            
                            // 根据订单编码加载相关的产品信息，自动创建车间分配
            loadProductTasks(orderCode);
            
            // 存储当前的订单编码，用于提交时使用
            window.currentOrderCode = orderCode;
            
            // 显示模态框
            document.getElementById('tech-contact-modal').style.display = 'block';
        }
        
        // 根据订单编码加载产品任务
        function loadProductTasks(orderCode) {
            // 模拟从系统中获取该订单的物资信息（来自子表）
            const orderProductData = {
                'CON-2025001': [
                    { materialCode: 'WZ-002', categoryName: '配电箱', serialNo: 2 }
                ],
                'CON-2025002': [
                ],
                'CON-2025003': [
                    { materialCode: 'WZ-005', categoryName: '配电控制柜', serialNo: 1 },
                    { materialCode: 'WZ-006', categoryName: '钣金箱体', serialNo: 2 },
                    { materialCode: 'WZ-007', categoryName: '计量表箱', serialNo: 3 }
                ],
                'PO-2025001001': [
                    { materialCode: 'WZ-008', categoryName: '低压配电柜', serialNo: 1 },
                    { materialCode: 'WZ-009', categoryName: '钣金柜体', serialNo: 2 }
                ],
                'PO-2025001002': [
                    { materialCode: 'WZ-010', categoryName: '计量箱', serialNo: 1 }
                ]
            };
            
            const products = orderProductData[orderCode] || [];
            
            // 为每个物资创建卡片
            products.forEach((product, index) => {
                createMaterialCard(product.materialCode, product.categoryName);
            });
            
            // 如果没有物资数据，显示空状态提示
            if (products.length === 0) {
                const container = document.getElementById('tech-task-container');
                container.innerHTML = `
                    <div class="empty-tech-departments">
                        <i class="fas fa-box-open"></i>
                        <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">暂无物资信息</div>
                        <div style="font-size: 14px;">请先在主表中添加物资信息，然后重新打开技术联系人</div>
                    </div>
                `;
            }
        }
        

        
        // 表单提交处理
        document.getElementById('contract-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            console.log('提交的合同数据：', data);
            alert('合同保存成功！');
            closeModal('contract-form-modal');
        });
        
        // 客户满意度调查相关函数
        function showSurveyForm(surveyId = null) {
            const modal = document.getElementById('survey-form-modal');
            const title = document.getElementById('survey-form-title');
            const form = document.getElementById('survey-form');
            
            if (surveyId) {
                title.textContent = '修改客户满意度调查';
                // 这里可以填充编辑数据
                loadSurveyData(surveyId);
            } else {
                title.textContent = '新增客户满意度调查';
                form.reset();
                // 清空文件列表
                document.getElementById('file-list').innerHTML = '';
            }
            
            modal.style.display = 'block';
        }
        
        function editSurvey(surveyId) {
            showSurveyForm(surveyId);
        }
        
        function deleteSurvey(surveyId) {
            if (confirm('确定要删除这个调查吗？')) {
                alert('删除成功！');
            }
        }
        
        function previewAttachment(surveyId) {
            // 模拟加载附件数据
            const attachmentData = {
                'SURVEY-2025001': [
                    {
                        name: '客户满意度调查表.pdf',
                        type: 'PDF',
                        size: '2.5MB',
                        uploadTime: '2025-06-15 10:30:00',
                        isPrimary: true
                    },
                    {
                        name: '反馈意见汇总.xlsx',
                        type: 'Excel',
                        size: '1.2MB',
                        uploadTime: '2025-06-15 11:15:00'
                    }
                ],
                'SURVEY-2025002': [
                    {
                        name: '调查问卷.docx',
                        type: 'Word',
                        size: '876KB',
                        uploadTime: '2025-06-20 14:20:00',
                        isPrimary: true
                    }
                ]
            };
            
            const attachments = attachmentData[surveyId] || [];
            
            // 查找主要的PDF文件进行预览
            const pdfFile = attachments.find(att => att.type === 'PDF' && att.isPrimary) || 
                           attachments.find(att => att.type === 'PDF') ||
                           attachments[0];
            
            if (pdfFile) {
                // 显示PDF预览
                showPdfPreview(pdfFile, attachments);
            } else {
                // 如果没有PDF文件，显示附件列表
                showAttachmentListOnly(attachments);
            }
            
            document.getElementById('attachment-preview-modal').style.display = 'block';
        }
        
        function showPdfPreview(pdfFile, allAttachments) {
            // 更新标题和文件名
            document.getElementById('attachment-preview-title').textContent = 'PDF文件预览 - ' + pdfFile.name;
            document.getElementById('current-file-name').textContent = pdfFile.name;
            
            // 显示PDF预览区域，隐藏附件列表
            document.getElementById('pdf-preview-container').style.display = 'flex';
            document.getElementById('attachment-list-container').style.display = 'none';
            
            // 模拟PDF加载
            const pdfViewer = document.getElementById('pdf-viewer');
            const placeholder = document.getElementById('pdf-placeholder');
            
            // 显示占位符（实际项目中这里会加载真实的PDF）
            pdfViewer.style.display = 'none';
            placeholder.style.display = 'flex';
            
            // 存储当前附件信息供其他功能使用
            window.currentAttachments = allAttachments;
            window.currentPdfFile = pdfFile;
        }
        
        function showAttachmentListOnly(attachments) {
            // 更新标题
            document.getElementById('attachment-preview-title').textContent = '附件列表';
            
            // 隐藏PDF预览区域，显示附件列表
            document.getElementById('pdf-preview-container').style.display = 'none';
            document.getElementById('attachment-list-container').style.display = 'block';
            
            const attachmentList = document.getElementById('attachment-list');
            
            if (attachments.length === 0) {
                attachmentList.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: #6b7280;">暂无附件</td></tr>';
            } else {
                attachmentList.innerHTML = attachments.map(attachment => `
                    <tr>
                        <td>${attachment.name}</td>
                        <td>${attachment.type}</td>
                        <td>${attachment.size}</td>
                        <td>${attachment.uploadTime}</td>
                        <td>
                            <a href="#" class="action-link" onclick="downloadAttachment('${attachment.name}')">下载</a>
                            <a href="#" class="action-link" onclick="deleteAttachment('${attachment.name}')">删除</a>
                        </td>
                    </tr>
                `).join('');
            }
        }
        
        function showAttachmentList() {
            // 切换到附件列表视图
            if (window.currentAttachments) {
                showAttachmentListOnly(window.currentAttachments);
            }
        }
        
        function backToPdfPreview() {
            // 返回PDF预览视图
            if (window.currentPdfFile && window.currentAttachments) {
                showPdfPreview(window.currentPdfFile, window.currentAttachments);
            }
        }
        
        function downloadCurrentFile() {
            // 下载当前预览的文件
            if (window.currentPdfFile) {
                downloadAttachment(window.currentPdfFile.name);
            }
        }
        
        function downloadSurveyTemplate() {
            // 下载客户满意度调查表模板
            alert('正在下载客户满意度调查表模板...');
            // 实际实现中这里会创建一个链接下载模板文件
            const link = document.createElement('a');
            link.href = 'data:application/octet-stream;base64,'; // 模拟文件下载
            link.download = '客户满意度调查表模板.xlsx';
            link.click();
        }
        
        // 主子表展示功能 - 销售订单
        function showSalesSubTable(orderId) {
            const subTableSection = document.getElementById('sub-table-section');
            const subTableTitle = document.getElementById('sub-table-title');
            const subTableContent = document.getElementById('sub-table-content');
            
            // 设置标题
            subTableTitle.textContent = `销售订单明细 - ${orderId}`;
            
            // 生成子表内容
            const subTableHtml = getSalesSubTableData(orderId);
            subTableContent.innerHTML = subTableHtml;
            
            // 显示子表区域
            subTableSection.style.display = 'block';
            
            // 滚动到子表位置
            subTableSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // 主子表展示功能 - 合同管理
        function showContractSubTable(contractId) {
            const subTableSection = document.getElementById('sub-table-section');
            const subTableTitle = document.getElementById('sub-table-title');
            const subTableContent = document.getElementById('sub-table-content');
            
            // 设置标题
                            subTableTitle.textContent = `合同明细`;
            
            // 生成子表内容
            const subTableHtml = getContractSubTableData(contractId);
            subTableContent.innerHTML = subTableHtml;
            
            // 显示子表区域
            subTableSection.style.display = 'block';
            
            // 滚动到子表位置
            subTableSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // 主子表展示功能 - 标包管理
        function showBidSubTable(bidId) {
            const subTableSection = document.getElementById('sub-table-section');
            const subTableTitle = document.getElementById('sub-table-title');
            const subTableContent = document.getElementById('sub-table-content');
            
            // 设置标题
            subTableTitle.textContent = `框架协议明细 - ${bidId}`;
            
            // 生成子表内容
            const subTableHtml = getBidSubTableData(bidId);
            subTableContent.innerHTML = subTableHtml;
            
            // 显示子表区域
            subTableSection.style.display = 'block';
            
            // 滚动到子表位置
            subTableSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // 隐藏子表
        function hideSubTable() {
            const subTableSection = document.getElementById('sub-table-section');
            subTableSection.style.display = 'none';
        }
        
        // 获取销售订单子表数据
        function getSalesSubTableData(orderId) {
            const salesData = {
                'RE25000010': [
                    {
                        goodsName: '电能计量箱,单相,1P+N+PE',
                        spec: '电能计量箱,单相,1.PC+A-C+ABS,60A,悬挂式',
                        unit: '只',
                        quantity: '19',
                        projectName: '安徽芜湖繁昌县10kV芜山口#360211上上滁线工程',
                        unitPrice: '84.2979',
                        totalAmount: '¥1,601.66',
                        deliveryTime: '25/08/18',
                        techId: ''
                    },
                    {
                        goodsName: '电能计量箱,单相,2P+N+PE',
                        spec: '电能计量箱,单相,2.PC+A-C+ABS,60A,悬挂式',
                        unit: '只',
                        quantity: '27',
                        projectName: '安徽芜湖繁昌县10kV芜山口#360211上上滁线工程',
                        unitPrice: '343.0907',
                        totalAmount: '¥9,263.45',
                        deliveryTime: '25/08/18',
                        techId: ''
                    },
                    {
                        goodsName: '智能控制开关',
                        spec: '智能双控开关,AC220V,2A',
                        unit: '个',
                        quantity: '50',
                        projectName: '安徽芜湖繁昌县10kV芜山口#360211上上滁线工程',
                        unitPrice: '125.50',
                        totalAmount: '¥6,275.00',
                        deliveryTime: '25/08/18',
                        techId: 'TECH-005'
                    }
                ],
                'RE25000005': [
                    {
                        goodsName: '食品包装机械',
                        spec: '自动包装机械,220V,10kW',
                        unit: '台',
                        quantity: '5',
                        projectName: '豫北食品技术升级项目',
                        unitPrice: '45,000.00',
                        totalAmount: '¥225,000.00',
                        deliveryTime: '25/07/15',
                        techId: 'TECH-001'
                    },
                    {
                        goodsName: '质量检测设备',
                        spec: 'X光检测机,380V,15kW',
                        unit: '台',
                        quantity: '2',
                        projectName: '豫北食品质量保证项目',
                        unitPrice: '120,000.00',
                        totalAmount: '¥240,000.00',
                        deliveryTime: '25/07/20',
                        techId: 'TECH-002'
                    },
                    {
                        goodsName: '传感器模块',
                        spec: '温湿度传感器,DC24V,0.5W',
                        unit: '个',
                        quantity: '30',
                        projectName: '豫北食品环境监控项目',
                        unitPrice: '380.00',
                        totalAmount: '¥11,400.00',
                        deliveryTime: '25/07/25',
                        techId: 'TECH-006'
                    }
                ],
                'RE25000003': [
                    {
                        goodsName: '科技实验设备',
                        spec: '高精度分析仪,AC220V,5kW',
                        unit: '台',
                        quantity: '8',
                        projectName: '河南科技集团实验室建设项目',
                        unitPrice: '85,000.00',
                        totalAmount: '¥680,000.00',
                        deliveryTime: '25/08/10',
                        techId: 'TECH-003'
                    },
                    {
                        goodsName: '数据采集系统',
                        spec: '多通道数据采集器,24V,1kW',
                        unit: '套',
                        quantity: '3',
                        projectName: '河南科技集团数据中心项目',
                        unitPrice: '25,000.00',
                        totalAmount: '¥75,000.00',
                        deliveryTime: '25/08/15',
                        techId: 'TECH-004'
                    },
                    {
                        goodsName: '线缆连接器',
                        spec: '工业级连接器,IP67防护,250V',
                        unit: '套',
                        quantity: '15',
                        projectName: '河南科技集团配套工程项目',
                        unitPrice: '680.00',
                        totalAmount: '¥10,200.00',
                        deliveryTime: '25/08/20',
                        techId: 'TECH-007'
                    }
                ],
                'RE25000004': [
                    {
                        goodsName: '控制面板',
                        spec: '触摸屏控制面板,7寸,24V',
                        unit: '台',
                        quantity: '12',
                        projectName: '智能控制系统项目',
                        unitPrice: '2,800.00',
                        totalAmount: '¥33,600.00',
                        deliveryTime: '25/07/18',
                        techId: 'TECH-008'
                    },
                    {
                        goodsName: '变频器',
                        spec: '三相变频器,380V,5.5kW',
                        unit: '台',
                        quantity: '6',
                        projectName: '智能控制系统项目',
                        unitPrice: '4,200.00',
                        totalAmount: '¥25,200.00',
                        deliveryTime: '25/07/18',
                        techId: 'TECH-009'
                    }
                ],
                'RE25000002': [
                    {
                        goodsName: '监控设备',
                        spec: '网络摄像头,PoE供电,1080P',
                        unit: '台',
                        quantity: '20',
                        projectName: '安防监控系统项目',
                        unitPrice: '1,200.00',
                        totalAmount: '¥24,000.00',
                        deliveryTime: '25/07/12',
                        techId: 'TECH-010'
                    },
                    {
                        goodsName: '录像设备',
                        spec: '网络硬盘录像机,16路,4TB',
                        unit: '台',
                        quantity: '2',
                        projectName: '安防监控系统项目',
                        unitPrice: '3,800.00',
                        totalAmount: '¥7,600.00',
                        deliveryTime: '25/07/12',
                        techId: 'TECH-011'
                    }
                ],
                'RE25000006': [
                    {
                        goodsName: '继电器模块',
                        spec: '8路继电器模块,DC12V,10A',
                        unit: '块',
                        quantity: '25',
                        projectName: '自动化控制项目',
                        unitPrice: '280.00',
                        totalAmount: '¥7,000.00',
                        deliveryTime: '25/07/25',
                        techId: 'TECH-012'
                    }
                ],
                'RE25000007': [
                    {
                        goodsName: '电源模块',
                        spec: '开关电源,24V,10A,240W',
                        unit: '个',
                        quantity: '18',
                        projectName: '电源配套项目',
                        unitPrice: '350.00',
                        totalAmount: '¥6,300.00',
                        deliveryTime: '25/07/28',
                        techId: 'TECH-013'
                    }
                ],
                'RE25000008': [
                    {
                        goodsName: '接线端子',
                        spec: '导轨式接线端子,2.5mm²',
                        unit: '个',
                        quantity: '100',
                        projectName: '电气配线项目',
                        unitPrice: '15.00',
                        totalAmount: '¥1,500.00',
                        deliveryTime: '25/08/02',
                        techId: 'TECH-014'
                    }
                ],
                'RE25000009': [
                    {
                        goodsName: '编码器',
                        spec: '增量式编码器,1024脉冲',
                        unit: '个',
                        quantity: '8',
                        projectName: '精密测量项目',
                        unitPrice: '1,800.00',
                        totalAmount: '¥14,400.00',
                        deliveryTime: '25/08/05',
                        techId: 'TECH-015'
                    }
                ],
                'RE25000011': [
                    {
                        goodsName: '伺服电机',
                        spec: '交流伺服电机,750W,3000rpm',
                        unit: '台',
                        quantity: '4',
                        projectName: '精密运动控制项目',
                        unitPrice: '8,500.00',
                        totalAmount: '¥34,000.00',
                        deliveryTime: '25/08/08',
                        techId: 'TECH-016'
                    }
                ],
                'RE25000012': [
                    {
                        goodsName: '驱动器',
                        spec: '伺服驱动器,750W,220V',
                        unit: '台',
                        quantity: '4',
                        projectName: '精密运动控制项目',
                        unitPrice: '6,200.00',
                        totalAmount: '¥24,800.00',
                        deliveryTime: '25/08/10',
                        techId: 'TECH-017'
                    }
                ]
            };
            
            const data = salesData[orderId] || [
                {
                    goodsName: '默认产品',
                    spec: '标准规格,220V,1kW',
                    unit: '件',
                    quantity: '1',
                    projectName: '默认项目',
                    unitPrice: '1,000.00',
                    totalAmount: '¥1,000.00',
                    deliveryTime: '2025-07-01',
                    techId: 'TECH-DEFAULT'
                }
            ];
            
            return `
                <div style="overflow-x: auto;">
                    <table class="data-table" style="min-width: 2800px; width: 100%; border-collapse: collapse; font-size: 12px;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 60px;">序号</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 120px;">产品代码 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 120px;">条形码 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 150px;">产品名称 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 150px;">规格型号 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">辅助属性</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 80px;">单位 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 80px;">数量 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 80px;">库存数量</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 120px;">价格政策名称</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">单价</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">含税单价</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">金额</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 80px;">税率</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">单位折扣额</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">折扣额</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">实际含税单价</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">销项税额</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 100px;">价税合计</th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 120px;">交货日期 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 120px;">建议交货日期 <span class="required">*</span></th>
                                <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: center; color: #333; font-weight: 600; width: 150px;">备注</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map((item, index) => {
                                // 根据产品生成真实的产品代码和条形码
                                const productCodes = ['EMB001234', 'SWI001235', 'TSF001236', 'CAB001237', 'MOT001238', 'PNL001239'];
                                const barcodes = ['6901234567890', '6901234567891', '6901234567892', '6901234567893', '6901234567894', '6901234567895'];
                                const pricePolices = ['标准价格政策', '智能设备政策', '大型设备政策', '配电设备政策', '电机设备政策', '智能控制政策'];
                                const attributes = ['悬挂式', '智能型', '干式', '低压', '三相异步', '工业级'];
                                
                                const productCode = productCodes[index % productCodes.length];
                                const barcode = barcodes[index % barcodes.length];
                                const pricePolicy = pricePolices[index % pricePolices.length];
                                const attribute = attributes[index % attributes.length];
                                
                                // 计算价格相关字段
                                const unitPriceStr = item.unitPrice.replace(/,/g, '').replace('¥', '');
                                const unitPrice = parseFloat(unitPriceStr) || 100;
                                const quantity = parseInt(item.quantity) || 1;
                                const taxRate = 13; // 13%税率
                                const unitDiscount = index % 3 === 0 ? 5.00 : 0.00;
                                const discount = unitDiscount * quantity;
                                const actualUnitPrice = unitPrice - unitDiscount;
                                const taxInclusiveUnitPrice = actualUnitPrice * (1 + taxRate / 100);
                                const amount = actualUnitPrice * quantity;
                                const taxAmount = amount * taxRate / 100;
                                const totalWithTax = amount + taxAmount;
                                const stock = Math.floor(Math.random() * 100) + 50;
                                
                                const deliveryDate = '2025-08-18';
                                const suggestedDeliveryDate = '2025-08-15';
                                const remark = index % 3 === 0 ? '优先生产' : index % 3 === 1 ? '需要技术确认' : '标准产品';
                                
                                return `
                                <tr style="border-bottom: 1px solid #e8e8e8;">
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${index + 1}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${productCode}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${barcode}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px;">${item.goodsName}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px;">${item.spec}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${attribute}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${item.unit}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${item.quantity}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${stock}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px;">${pricePolicy}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${unitPrice.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${taxInclusiveUnitPrice.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${amount.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${taxRate}%</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${unitDiscount.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${discount.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${actualUnitPrice.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${taxAmount.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: right;">${totalWithTax.toFixed(2)}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${deliveryDate}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px; text-align: center;">${suggestedDeliveryDate}</td>
                                    <td style="border: 1px solid #e8e8e8; padding: 8px;">${remark}</td>
                                </tr>
                            `}).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }
        
        // 获取合同子表数据
        function getContractSubTableData(contractId) {
            const contractData = {
                'CON-2025001': [
                    {
                        projectUnit: '国网安徽省电力有限公司',
                        projectName: '安徽省电力系统智能化改造项目',
                        goodsName: '配电箱',
                        specification: '配电箱,户外,4回路',
                        quantity: '5',
                        unit: '个',
                        unitPriceExTax: '19292.50',
                        taxRate: '13',
                        itemPriceExTax: '96462.50',
                        itemPriceIncTax: '109026.47',
                        deliveryTime: '2024-06-17~2025-06-16',
                        deliveryLocation: '河南省郑州市、洛阳市等，买方指定仓库地面交货'
                    },
                    {
                        projectUnit: '国网安徽省电力有限公司',
                        projectName: '安徽省电力系统智能化改造项目',
                        goodsName: '配电箱',
                        specification: '配电箱,户外,12回路',
                        quantity: '1',
                        unit: '个',
                        unitPriceExTax: '16812.39',
                        taxRate: '13',
                        itemPriceExTax: '16812.39',
                        itemPriceIncTax: '18998.00',
                        deliveryTime: '2024-06-17~2025-06-16',
                        deliveryLocation: '河南省郑州市、洛阳市等，买方指定仓库地面交货'
                    }
                ],
                'CON-2025002': [
                    {
                        purchaseOrderCode: 'PO-2025002001',
                        materialCode: 'WL-25040005',
                        categoryName: '变压器',
                        materialDesc: 'S11-M-630/10配电变压器',
                        purchaseQty: '20台',
                        contractType: '标准合同',
                        projectCode: 'PRJ003',
                        projectName: '江苏食品技术变压器采购项目'
                    },
                    {
                        purchaseOrderCode: 'PO-2025002002',
                        materialCode: 'WL-25040006',
                        categoryName: '配电柜',
                        materialDesc: 'GCS型低压抽出式开关柜',
                        purchaseQty: '15面',
                        contractType: '标准合同',
                        projectCode: 'PRJ004',
                        projectName: '江苏食品技术配电设备项目'
                    }
                ]
            };
            
            const data = contractData[contractId] || [];
            
            return `
                <table class="data-table" style="width: 100%; border-collapse: collapse; font-size: 12px;">
                    <thead>
                        <tr style="background: white; color: #1890FF;">
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">序号</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">项目单位/收货方</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">项目名称</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">货物名称</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">规格型号</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">数量</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">单位</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">不含税单价</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">税率</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">分项价(不含税)</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">分项价(含税)</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">交货时间</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">交货地点及交货方式</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.map((item, index) => `
                            <tr>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${index + 1}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.projectUnit}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.projectName}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.goodsName}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.specification}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.quantity}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.unit}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.unitPriceExTax}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.taxRate}%</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.itemPriceExTax}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.itemPriceIncTax}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.deliveryTime}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.deliveryLocation}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }
        
        // 获取标包子表数据
        function getBidSubTableData(bidId) {
            const bidData = {
                'BID-2025001': [
                    {
                        sequenceNo: '1',
                        goodsName: '高压开关柜',
                        goodsDesc: '12kV固体绝缘环网开关设备',
                        unitPrice: '65,000.00',
                        unit: '台',
                        quantity: '10',
                        contractAmountWithTax: '650,000.00',
                        contractAmountWithoutTax: '575,221.24',
                        taxRate: '13%',
                        deliveryStartDate: '2025-07-01',
                        deliveryEndDate: '2025-07-30',
                        deliveryLocation: '安徽省合肥市包河区工业园区',
                        deliveryMethod: '工厂交货'
                    },
                    {
                        sequenceNo: '2',
                        goodsName: '配电变压器',
                        goodsDesc: 'S11-M-630/10配电变压器',
                        unitPrice: '28,500.00',
                        unit: '台',
                        quantity: '20',
                        contractAmountWithTax: '570,000.00',
                        contractAmountWithoutTax: '504,424.78',
                        taxRate: '13%',
                        deliveryStartDate: '2025-07-15',
                        deliveryEndDate: '2025-08-15',
                        deliveryLocation: '安徽省合肥市包河区工业园区',
                        deliveryMethod: '送货上门'
                    },
                    {
                        sequenceNo: '3',
                        goodsName: '低压配电柜',
                        goodsDesc: 'GCS型低压抽出式开关柜',
                        unitPrice: '12,800.00',
                        unit: '面',
                        quantity: '35',
                        contractAmountWithTax: '448,000.00',
                        contractAmountWithoutTax: '396,460.18',
                        taxRate: '13%',
                        deliveryStartDate: '2025-08-01',
                        deliveryEndDate: '2025-08-30',
                        deliveryLocation: '安徽省合肥市包河区工业园区',
                        deliveryMethod: '工厂交货'
                    }
                ],
                'ECP-2025002': [
                    {
                        sequenceNo: '1',
                        goodsName: '电力变压器',
                        goodsDesc: 'S11-M-1000/10电力变压器',
                        unitPrice: '85,000.00',
                        unit: '台',
                        quantity: '15',
                        contractAmount: '1,128,318.58',
                        taxRate: '13',
                        deliveryDate: '2025-08-20',
                        deliveryLocation: '江苏省南京市建邺区工业园',
                        deliveryMethod: '送货上门'
                    },
                    {
                        sequenceNo: '2',
                        goodsName: '高压配电柜',
                        goodsDesc: 'KYN28-12高压配电柜',
                        unitPrice: '45,000.00',
                        unit: '面',
                        quantity: '25',
                        contractAmount: '995,575.22',
                        taxRate: '13',
                        deliveryDate: '2025-09-01',
                        deliveryLocation: '江苏省南京市建邺区工业园',
                        deliveryMethod: '送货上门'
                    }
                ],
                'ECP-2025003': [
                    {
                        sequenceNo: '1',
                        goodsName: '配电箱',
                        goodsDesc: 'GGD型低压配电箱',
                        unitPrice: '12,000.00',
                        unit: '台',
                        quantity: '50',
                        contractAmount: '530,973.45',
                        taxRate: '13',
                        deliveryDate: '2025-07-25',
                        deliveryLocation: '河南省郑州市高新区科技园',
                        deliveryMethod: '工厂交货'
                    },
                    {
                        sequenceNo: '2',
                        goodsName: '控制柜',
                        goodsDesc: 'PLC控制柜',
                        unitPrice: '18,000.00',
                        unit: '台',
                        quantity: '25',
                        contractAmount: '398,230.09',
                        taxRate: '13',
                        deliveryDate: '2025-08-05',
                        deliveryLocation: '河南省郑州市高新区科技园',
                        deliveryMethod: '工厂交货'
                    }
                ],
                'BID-2025002': [
                    {
                        sequenceNo: '1',
                        goodsName: '变压器控制器',
                        goodsDesc: '智能变压器监控设备',
                        unitPrice: '85,000.00',
                        unit: '套',
                        quantity: '15',
                        contractAmountWithTax: '1,275,000.00',
                        contractAmountWithoutTax: '1,128,318.58',
                        taxRate: '13%',
                        deliveryStartDate: '2025-07-20',
                        deliveryEndDate: '2025-08-20',
                        deliveryLocation: '江苏省南京市建邺区科技园',
                        deliveryMethod: '送货上门'
                    },
                    {
                        sequenceNo: '2',
                        goodsName: '变压器油',
                        goodsDesc: '25#变压器绝缘油',
                        unitPrice: '8,500.00',
                        unit: '吨',
                        quantity: '127',
                        contractAmountWithTax: '1,079,500.00',
                        contractAmountWithoutTax: '955,309.73',
                        taxRate: '13%',
                        deliveryStartDate: '2025-08-01',
                        deliveryEndDate: '2025-08-31',
                        deliveryLocation: '江苏省南京市建邺区科技园',
                        deliveryMethod: '送货上门'
                    }
                ],
                'BID-2025003': [
                    {
                        sequenceNo: '1',
                        goodsName: '配电控制柜',
                        goodsDesc: '低压智能配电控制系统',
                        unitPrice: '28,000.00',
                        unit: '套',
                        quantity: '35',
                        contractAmountWithTax: '980,000.00',
                        contractAmountWithoutTax: '867,256.64',
                        taxRate: '13%',
                        deliveryStartDate: '2025-08-10',
                        deliveryEndDate: '2025-09-10',
                        deliveryLocation: '河南省洛阳市高新区',
                        deliveryMethod: '工厂交货'
                    }
                ]
            };
            
            const data = bidData[bidId] || [];
            
            return `
                <table class="data-table" style="width: 100%; border-collapse: collapse; font-size: 12px;">
                    <thead>
                        <tr style="background: white; color: #1890FF;">
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">序号</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">货物名称</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">货物描述</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">单价(含税)人民币元</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">单位</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">数量</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">合同价款(含税)人民币元</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">合同价款(不含税)人民币元</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">税率</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">交货期开始</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">交货期结束</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">交货地点</th>
                            <th style="border: 1px solid #d9d9d9; padding: 8px; text-align: left; color: #1890FF;">交货方式</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.map((item, index) => `
                            <tr>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.sequenceNo}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.goodsName}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.goodsDesc}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">¥${item.unitPrice}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.unit}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.quantity}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">¥${item.contractAmountWithTax || item.contractAmount}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">¥${item.contractAmountWithoutTax || item.contractAmount}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.taxRate}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.deliveryStartDate || item.deliveryDate}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.deliveryEndDate || item.deliveryDate}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.deliveryLocation}</td>
                                <td style="border: 1px solid #d9d9d9; padding: 8px;">${item.deliveryMethod}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }
        
        // 左侧菜单展开收起功能
        function toggleSubmenu(event) {
            event.preventDefault();
            event.stopPropagation();
            
            const link = event.currentTarget;
            const submenu = link.nextElementSibling;
            const toggle = link.querySelector('.nav-toggle');
            
            if (submenu && submenu.classList.contains('nav-submenu')) {
                if (submenu.classList.contains('expanded')) {
                    submenu.classList.remove('expanded');
                    toggle.classList.remove('expanded');
                } else {
                    submenu.classList.add('expanded');
                    toggle.classList.add('expanded');
                }
            }
            
            return false;
        }
        

        
        // 销售订单上传客户满意度调查表功能
        function showSalesUploadSurvey(salesOrderId) {
            const modal = document.getElementById('sales-upload-survey-modal');
            const form = document.getElementById('sales-upload-survey-form');
            const orderNoInput = form.querySelector('input[name="orderNo"]');
            
            // 清空表单
            form.reset();
            
            // 设置订单编号为只读并填入当前订单ID
            orderNoInput.value = salesOrderId;
            
            // 清空文件列表
            document.getElementById('sales-file-list').innerHTML = '';
            
            // 显示弹窗
            modal.style.display = 'block';
        }
        
        // 销售订单文件上传处理
        document.getElementById('sales-survey-file').addEventListener('change', function(e) {
            const files = e.target.files;
            const fileList = document.getElementById('sales-file-list');
            
            // 清空之前的文件列表
            fileList.innerHTML = '';
            
            if (files.length > 0) {
                for (let file of files) {
                    const fileItem = document.createElement('div');
                    fileItem.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 8px; border: 1px solid #e5e7eb; border-radius: 4px; margin-bottom: 5px; font-size: 14px;';
                    
                    fileItem.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: white;">📎</span>
                            <span>${file.name}</span>
                            <span style="color: #6b7280; font-size: 12px;">(${(file.size / 1024 / 1024).toFixed(2)}MB)</span>
                        </div>
                        <button type="button" class="btn btn-secondary" style="padding: 2px 6px; font-size: 12px;" onclick="removeSalesFile(this)">删除</button>
                    `;
                    
                    fileList.appendChild(fileItem);
                }
            }
        });
        
        function removeSalesFile(button) {
            button.closest('div').remove();
            // 重置文件输入框
            document.getElementById('sales-survey-file').value = '';
        }
        
        // 合同管理文件上传处理
        document.getElementById('contract-survey-file').addEventListener('change', function(e) {
            const files = e.target.files;
            const fileList = document.getElementById('contract-file-list');
            
            // 清空之前的文件列表
            fileList.innerHTML = '';
            
            if (files.length > 0) {
                for (let file of files) {
                    const fileItem = document.createElement('div');
                    fileItem.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 8px; border: 1px solid #e5e7eb; border-radius: 4px; margin-bottom: 5px; font-size: 14px;';
                    
                    fileItem.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: white;">📎</span>
                            <span>${file.name}</span>
                            <span style="color: #6b7280; font-size: 12px;">(${(file.size / 1024 / 1024).toFixed(2)}MB)</span>
                        </div>
                        <button type="button" class="btn btn-secondary" style="padding: 2px 6px; font-size: 12px;" onclick="removeContractFile(this)">删除</button>
                    `;
                    
                    fileList.appendChild(fileItem);
                }
            }
        });
        
        function removeContractFile(button) {
            button.closest('div').remove();
            // 重置文件输入框
            document.getElementById('contract-survey-file').value = '';
        }
        
        // 销售订单调查表表单提交
        document.getElementById('sales-upload-survey-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {
                contractNo: formData.get('contractNo'),
                orderNo: formData.get('orderNo'),
                storageLocation: formData.get('storageLocation'),
                attachments: []
            };
            
            // 获取文件信息
            const files = document.getElementById('sales-survey-file').files;
            for (let file of files) {
                data.attachments.push({
                    name: file.name,
                    size: file.size,
                    type: file.type
                });
            }
            
            console.log('销售订单调查表数据:', data);
            
            // 模拟保存成功
            alert('客户满意度调查表上传成功！');
            closeModal('sales-upload-survey-modal');
            
            // 实际项目中这里会调用保存API
        });
        
        // 合同管理调查表表单提交
        document.getElementById('contract-upload-survey-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {
                contractNo: formData.get('contractNo'),
                orderNo: formData.get('orderNo'),
                storageLocation: formData.get('storageLocation'),
                attachments: []
            };
            
            // 获取文件信息
            const files = document.getElementById('contract-survey-file').files;
            for (let file of files) {
                data.attachments.push({
                    name: file.name,
                    size: file.size,
                    type: file.type
                });
            }
            
            console.log('合同管理调查表数据:', data);
            
            // 模拟保存成功
            alert('客户满意度调查表保存成功！');
            closeModal('contract-upload-survey-modal');
            
            // 实际项目中这里会调用保存API
        });
        
        function downloadAttachment(fileName) {
            alert(`下载文件：${fileName}`);
        }
        
        function deleteAttachment(fileName) {
            if (confirm(`确定要删除文件：${fileName}？`)) {
                alert('文件删除成功！');
            }
        }
        
        function loadSurveyData(surveyId) {
            // 模拟加载调查编辑数据
            const form = document.getElementById('survey-form');
            const mockData = {
                'SURVEY-2025001': {
                    contractNo: 'CON-2025001',
                    orderNo: 'XS-2505010',
                    storageLocation: '档案室A区-03层-电力设备专柜'
                },
                'SURVEY-2025002': {
                    contractNo: 'CON-2025002',
                    orderNo: 'XS-2505005',
                    storageLocation: '档案室B区-02层-变压器设备专区'
                },
                'SURVEY-2025003': {
                    contractNo: 'CON-2025001',
                    orderNo: 'RE25C0010',
                    storageLocation: '档案室C区-01层-配电专用库房'
                }
            };
            
            const data = mockData[surveyId];
            if (data) {
                Object.keys(data).forEach(key => {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input) {
                        input.value = data[key];
                    }
                });
            }
        }
        
        // 文件选择处理
        document.getElementById('survey-file').addEventListener('change', function(e) {
            const files = e.target.files;
            const fileList = document.getElementById('file-list');
            
            if (files.length > 0) {
                const fileItems = Array.from(files).map(file => {
                    const fileSize = (file.size / 1024 / 1024).toFixed(2);
                    return `
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #e5e7eb;">
                            <span style="font-size: 12px;">${file.name} (${fileSize}MB)</span>
                            <button type="button" class="btn btn-secondary" style="padding: 2px 6px; font-size: 10px;">移除</button>
                        </div>
                    `;
                }).join('');
                
                fileList.innerHTML = fileItems;
            } else {
                fileList.innerHTML = '';
            }
        });
        
        // 客户满意度调查表单提交处理
        document.getElementById('survey-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                if (key !== 'attachment') {
                    data[key] = value;
                }
            }
            
            // 处理文件
            const files = document.getElementById('survey-file').files;
            if (files.length > 0) {
                data.attachments = Array.from(files).map(file => file.name);
            }
            
                    console.log('提交的调查数据：', data);
        alert('客户满意度调查保存成功！');
        closeModal('survey-form-modal');
    });

    // 技术图纸相关功能
    function showDrawingPreview(orderNo) {
        // 根据订单号显示对应的技术图纸
        const drawingData = getDrawingData(orderNo);
        
        // 更新模态框标题
        document.getElementById('drawing-preview-title').textContent = `技术图纸 - ${orderNo}`;
        document.getElementById('drawing-info').textContent = `图纸名称：${drawingData.fileName}`;
        
        // 更新PDF预览内容
        updatePdfPreviewContent(drawingData);
        
        // 显示模态框
        document.getElementById('drawing-preview-modal').style.display = 'block';
    }

    // 收货确认单相关功能
    function showReceiptPreview(orderNo) {
        // 根据订单号显示对应的收货确认单
        const receiptData = getReceiptData(orderNo);
        
        // 更新模态框标题
        document.getElementById('drawing-preview-title').textContent = `收货确认单 - ${orderNo}`;
        document.getElementById('drawing-info').textContent = `确认单名称：${receiptData.fileName}`;
        
        // 更新PDF预览内容
        updateReceiptPreviewContent(receiptData);
        
        // 显示模态框
        document.getElementById('drawing-preview-modal').style.display = 'block';
    }

    function getDrawingData(orderNo) {
        // 模拟不同订单的图纸数据
        const drawingDatabase = {
            'XS-2505010': {
                fileName: '江苏饮料项目技术设计图.pdf',
                fileSize: '2.5 MB',
                createTime: '2025-05-20 14:30',
                status: '已审核',
                pages: [
                    '设备布局图 (第1-3页)',
                    '电气系统图 (第4-6页)',
                    '管道流程图 (第7-9页)',
                    '安装说明图 (第10-12页)',
                    '技术参数表 (第13-15页)'
                ]
            },
            'XS-2505005': {
                fileName: '豫北食品设备图纸.pdf',
                fileSize: '3.1 MB',
                createTime: '2025-05-25 09:15',
                status: '待审核',
                pages: [
                    '总体布局图 (第1-2页)',
                    '设备连接图 (第3-5页)',
                    '控制系统图 (第6-8页)',
                    '安全防护图 (第9-10页)'
                ]
            },
            'XS-2505003': {
                fileName: '科技设备采购技术图.pdf',
                fileSize: '4.2 MB',
                createTime: '2025-05-28 16:20',
                status: '未审核',
                pages: [
                    '设备外观图 (第1-2页)',
                    '内部结构图 (第3-6页)',
                    '接口定义图 (第7-9页)',
                    '安装指导图 (第10-12页)',
                    '维护保养图 (第13-14页)'
                ]
            }
        };
        
        return drawingDatabase[orderNo] || {
            fileName: '预览.pdf',
            fileSize: '2.0 MB',
            createTime: '2025-05-20 10:00',
            status: '已审核',
            pages: ['预览 (第1页)']
        };
    }

    function getReceiptData(orderNo) {
        // 模拟不同订单的收货确认单数据
        const receiptDatabase = {
            'XS-2505010': {
                fileName: '江苏饮料项目收货确认单.pdf',
                fileSize: '1.8 MB',
                createTime: '2025-06-15 10:30',
                status: '已确认',
                pages: [
                    '收货确认单封面 (第1页)',
                    '设备清单 (第2-3页)',
                    '质量检验报告 (第4-5页)',
                    '签收确认页 (第6页)'
                ]
            },
            'XS-2505005': {
                fileName: '豫北食品项目收货确认单.pdf',
                fileSize: '2.1 MB',
                createTime: '2025-06-18 14:20',
                status: '待确认',
                pages: [
                    '收货确认单封面 (第1页)',
                    '设备清单 (第2-4页)',
                    '质量检验报告 (第5-6页)',
                    '签收确认页 (第7页)'
                ]
            },
            'XS-2505003': {
                fileName: '科技设备项目收货确认单.pdf',
                fileSize: '1.5 MB',
                createTime: '2025-06-20 09:15',
                status: '已确认',
                pages: [
                    '收货确认单封面 (第1页)',
                    '设备清单 (第2页)',
                    '质量检验报告 (第3页)',
                    '签收确认页 (第4页)'
                ]
            }
        };
        
        return receiptDatabase[orderNo] || {
            fileName: '收货确认单预览.pdf',
            fileSize: '1.5 MB',
            createTime: '2025-06-15 10:00',
            status: '已确认',
            pages: ['收货确认单 (第1页)']
        };
    }

    function updatePdfPreviewContent(drawingData) {
        const container = document.getElementById('pdf-preview-container');
        
        container.innerHTML = `
            <div style="text-align: center; padding: 40px;">
                                            <div style="font-size: 48px; color: white; margin-bottom: 20px;">📄</div>
                <div style="font-size: 16px; color: #666; margin-bottom: 10px;">PDF文档预览</div>
                <div style="font-size: 14px; color: #999; line-height: 1.6;">
                    <p><strong>文档名称：</strong>${drawingData.fileName}</p>
                    <p><strong>文档大小：</strong>${drawingData.fileSize}</p>
                    <p><strong>创建时间：</strong>${drawingData.createTime}</p>
                    <p><strong>文档状态：</strong>${drawingData.status}</p>
                </div>
                <div style="margin-top: 20px; padding: 20px; background: white; border: 1px dashed #ddd; border-radius: 4px;">
                    <div style="color: #666; font-size: 14px;">
                        <p><span style="color: white;">📋</span> <strong>图纸内容概要：</strong></p>
                        <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
                            ${drawingData.pages.map(page => `<li>${page}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            </div>
        `;
    }

    function updateReceiptPreviewContent(receiptData) {
        const container = document.getElementById('pdf-preview-container');
        
        container.innerHTML = `
            <div style="text-align: center; padding: 40px;">
                <div style="font-size: 48px; color: white; margin-bottom: 20px;">📋</div>
                <div style="font-size: 16px; color: #666; margin-bottom: 10px;">收货确认单预览</div>
                <div style="font-size: 14px; color: #999; line-height: 1.6;">
                    <p><strong>确认单名称：</strong>${receiptData.fileName}</p>
                    <p><strong>文档大小：</strong>${receiptData.fileSize}</p>
                    <p><strong>创建时间：</strong>${receiptData.createTime}</p>
                    <p><strong>确认状态：</strong>${receiptData.status}</p>
                </div>
                <div style="margin-top: 20px; padding: 20px; background: white; border: 1px dashed #ddd; border-radius: 4px;">
                    <div style="color: #666; font-size: 14px;">
                        <p><span style="color: white;">📋</span> <strong>确认单内容概要：</strong></p>
                        <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
                            ${receiptData.pages.map(page => `<li>${page}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            </div>
        `;
    }

    function downloadDrawing() {
        alert('开始下载图纸文件...');
        // 实际项目中这里会触发文件下载
        console.log('下载图纸文件');
    }

    function showAllDrawings() {
        // 关闭当前预览模态框
        closeModal('drawing-preview-modal');
        // 显示所有图纸列表模态框
        document.getElementById('all-drawings-modal').style.display = 'block';
    }

    function previewSingleDrawing(fileName) {
        alert(`预览图纸：${fileName}`);
        // 实际项目中会在当前窗口或新窗口显示具体的PDF文件
        console.log('预览单个图纸：', fileName);
    }

    function downloadSingleDrawing(fileName) {
        alert(`下载图纸：${fileName}`);
        // 实际项目中会触发具体文件的下载
        console.log('下载单个图纸：', fileName);
    }

    // 操作下拉菜单功能
    function toggleActionDropdown(button) {
        const dropdown = button.parentElement;
        const content = dropdown.querySelector('.action-dropdown-content');
        
        // 关闭所有其他下拉菜单
        document.querySelectorAll('.action-dropdown-content.show').forEach(item => {
            if (item !== content) {
                item.classList.remove('show');
                // 如果菜单被移动到body，也要隐藏
                const bodyDropdown = document.querySelector('.body-dropdown-menu');
                if (bodyDropdown) {
                    bodyDropdown.remove();
                }
            }
        });
        
        // 切换当前下拉菜单
        if (content.classList.contains('show')) {
            content.classList.remove('show');
            // 移除body中的下拉菜单
            const bodyDropdown = document.querySelector('.body-dropdown-menu');
            if (bodyDropdown) {
                bodyDropdown.remove();
            }
        } else {
            // 创建一个新的下拉菜单并添加到body
            const bodyDropdown = document.createElement('div');
            bodyDropdown.className = 'body-dropdown-menu';
            bodyDropdown.innerHTML = content.innerHTML;
            
            // 计算按钮位置并设置下拉菜单位置
            const rect = button.getBoundingClientRect();
            const contentHeight = 120; // 估算下拉菜单高度
            
            // 设置样式
            bodyDropdown.style.cssText = `
                position: fixed;
                background: white;
                border: 1px solid #d9d9d9;
                border-radius: 4px;
                box-shadow: 0 8px 24px rgba(0,0,0,0.2);
                z-index: 2147483647;
                min-width: 120px;
                display: block;
            `;
            
            // 判断是否有足够空间显示在下方，如果没有则显示在上方
            if (rect.bottom + contentHeight > window.innerHeight) {
                // 显示在按钮上方
                bodyDropdown.style.top = (rect.top - contentHeight - 2) + 'px';
            } else {
                // 显示在按钮下方
                bodyDropdown.style.top = (rect.bottom + 2) + 'px';
            }
            
            // 设置水平位置，确保不超出视窗右边界
            const contentWidth = 120;
            if (rect.right - contentWidth < 0) {
                bodyDropdown.style.left = rect.left + 'px';
            } else {
                bodyDropdown.style.left = (rect.right - contentWidth) + 'px';
            }
            
            // 添加到body
            document.body.appendChild(bodyDropdown);
            
            // 标记原始菜单为显示状态
            content.classList.add('show');
        }
    }

    // 点击页面其他地方关闭下拉菜单
    document.addEventListener('click', function(event) {
        if (!event.target.closest('.action-dropdown') && !event.target.closest('.body-dropdown-menu')) {
            document.querySelectorAll('.action-dropdown-content.show').forEach(item => {
                item.classList.remove('show');
            });
            // 移除body中的下拉菜单
            const bodyDropdown = document.querySelector('.body-dropdown-menu');
            if (bodyDropdown) {
                bodyDropdown.remove();
            }
        }
    });

    // 文档管理功能
    function showUploadDocumentModal() {
        const modal = document.getElementById('upload-document-modal');
        const form = document.getElementById('upload-document-form');
        
        // 清空表单
        form.reset();
        document.getElementById('upload-file-list').innerHTML = '';
        
        // 显示弹窗
        modal.style.display = 'block';
    }
    
    function previewDocument(fileName) {
        alert(`预览文档：${fileName}`);
        // 实际项目中会在新窗口或当前窗口显示文档预览
        console.log('预览文档：', fileName);
    }
    
    function downloadDocument(fileName) {
        alert(`下载文档：${fileName}`);
        // 实际项目中会触发文件下载
        console.log('下载文档：', fileName);
    }
    
    function deleteDocument(fileName) {
        if (confirm(`确定要删除文档"${fileName}"吗？`)) {
            // 从列表中移除文档项
            const documentItems = document.getElementById('document-items');
            const items = documentItems.children;
            
            for (let i = 0; i < items.length; i++) {
                const item = items[i];
                const nameElement = item.querySelector('span:nth-child(2)');
                if (nameElement && nameElement.textContent === fileName) {
                    item.remove();
                    break;
                }
            }
            
            // 如果没有文档了，显示"暂无文档"
            if (documentItems.children.length === 0) {
                document.getElementById('no-documents').style.display = 'block';
            }
            
            alert('文档删除成功！');
        }
    }
    
    // 文件选择处理
    document.getElementById('document-file').addEventListener('change', function(e) {
        const files = e.target.files;
        const fileList = document.getElementById('upload-file-list');
        
        // 清空之前的文件列表
        fileList.innerHTML = '';
        
        if (files.length > 0) {
            for (let file of files) {
                const fileItem = document.createElement('div');
                fileItem.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 8px; border: 1px solid #e5e7eb; border-radius: 4px; margin-bottom: 5px; font-size: 14px;';
                
                fileItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="color: white;">📎</span>
                        <span>${file.name}</span>
                        <span style="color: #6b7280; font-size: 12px;">(${(file.size / 1024 / 1024).toFixed(2)}MB)</span>
                    </div>
                    <button type="button" class="btn btn-secondary" style="padding: 2px 6px; font-size: 12px;" onclick="removeUploadFile(this)">删除</button>
                `;
                
                fileList.appendChild(fileItem);
            }
        }
    });
    
    function removeUploadFile(button) {
        button.closest('div').remove();
        // 重置文件输入框
        document.getElementById('document-file').value = '';
    }
    
    // 文档上传表单提交
    document.getElementById('upload-document-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const documentName = formData.get('documentName');
        const documentDescription = formData.get('documentDescription');
        const files = document.getElementById('document-file').files;
        
        if (files.length === 0) {
            alert('请选择要上传的文件！');
            return;
        }
        
        // 模拟上传成功后添加到文档列表
        const documentItems = document.getElementById('document-items');
        const noDocuments = document.getElementById('no-documents');
        
        // 隐藏"暂无文档"提示
        noDocuments.style.display = 'none';
        
        // 为每个文件创建列表项
        for (let file of files) {
            const newDocumentItem = document.createElement('div');
            newDocumentItem.style.cssText = 'padding: 12px; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center;';
            
            const fileIcon = file.type.includes('pdf') ? '📄' : 
                           file.type.includes('excel') || file.type.includes('sheet') ? '📊' :
                           file.type.includes('word') ? '📝' :
                           file.type.includes('image') ? '🖼️' : '📎';
            
            const currentTime = new Date().toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            }).replace(/\//g, '-');
            
            newDocumentItem.innerHTML = `
                <div style="flex: 1; display: flex; align-items: center;">
                    <span style="color: white; margin-right: 8px;">${fileIcon}</span>
                    <span>${file.name}</span>
                </div>
                <div style="width: 100px; color: #666;">${(file.size / 1024 / 1024).toFixed(2)}MB</div>
                <div style="width: 120px; color: #666;">${currentTime}</div>
                <div style="width: 150px; text-align: center;">
                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px;" onclick="previewDocument('${file.name}')">预览</button>
                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px;" onclick="downloadDocument('${file.name}')">下载</button>
                    <button class="btn btn-secondary" style="padding: 4px 8px; margin: 0 2px; color: #ff4d4f;" onclick="deleteDocument('${file.name}')">删除</button>
                </div>
            `;
            
            documentItems.appendChild(newDocumentItem);
        }
        
        console.log('文档上传数据:', {
            name: documentName,
            description: documentDescription,
            files: Array.from(files).map(file => ({ name: file.name, size: file.size, type: file.type }))
        });
        
        alert('文档上传成功！');
        closeModal('upload-document-modal');
    });

    // 点击模态框外部关闭
    window.onclick = function(event) {
        const modals = document.querySelectorAll('.modal');
        modals.forEach(modal => {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });
    }

    // ========== 分页功能实现 ==========
    
    // 分页数据对象
    const paginationData = {
        bid: { currentPage: 1, pageSize: 10, totalCount: 3 },
        contract: { currentPage: 1, pageSize: 10, totalCount: 2 },
        'unconfirmed-contact': { currentPage: 1, pageSize: 10, totalCount: 3 },
        sales: { currentPage: 1, pageSize: 10, totalCount: 3 },
        order: { currentPage: 1, pageSize: 10, totalCount: 13 },
        survey: { currentPage: 1, pageSize: 10, totalCount: 3 },
        delivery: { currentPage: 1, pageSize: 10, totalCount: 3 },
        deliveryDetail: { currentPage: 1, pageSize: 10, totalCount: 1 },
        'aftersale-apply': { currentPage: 1, pageSize: 10, totalCount: 5 },
        'aftersale-order': { currentPage: 1, pageSize: 10, totalCount: 7 },
        'aftersale-dispatch': { currentPage: 1, pageSize: 10, totalCount: 6 },
        'aftersale-delivery': { currentPage: 1, pageSize: 10, totalCount: 4 },
        'aftersale-report': { currentPage: 1, pageSize: 10, totalCount: 8 }
    };

    // 通用分页函数
    function updatePagination(module) {
        const data = paginationData[module];
        const totalPages = Math.ceil(data.totalCount / data.pageSize);
        data.totalPages = totalPages;

        // 更新页面信息
        const currentPageSpan = document.getElementById(`${module}-current-page`);
        const totalPagesSpan = document.getElementById(`${module}-total-pages`);
        const totalCountSpan = document.getElementById(`${module}-total-count`);
        const jumpInput = document.getElementById(`${module}-jump-input`);

        if (currentPageSpan) currentPageSpan.textContent = data.currentPage;
        if (totalPagesSpan) totalPagesSpan.textContent = totalPages;
        if (totalCountSpan) totalCountSpan.textContent = data.totalCount;
        if (jumpInput) jumpInput.max = totalPages;

        // 更新按钮状态
        updatePaginationButtons(module, data.currentPage, totalPages);
        
        // 更新页码按钮
        updatePageNumbers(module, data.currentPage, totalPages);
    }

    function updatePaginationButtons(module, currentPage, totalPages) {
        const firstBtn = document.getElementById(`${module}-first-btn`);
        const prevBtn = document.getElementById(`${module}-prev-btn`);
        const nextBtn = document.getElementById(`${module}-next-btn`);
        const lastBtn = document.getElementById(`${module}-last-btn`);

        if (firstBtn) {
            firstBtn.disabled = currentPage === 1;
            firstBtn.className = currentPage === 1 ? 'pagination-btn disabled' : 'pagination-btn';
        }
        if (prevBtn) {
            prevBtn.disabled = currentPage === 1;
            prevBtn.className = currentPage === 1 ? 'pagination-btn disabled' : 'pagination-btn';
        }
        if (nextBtn) {
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.className = currentPage === totalPages ? 'pagination-btn disabled' : 'pagination-btn';
        }
        if (lastBtn) {
            lastBtn.disabled = currentPage === totalPages;
            lastBtn.className = currentPage === totalPages ? 'pagination-btn disabled' : 'pagination-btn';
        }
    }

    function updatePageNumbers(module, currentPage, totalPages) {
        const pageNumbersDiv = document.getElementById(`${module}-page-numbers`);
        if (!pageNumbersDiv) return;

        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, startPage + 4);
        
        if (endPage - startPage < 4) {
            startPage = Math.max(1, endPage - 4);
        }

        let html = '';
        for (let i = startPage; i <= endPage; i++) {
            const isActive = i === currentPage;
            html += `<button class="pagination-btn ${isActive ? 'active' : ''}" onclick="goto${module.charAt(0).toUpperCase() + module.slice(1)}Page(${i})">${i}</button>`;
        }
        pageNumbersDiv.innerHTML = html;
    }

    // 标包管理分页函数
    function changeBidPageSize() {
        const pageSize = parseInt(document.getElementById('bid-page-size').value);
        paginationData.bid.pageSize = pageSize;
        paginationData.bid.currentPage = 1;
        updatePagination('bid');
    }

    function gotoBidPage(page) {
        if (page < 1 || page > paginationData.bid.totalPages) return;
        paginationData.bid.currentPage = page;
        updatePagination('bid');
    }

    // 合同管理分页函数
    function changeContractPageSize() {
        const pageSize = parseInt(document.getElementById('contract-page-size').value);
        paginationData.contract.pageSize = pageSize;
        paginationData.contract.currentPage = 1;
        updatePagination('contract');
    }

    function gotoContractPage(page) {
        if (page < 1 || page > paginationData.contract.totalPages) return;
        paginationData.contract.currentPage = page;
        updatePagination('contract');
    }

    function getCurrentContractPage() { return paginationData.contract.currentPage; }
    function getTotalContractPages() { return paginationData.contract.totalPages; }

    function jumpToContractPage() {
        const page = parseInt(document.getElementById('contract-jump-input').value);
        if (page && page >= 1 && page <= paginationData.contract.totalPages) {
            gotoContractPage(page);
        }
    }

    // 未确认联系人分页函数
    function changeUnconfirmedContactPageSize() {
        const pageSize = parseInt(document.getElementById('unconfirmed-contact-page-size').value);
        paginationData['unconfirmed-contact'].pageSize = pageSize;
        paginationData['unconfirmed-contact'].currentPage = 1;
        updatePagination('unconfirmed-contact');
    }

    function gotoUnconfirmedContactPage(page) {
        if (page < 1 || page > paginationData['unconfirmed-contact'].totalPages) return;
        paginationData['unconfirmed-contact'].currentPage = page;
        updatePagination('unconfirmed-contact');
    }

    function getCurrentUnconfirmedContactPage() { return paginationData['unconfirmed-contact'].currentPage; }
    function getTotalUnconfirmedContactPages() { return paginationData['unconfirmed-contact'].totalPages; }

    function jumpToUnconfirmedContactPage() {
        const page = parseInt(document.getElementById('unconfirmed-contact-jump-input').value);
        if (page && page >= 1 && page <= paginationData['unconfirmed-contact'].totalPages) {
            gotoUnconfirmedContactPage(page);
        }
    }

    // 销售订单分页函数
    function changeSalesPageSize() {
        const pageSize = parseInt(document.getElementById('sales-page-size').value);
        paginationData.sales.pageSize = pageSize;
        paginationData.sales.currentPage = 1;
        updatePagination('sales');
    }

    function gotoSalesPage(page) {
        if (page < 1 || page > paginationData.sales.totalPages) return;
        paginationData.sales.currentPage = page;
        updatePagination('sales');
    }

    function getCurrentSalesPage() { return paginationData.sales.currentPage; }
    function getTotalSalesPages() { return paginationData.sales.totalPages; }

    function jumpToSalesPage() {
        const page = parseInt(document.getElementById('sales-jump-input').value);
        if (page && page >= 1 && page <= paginationData.sales.totalPages) {
            gotoSalesPage(page);
        }
    }

    // 订单查询分页函数
    function changeOrderPageSize() {
        const pageSize = parseInt(document.getElementById('order-page-size').value);
        paginationData.order.pageSize = pageSize;
        paginationData.order.currentPage = 1;
        updatePagination('order');
    }

    function gotoOrderPage(page) {
        if (page < 1 || page > paginationData.order.totalPages) return;
        paginationData.order.currentPage = page;
        updatePagination('order');
    }

    function getCurrentOrderPage() { return paginationData.order.currentPage; }
    function getTotalOrderPages() { return paginationData.order.totalPages; }

    function jumpToOrderPage() {
        const page = parseInt(document.getElementById('order-jump-input').value);
        if (page && page >= 1 && page <= paginationData.order.totalPages) {
            gotoOrderPage(page);
        }
    }

    // 客户满意度调查分页函数
    function changeSurveyPageSize() {
        const pageSize = parseInt(document.getElementById('survey-page-size').value);
        paginationData.survey.pageSize = pageSize;
        paginationData.survey.currentPage = 1;
        updatePagination('survey');
    }

    function gotoSurveyPage(page) {
        if (page < 1 || page > paginationData.survey.totalPages) return;
        paginationData.survey.currentPage = page;
        updatePagination('survey');
    }

    function getCurrentSurveyPage() { return paginationData.survey.currentPage; }
    function getTotalSurveyPages() { return paginationData.survey.totalPages; }

    function jumpToSurveyPage() {
        const page = parseInt(document.getElementById('survey-jump-input').value);
        if (page && page >= 1 && page <= paginationData.survey.totalPages) {
            gotoSurveyPage(page);
        }
    }

    // 发货记录分页函数
    function changeDeliveryPageSize() {
        const pageSize = parseInt(document.getElementById('delivery-page-size').value);
        paginationData.delivery.pageSize = pageSize;
        paginationData.delivery.currentPage = 1;
        updatePagination('delivery');
    }

    function gotoDeliveryPage(page) {
        if (page < 1 || page > paginationData.delivery.totalPages) return;
        paginationData.delivery.currentPage = page;
        updatePagination('delivery');
    }

    function getCurrentDeliveryPage() { return paginationData.delivery.currentPage; }
    function getTotalDeliveryPages() { return paginationData.delivery.totalPages; }

    function jumpToDeliveryPage() {
        const page = parseInt(document.getElementById('delivery-jump-input').value);
        if (page && page >= 1 && page <= paginationData.delivery.totalPages) {
            gotoDeliveryPage(page);
        }
    }

    // 发货明细分页函数
    function changeDeliveryDetailPageSize() {
        const pageSize = parseInt(document.getElementById('delivery-detail-page-size').value);
        paginationData.deliveryDetail.pageSize = pageSize;
        paginationData.deliveryDetail.currentPage = 1;
        updatePagination('deliveryDetail');
    }

    function gotoDeliveryDetailPage(page) {
        if (page < 1 || page > paginationData.deliveryDetail.totalPages) return;
        paginationData.deliveryDetail.currentPage = page;
        updatePagination('deliveryDetail');
    }

    function getCurrentDeliveryDetailPage() { return paginationData.deliveryDetail.currentPage; }
    function getTotalDeliveryDetailPages() { return paginationData.deliveryDetail.totalPages; }

    function jumpToDeliveryDetailPage() {
        const page = parseInt(document.getElementById('delivery-detail-jump-input').value);
        if (page && page >= 1 && page <= paginationData.deliveryDetail.totalPages) {
            gotoDeliveryDetailPage(page);
        }
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', function() {
        // 初始化所有分页
        ['bid', 'contract', 'unconfirmed-contact', 'sales', 'order', 'survey', 'delivery', 'deliveryDetail',
         'aftersale-apply', 'aftersale-order', 'aftersale-dispatch', 'aftersale-delivery', 'aftersale-report'].forEach(module => {
            updatePagination(module);
        });

        // 默认展开营销管理菜单
        const marketingSubmenu = document.querySelector('.nav-menu > li:first-child .nav-submenu');
        if (marketingSubmenu) {
            marketingSubmenu.classList.add('expanded');
            const toggle = marketingSubmenu.previousElementSibling.querySelector('.nav-toggle');
            if (toggle) {
                toggle.style.transform = 'rotate(90deg)';
            }
        }
        


        // 点击模态框外部关闭
        window.onclick = function(event) {
            if (event.target.className === 'modal') {
                event.target.style.display = 'none';
            }
        }
    });

    // 售后报告相关函数
    function changeAftersaleReportPageSize() {
        const pageSize = parseInt(document.getElementById('aftersale-report-page-size').value);
        paginationData['aftersale-report'].pageSize = pageSize;
        paginationData['aftersale-report'].currentPage = 1;
        updatePagination('aftersale-report');
    }

    function gotoAftersaleReportPage(page) {
        if (page < 1 || page > paginationData['aftersale-report'].totalPages) return;
        paginationData['aftersale-report'].currentPage = page;
        updatePagination('aftersale-report');
    }

    function getCurrentAftersaleReportPage() { return paginationData['aftersale-report'].currentPage; }
    function getTotalAftersaleReportPages() { return paginationData['aftersale-report'].totalPages; }

    function jumpToAftersaleReportPage() {
        const page = parseInt(document.getElementById('aftersale-report-jump-input').value);
        if (page && page >= 1 && page <= paginationData['aftersale-report'].totalPages) {
            gotoAftersaleReportPage(page);
        }
    }

    // 售后报告详情相关函数
    function showReportDetail(reportId) {
        const modal = document.getElementById('report-detail-modal');
        if (modal) {
            modal.style.display = 'block';
        }
    }

    // 审批流程相关函数
    function showApprovalFlow(reportId) {
        const modal = document.getElementById('approvalFlowModal');
        const timeline = document.getElementById('approvalFlowTimeline');
        
        // 模拟审批流程数据
        const approvalData = {
            'SH-25070001': [
                { time: '2025-07-01 09:00', user: '张工', action: '提交报告', status: 'completed' },
                { time: '2025-07-01 10:30', user: '李经理', action: '部门审核通过', status: 'completed' },
                { time: '2025-07-01 14:20', user: '王总监', action: '最终审批通过', status: 'completed' }
            ],
            'SH-25070002': [
                { time: '2025-07-02 11:00', user: '王工', action: '提交报告', status: 'completed' },
                { time: '2025-07-02 14:30', user: '李经理', action: '部门审核中', status: 'pending' },
                { time: '待处理', user: '王总监', action: '等待审批', status: 'pending' }
            ],
            'SH-25070003': [
                { time: '2025-07-03 10:00', user: '李工', action: '提交报告', status: 'completed' },
                { time: '2025-07-03 11:30', user: '张经理', action: '部门审核通过', status: 'completed' },
                { time: '2025-07-03 15:20', user: '王总监', action: '最终审批通过', status: 'completed' }
            ],
            'SH-25070004': [
                { time: '2025-07-04 09:30', user: '赵工', action: '提交报告', status: 'completed' },
                { time: '2025-07-04 14:00', user: '张经理', action: '部门审核中', status: 'pending' },
                { time: '待处理', user: '王总监', action: '等待审批', status: 'pending' }
            ],
            'SH-25070005': [
                { time: '2025-07-05 10:30', user: '钱工', action: '提交报告', status: 'completed' },
                { time: '2025-07-05 13:30', user: '李经理', action: '部门审核通过', status: 'completed' },
                { time: '2025-07-05 16:20', user: '王总监', action: '最终审批通过', status: 'completed' }
            ]
        };

        // 清空现有内容
        timeline.innerHTML = '';

        // 添加审批流程记录
        const flowData = approvalData[reportId] || [];
        flowData.forEach(item => {
            const li = document.createElement('li');
            li.className = `approval-flow-item ${item.status}`;
            li.innerHTML = `
                <div class="approval-flow-time">${item.time}</div>
                <div class="approval-flow-content">
                    <span class="approval-flow-user">${item.user}</span>
                    <span class="approval-flow-status">${item.action}</span>
                </div>
            `;
            timeline.appendChild(li);
        });

        modal.style.display = 'block';
    }

    function closeApprovalFlow() {
        document.getElementById('approvalFlowModal').style.display = 'none';
    }

    // 报告预览相关函数
    function previewReport(reportId) {
        const reportData = {
            'SH-25070001': {
                customerName: '江苏食品技术有限公司',
                productInfo: 'WL-25040003/铝合金/3',
                reportDate: '2025-07-01',
                status: '已审核',
                problemDesc: '客户反映设备运行时出现异常噪音，影响正常生产。经初步检查，可能是传动部件磨损导致。',
                process: `1. 2025-06-28 接收到客户报修请求
2. 2025-06-29 工程师张三到达现场进行检查
3. 2025-06-30 更换磨损部件，进行设备调试
4. 2025-07-01 完成维修，客户确认问题解决`,
                solution: `1. 更换传动轴承组件
2. 调整传动部件间隙
3. 添加润滑油
4. 进行设备试运行和参数调整`,
                suggestions: `1. 建议客户定期检查设备运行状态
2. 按照操作手册要求定期进行维护保养
3. 发现异常及时报修，避免故障扩大
4. 对操作人员进行培训，规范操作流程`
            },
            'SH-25070002': {
                customerName: '河南科技集团有限公司',
                productInfo: 'WL-25040005/不锈钢/2',
                reportDate: '2025-07-02',
                status: '审核中',
                problemDesc: '设备控制系统显示错误代码E-203，导致生产线停机。',
                process: `1. 2025-07-01 收到紧急故障报修
2. 2025-07-01 远程指导客户进行初步排查
3. 2025-07-02 工程师李四到场维修
4. 2025-07-02 更新系统程序，恢复正常`,
                solution: `1. 检查控制系统硬件连接
2. 更新系统固件版本
3. 重新校准传感器参数
4. 进行系统功能测试`,
                suggestions: `1. 定期备份系统配置数据
2. 建立设备运行日志制度
3. 配备备用控制模块
4. 加强操作人员技术培训`
            },
            'SH-25070003': {
                customerName: '安徽电力设备有限公司',
                productInfo: 'WL-25040008/铜材/1',
                reportDate: '2025-07-03',
                status: '已审核',
                problemDesc: '变压器设备温度异常升高，运行效率下降。需要进行检修和维护。',
                process: `1. 2025-07-02 收到设备异常报告
2. 2025-07-02 远程诊断初步问题
3. 2025-07-03 工程师王五现场检修
4. 2025-07-03 完成维护并测试正常`,
                solution: `1. 清理散热系统
2. 更换损耗部件
3. 校准温度传感器
4. 优化运行参数`,
                suggestions: `1. 加强日常温度监控
2. 定期清理散热系统
3. 建立设备维护档案
4. 优化运行环境`
            },
            'SH-25070004': {
                customerName: '浙江机械制造股份公司',
                productInfo: 'WL-25040012/钢材/5',
                reportDate: '2025-07-04',
                status: '审核中',
                problemDesc: '数控系统精度偏差，加工产品尺寸超出允许范围。',
                process: `1. 2025-07-03 接收精度问题报告
2. 2025-07-03 远程协助排查
3. 2025-07-04 技术团队现场检测
4. 2025-07-04 系统校准调试中`,
                solution: `1. 进行系统精度校准
2. 更新控制参数
3. 调整补偿值
4. 测试加工精度`,
                suggestions: `1. 定期进行精度检测
2. 建立校准记录制度
3. 培训操作人员
4. 优化加工工艺`
            },
            'SH-25070005': {
                customerName: '广东工业设备有限公司',
                productInfo: 'WL-25040015/铝材/4',
                reportDate: '2025-07-05',
                status: '已审核',
                problemDesc: '自动化生产线传送带系统出现卡滞现象，影响生产效率。',
                process: `1. 2025-07-04 收到系统故障报告
2. 2025-07-04 远程指导应急处理
3. 2025-07-05 工程师赵六现场维修
4. 2025-07-05 系统恢复正常运行`,
                solution: `1. 更换磨损传送带
2. 调整张力系统
3. 清理传动装置
4. 测试运行状态`,
                suggestions: `1. 制定定期检查计划
2. 储备关键备件
3. 记录运行参数
4. 培训维护人员`
            }
        };

        const data = reportData[reportId];
        if (!data) return;

        // 填充预览内容
        document.getElementById('preview-report-id').textContent = reportId;
        document.getElementById('preview-customer-name').textContent = data.customerName;
        document.getElementById('preview-product-info').textContent = data.productInfo;
        document.getElementById('preview-report-date').textContent = data.reportDate;
        document.getElementById('preview-status').textContent = data.status;
        document.getElementById('preview-problem-desc').textContent = data.problemDesc;
        document.getElementById('preview-process').textContent = data.process;
        document.getElementById('preview-solution').textContent = data.solution;
        document.getElementById('preview-suggestions').textContent = data.suggestions;

        // 显示预览弹窗
        document.getElementById('reportPreviewModal').style.display = 'block';
    }

    function closeReportPreview() {
        document.getElementById('reportPreviewModal').style.display = 'none';
    }

    function printPreview() {
        window.print();
    }

    // 下拉菜单相关函数
    function toggleDropdown(event, dropdownId) {
        event.preventDefault();
        event.stopPropagation();
        
        // 关闭其他所有下拉菜单
        document.querySelectorAll('.dropdown-content').forEach(dropdown => {
            if (dropdown.id !== dropdownId) {
                dropdown.style.display = 'none';
            }
        });

        // 切换当前下拉菜单
        const dropdown = document.getElementById(dropdownId);
        if (dropdown) {
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }
    }

    // 点击页面其他地方关闭下拉菜单
    document.addEventListener('click', function(event) {
        if (!event.target.matches('.action-link')) {
            document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                dropdown.style.display = 'none';
            });
        }
    });

    function closeReportDetail() {
        const modal = document.getElementById('report-detail-modal');
        if (modal) {
            modal.style.display = 'none';
        }
    }

    function previewReport(reportId) {
        // 在新窗口中打开预览
        window.open(`/preview-report/${reportId}`, '_blank');
    }

    function printReport(reportId) {
        window.print();
    }

    // 收货记录相关函数
    function showReceiptForm() {
        alert('打开新增收货记录表单');
        // 实际项目中这里会显示新增收货记录的表单弹窗
        console.log('显示新增收货记录表单');
    }

    function showReceiptDetail(receiptId) {
        alert(`查看收货记录详情：${receiptId}`);
        // 实际项目中这里会显示收货记录详情弹窗
        console.log('显示收货记录详情：', receiptId);
    }

    function editReceipt(receiptId) {
        alert(`编辑收货记录：${receiptId}`);
        // 实际项目中这里会显示编辑收货记录的表单
        console.log('编辑收货记录：', receiptId);
    }

    function previewReceipt(receiptId) {
        alert(`预览收货记录：${receiptId}`);
        // 实际项目中这里会显示收货记录预览弹窗
        console.log('预览收货记录：', receiptId);
    }

    function exportReceipt(receiptId, format) {
        alert(`导出收货记录 ${receiptId} 为 ${format.toUpperCase()} 格式`);
        // 实际项目中这里会触发文件下载
        console.log('导出收货记录：', receiptId, format);
    }

    function deleteReceipt(receiptId) {
        if (confirm(`确定要删除收货记录 ${receiptId} 吗？`)) {
            alert(`收货记录 ${receiptId} 已删除`);
            // 实际项目中这里会发送删除请求到服务器
            console.log('删除收货记录：', receiptId);
        }
    }

    function exportReport(reportId, format) {
        // 实际项目中这里会调用后端API进行导出
        const formatName = format.toUpperCase();
        alert(`正在导出${formatName}格式的报告：${reportId}`);
    }

        // 悬浮面板操作函数
        function exportBidData() {
            alert('导出框架协议数据功能');
            hideFloatingPanel();
        }

        function importBidData() {
            alert('导入框架协议数据功能');
            hideFloatingPanel();
        }

        function batchEditBid() {
            alert('批量编辑框架协议功能');
            hideFloatingPanel();
        }

        function batchDeleteBid() {
            if (confirm('确定要批量删除选中的框架协议吗？')) {
                alert('批量删除框架协议功能');
                hideFloatingPanel();
            }
        }

        function showBidReport() {
            alert('框架协议数据报表功能');
            hideFloatingPanel();
        }

        function showBidStatistics() {
            alert('框架协议统计分析功能');
            hideFloatingPanel();
        }

        function exportContractData() {
            alert('导出合同数据功能');
            hideFloatingPanel();
        }

        function batchUploadContract() {
            alert('批量上传合同功能');
            hideFloatingPanel();
        }

        function batchConfirmTechContact() {
            alert('批量确认技术联系人功能');
            hideFloatingPanel();
        }

        function showTechContactReport() {
            alert('技术联系人报表功能');
            hideFloatingPanel();
        }

        function batchEditContract() {
            alert('批量编辑合同功能');
            hideFloatingPanel();
        }

        function batchDeleteContract() {
            if (confirm('确定要批量删除选中的合同吗？')) {
                alert('批量删除合同功能');
                hideFloatingPanel();
            }
        }

        function showContractAuditFlow() {
            alert('合同审核流程功能');
            hideFloatingPanel();
        }

        function showContractStatus() {
            alert('合同状态查看功能');
            hideFloatingPanel();
        }

        // 未确认联系人模块特有操作函数
        function exportUnconfirmedContactData() {
            alert('导出未确认联系人数据功能');
            hideFloatingPanel();
        }

        function showTechContactStatistics() {
            alert('技术联系人统计功能');
            hideFloatingPanel();
        }

        function batchEditUnconfirmedContact() {
            alert('批量编辑未确认联系人功能');
            hideFloatingPanel();
        }

        function batchDeleteUnconfirmedContact() {
            if (confirm('确定要批量删除选中的未确认联系人吗？')) {
                alert('批量删除未确认联系人功能');
                hideFloatingPanel();
            }
        }

        function showTechContactProcess() {
            alert('技术确认流程功能');
            hideFloatingPanel();
        }

        function showTechContactStatus() {
            alert('确认状态功能');
            hideFloatingPanel();
        }

        function refreshCurrentModule() {
            alert('刷新当前模块数据');
            hideFloatingPanel();
        }

        function showHelp() {
            alert('显示帮助文档');
            hideFloatingPanel();
        }

        // 合同文件管理函数
        function uploadContractFile() {
            // 创建文件输入元素
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.pdf,.doc,.docx,.xls,.xlsx';
            input.multiple = true;
            
            input.onchange = function(e) {
                const files = e.target.files;
                if (files.length > 0) {
                    // 模拟文件上传
                    for (let i = 0; i < files.length; i++) {
                        const file = files[i];
                        addContractFileToList(file.name, file.size);
                    }
                    alert(`成功上传 ${files.length} 个合同文件`);
                }
            };
            
            input.click();
        }

        function addContractFileToList(fileName, fileSize) {
            const fileList = document.getElementById('contract-files-list');
            const fileDiv = document.createElement('div');
            fileDiv.style.cssText = 'border: 1px solid #d9d9d9; border-radius: 4px; padding: 10px; margin-bottom: 8px; background: white; display: flex; align-items: center; justify-content: space-between;';
            
            const fileSizeKB = Math.round(fileSize / 1024);
            const fileIcon = getFileIcon(fileName);
            const uploadTime = new Date().toLocaleString('zh-CN');
            
            fileDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px;">
                    <i class="${fileIcon.class}" style="color: ${fileIcon.color}; font-size: 16px;"></i>
                    <div>
                        <div style="font-weight: 600; font-size: 13px;">${fileName}</div>
                        <div style="font-size: 11px; color: #999;">上传时间：${uploadTime}</div>
                    </div>
                </div>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="previewContractFile('${fileName}')" style="padding: 4px 8px; font-size: 11px;">预览</button>
                    <button class="btn btn-secondary" onclick="downloadContractFile('${fileName}')" style="padding: 4px 8px; font-size: 11px;">下载</button>
                    <button class="btn btn-secondary" onclick="deleteContractFile(this, '${fileName}')" style="padding: 4px 8px; font-size: 11px; color: #ff4d4f;">删除</button>
                </div>
            `;
            
            fileList.appendChild(fileDiv);
        }

        function previewContractFile(fileName) {
            alert(`预览合同文件：${fileName}`);
            // 实际项目中这里会在新窗口或弹窗中显示文件内容
        }

        function downloadContractFile(fileName) {
            // 模拟文件下载
            const link = document.createElement('a');
            link.href = '#';
            link.download = fileName;
            link.click();
            alert(`下载合同文件：${fileName}`);
        }

        function deleteContractFile(button, fileName) {
            if (confirm(`确定要删除文件"${fileName}"吗？`)) {
                button.closest('div').parentElement.remove();
                alert(`文件"${fileName}"已删除`);
            }
        }

        // 满意度调查表文件管理函数
        function uploadSurveyFile() {
            // 创建文件输入元素
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.pdf,.doc,.docx,.xls,.xlsx';
            input.multiple = true;
            
            input.onchange = function(e) {
                const files = e.target.files;
                if (files.length > 0) {
                    // 模拟文件上传
                    for (let i = 0; i < files.length; i++) {
                        const file = files[i];
                        addSurveyFileToList(file.name, file.size);
                    }
                    alert(`成功上传 ${files.length} 个调查表文件`);
                }
            };
            
            input.click();
        }

        function addSurveyFileToList(fileName, fileSize) {
            const fileList = document.getElementById('survey-files-list');
            
            // 移除"暂无其他调查表文件"提示
            const noFilesText = fileList.querySelector('div[style*="text-align: center"]');
            if (noFilesText) {
                noFilesText.remove();
            }
            
            const fileDiv = document.createElement('div');
            fileDiv.style.cssText = 'border: 1px solid #d9d9d9; border-radius: 4px; padding: 10px; margin-bottom: 8px; background: white; display: flex; align-items: center; justify-content: space-between;';
            
            const fileSizeKB = Math.round(fileSize / 1024);
            const fileIcon = getFileIcon(fileName);
            const uploadTime = new Date().toLocaleString('zh-CN');
            
            fileDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px;">
                    <i class="${fileIcon.class}" style="color: ${fileIcon.color}; font-size: 16px;"></i>
                    <div>
                        <div style="font-weight: 600; font-size: 13px;">${fileName}</div>
                        <div style="font-size: 11px; color: #999;">上传时间：${uploadTime}</div>
                    </div>
                </div>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="previewSurveyFile('${fileName}')" style="padding: 4px 8px; font-size: 11px;">预览</button>
                    <button class="btn btn-secondary" onclick="downloadSurveyFile('${fileName}')" style="padding: 4px 8px; font-size: 11px;">下载</button>
                    <button class="btn btn-secondary" onclick="deleteSurveyFile(this, '${fileName}')" style="padding: 4px 8px; font-size: 11px; color: #ff4d4f;">删除</button>
                </div>
            `;
            
            fileList.appendChild(fileDiv);
        }

        function previewSurveyFile(fileName) {
            alert(`预览调查表文件：${fileName}`);
            // 实际项目中这里会在新窗口或弹窗中显示文件内容
        }

        function downloadSurveyFile(fileName) {
            // 模拟文件下载
            const link = document.createElement('a');
            link.href = '#';
            link.download = fileName;
            link.click();
            alert(`下载调查表文件：${fileName}`);
        }

        function deleteSurveyFile(button, fileName) {
            if (confirm(`确定要删除文件"${fileName}"吗？`)) {
                const parentDiv = button.closest('div').parentElement;
                parentDiv.remove();
                
                // 如果没有文件了，显示提示文本
                const fileList = document.getElementById('survey-files-list');
                const hasFiles = fileList.querySelector('div[style*="border: 1px solid #d9d9d9"]');
                if (!hasFiles) {
                    const noFilesDiv = document.createElement('div');
                    noFilesDiv.style.cssText = 'text-align: center; color: #999; font-size: 12px; padding: 20px;';
                    noFilesDiv.textContent = '暂无其他调查表文件';
                    fileList.appendChild(noFilesDiv);
                }
                
                alert(`文件"${fileName}"已删除`);
            }
        }

        // 获取文件图标
        function getFileIcon(fileName) {
            const extension = fileName.split('.').pop().toLowerCase();
            switch (extension) {
                case 'pdf':
                    return { class: 'fas fa-file-pdf', color: '#ff4d4f' };
                case 'doc':
                case 'docx':
                    return { class: 'fas fa-file-word', color: '#1890ff' };
                case 'xls':
                case 'xlsx':
                    return { class: 'fas fa-file-excel', color: '#52c41a' };
                case 'ppt':
                case 'pptx':
                    return { class: 'fas fa-file-powerpoint', color: '#fa8c16' };
                case 'jpg':
                case 'jpeg':
                case 'png':
                case 'gif':
                    return { class: 'fas fa-file-image', color: '#722ed1' };
                default:
                    return { class: 'fas fa-file', color: '#666' };
            }
        }

        // 合同流程详情切换函数
        function toggleContractProcessDetails(processId) {
            const detailsElement = document.getElementById(`contract-${processId}-details`);
            if (detailsElement) {
                detailsElement.style.display = detailsElement.style.display === 'none' ? 'block' : 'none';
            }
        }

        // 生成生产计划相关函数
        function showProductionPlanModal() {
            document.getElementById('production-plan-modal').style.display = 'block';
        }

        function confirmProductionPlan() {
            // 检查必填字段
            const planDates = document.querySelectorAll('#production-plan-modal input[type="date"]');
            let hasEmptyRequired = false;
            
            planDates.forEach(input => {
                if (input.closest('td').querySelector('span[style*="color: red"]') && !input.value) {
                    hasEmptyRequired = true;
                    input.style.borderColor = '#ff4d4f';
                }
            });
            
            if (hasEmptyRequired) {
                alert('请填写所有必填的计划需求日期！');
                return;
            }
            
            // 收集表单数据
            const formData = {
                orderCode: document.querySelector('#production-plan-modal input[value="XS-2507003"]').value,
                department: document.querySelector('#production-plan-modal select').value,
                customer: document.querySelector('#production-plan-modal input[value="科倍恩-xujianTest"]').value,
                planner: document.querySelector('#production-plan-modal input[value="李志明/157371112"]').value,
                notes: document.querySelector('#production-plan-modal textarea').value,
                details: []
            };
            
            // 收集明细数据
            const rows = document.querySelectorAll('#production-plan-modal tbody tr');
            rows.forEach((row, index) => {
                const cells = row.querySelectorAll('td');
                const planDate = row.querySelector('input[type="date"]').value;
                const startDate = row.querySelectorAll('input[type="date"]')[1].value;
                const endDate = row.querySelectorAll('input[type="date"]')[2].value;
                
                formData.details.push({
                    序号: cells[0].textContent,
                    产品信息: cells[1].textContent,
                    数量单位: cells[2].textContent,
                    销售要货日期: cells[3].textContent,
                    计划需求日期: planDate,
                    计划开始日期: startDate,
                    计划结束日期: endDate
                });
            });
            
            console.log('生产计划数据：', formData);
            alert('生产计划已成功生成！');
            closeModal('production-plan-modal');
        }

    </script>
</body>
</html> 